"use strict";angular.module("app.animations",["ngAnimate"]).animation(".slide-animation",function(){return{addClass:function(a,b,c){var d=a.scope();if("active"==b){a.addClass("active");var e=a.parent().width();"right"!==d.banner.direction&&(e=-e),a.css({left:e}),a.find(".banner-panel").css({left:e}),TweenMax.to(a,1,{left:0,ease:Power2.easeInOut},c),TweenMax.to(a.find(".banner-panel"),1.2,{left:"0px",ease:Back.easeOut})}else c()},beforeRemoveClass:function(a,b,c){var d=a.scope();if("active"==b){var e=a.parent().width();"right"===d.banner.direction&&(e=-e),TweenMax.to(a,1,{left:e,ease:Power2.easeInOut},c),TweenMax.to(a.find(".banner-panel"),1.2,{left:e,ease:Back.easeOut})}else c()}}});var app=angular.module("app",["angularFileUpload","summernote","angular-bootbox","angularMoment","angularPayments","youtube-embed","dndLists","ngCookies","ngStorage","ngSanitize","ngProgress","ui.router","ui.load","ui.jq","ui.validate","ui.date","ui.gravatar","app.controllers","app.services","app.filters","app.directives","app.animations"]).run(["$rootScope","$state","$stateParams","$window","$http","$q","AuthenticationService","UserService","$location","ngProgress","MetaService","$cookies","$localStorage","LoginModalService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.$state=b,a.$stateParams=c,a.metaservice=k,a.UserService=h,a.LoginModalService=n,a.$on("$stateChangeStart",function(a,c,e,f,h){c.redirectTo&&(a.preventDefault(),b.go(c.redirectTo,e)),c.access&&c.access.noauth&&d.sessionStorage.token&&g.isLogged()&&(a.preventDefault(),b.transitionTo("app.home")),c.access&&c.access.auth&&!d.sessionStorage.token&&!g.isLogged()&&(a.preventDefault(),b.transitionTo("app.login")),c.access&&c.access.admin&&!g.isAdmin(),d.scrollTo(0,0)}),a.$on("$stateChangeSuccess",function(b,c,e,f,g){a.metaservice.setStatusCode(200),d.ga&&d.ga("send","pageview",i.path()),c.seo&&a.metaservice.set(c.seo.title,c.seo.description,c.seo.keywords),c.og||a.metaservice.setOg("https://tempoStorm.com"+c.url)}),a.$on("$stateChangeError",function(a,c,d,e,f){b.transitionTo("app.404")})}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$controllerProvider","$compileProvider","$filterProvider","$provide","$httpProvider","$bootboxProvider","$sceDelegateProvider",function(a,b,c,d,e,f,g,h,i,j){app.controller=d.register,app.directive=e.directive,app.filter=f.register,app.factory=g.factory,app.service=g.service,app.constant=g.constant,app.value=g.value,i.setDefaults({locale:"en"}),a.html5Mode(!0),h.interceptors.push("TokenInterceptor"),tpl=tpl||"",j.resourceUrlWhitelist(["self",tpl+"**"]),c.otherwise("404"),b.state("app",{"abstract":!0,url:"/",views:{root:{templateUrl:tpl+"views/frontend/index.html",controller:"RootCtrl"}},resolve:{User:["$window","$cookies","$state","$q","AuthenticationService","SubscriptionService","UserService",function(a,b,c,d,e,f,g){var h=b.get("token");if(h&&(a.sessionStorage.token=h),a.sessionStorage.token&&!e.isLogged()){var i=d.defer();return g.verify().success(function(b){e.setLogged(!0),e.setAdmin(b.isAdmin),e.setProvider(b.isProvider),f.setSubscribed(b.subscription.isSubscribed),f.setTsPlan(b.subscription.plan),f.setExpiry(b.subscription.expiry),a.sessionStorage.userID=b.userID,a.sessionStorage.username=b.username,a.sessionStorage.email=b.email,i.resolve()}).error(function(c){delete a.sessionStorage.userID,delete a.sessionStorage.username,delete a.sessionStorage.token,delete a.sessionStorage.email,b.remove("token"),d.reject()}),i.promise}}]}}).state("app.404",{url:"404",views:{content:{templateUrl:tpl+"views/frontend/404.html",controller:"404Ctrl"}},seo:{title:"404"}}).state("app.home",{url:"",views:{content:{templateUrl:tpl+"views/frontend/home.html",controller:"HomeCtrl",resolve:{dataArticles:["ArticleService",function(a){var b="all",c=0,d=6;return a.getArticles("all",b,c,d)}]}}},seo:{title:"Home",description:"TempoStorm home page.",keywords:""}}).state("app.articles",{"abstract":!0,url:"articles",views:{content:{templateUrl:tpl+"views/frontend/articles.html"}}}).state("app.articles.list",{url:"?s&p&t&f",views:{articles:{templateUrl:tpl+"views/frontend/articles.list.html",controller:"ArticlesCtrl",resolve:{data:["$stateParams","ArticleService",function(a,b){var c=a.t||"all",d=a.f||"all",e=a.p||1,f=12,g=a.s||"";return b.getArticles(c,d,f*e-f,f,g)}]}}},seo:{title:"Articles",description:"TempoStorm articles to bring you the latest news.",keywords:""},og:!0}).state("app.articles.article",{url:"/:slug",views:{articles:{templateUrl:tpl+"views/frontend/articles.article.html",controller:"ArticleCtrl",resolve:{data:["$stateParams","$q","ArticleService",function(a,b,c){var d=a.slug;return c.getArticle(d).then(function(a){return a.success===!0?a:b.reject("Unable to find article")})}]}}}}).state("app.snapshot",{"abstract":"true",url:"hearthstone/meta-snapshot",views:{content:{templateUrl:tpl+"views/frontend/snapshots.html"}}}).state("app.snapshot.redirect",{url:"",resolve:{data:["SnapshotService","$q",function(a,b){return a.getLatest().then(function(a){return a.success===!0?a:b.reject("unable to find snapshot")})}],redirect:["$q","$state","data",function(a,b,c){return b.go("app.snapshot.snapshot",{slug:c.snapshot[0].slug.url}),a.reject()}]}}).state("app.snapshot.snapshot",{url:"/:slug",views:{snapshots:{templateUrl:tpl+"views/frontend/snapshots.snapshot.html",controller:"SnapshotCtrl",resolve:{data:["$stateParams","$q","SnapshotService",function(a,b,c){var d=a.slug;return c.getSnapshot(d).then(function(a){return a.success===!0?a.snapshot:b.reject("Unable to find snapshot")})}]}}}}).state("app.hs",{"abstract":!0,url:"hearthstone",views:{content:{templateUrl:tpl+"views/frontend/hs.html"}}}).state("app.decks",{url:"decks?p&s&k&a&o",redirectTo:"app.hs.decks.list"}).state("app.decks.deck",{url:"/:slug",redirectTo:"app.hs.decks.deck"}).state("app.deckBuilder",{url:"deck-builder",redirectTo:"app.hs.deckBuilder.class"}).state("app.hs.home",{url:"",views:{hs:{templateUrl:tpl+"views/frontend/hs.home.html",controller:"HearthstoneHomeCtrl",resolve:{dataArticles:["ArticleService",function(a){var b="all",c=1,d=6;return a.getArticles("hs",b,c,d)}],dataDecksTempostorm:["DeckService",function(a){return a.getDecksFeatured(!1,1,10)}],dataDecksCommunity:["DeckService",function(a){return a.getDecksCommunity(!1,1,10)}]}}},seo:{title:"Hearthstone",description:"TempoStorm Hearthstone featured and community decks.",keywords:""},og:!0}).state("app.hs.decks",{"abstract":!0,url:"/decks",views:{hs:{templateUrl:tpl+"views/frontend/hs.decks.html"}}}).state("app.hs.decks.list",{url:"?p&s&k&a&o",views:{decks:{templateUrl:tpl+"views/frontend/hs.decks.list.html",controller:"DecksCtrl",resolve:{dataDecksTempostorm:["$stateParams","DeckService",function(a,b){var c=a.k||!1,d=a.p||1,e=4,f=a.s||"",g=a.a||"",h=a.o||"";return b.getDecksFeatured(c,d,e,f,g,h)}],dataDecksCommunity:["$stateParams","DeckService",function(a,b){var c=a.k||!1,d=a.p||1,e=12,f=a.s||"";a.a||"",a.o||"";return b.getDecksCommunity(c,d,e,f)}]}}},seo:{title:"Decks",description:"Hearthstone decks created by the community and TempoStorm content providers.",keywords:""}}).state("app.hs.decks.deck",{url:"/:slug",views:{decks:{templateUrl:tpl+"views/frontend/hs.decks.deck.html",controller:"DeckCtrl",resolve:{data:["$stateParams","DeckService",function(a,b){var c=a.slug;return b.getDeck(c).then(function(a){return a.success===!0?a:$q.reject("unable to find deck")})}]}}}}).state("app.hs.deckBuilder",{"abstract":!0,url:"/deck-builder",views:{hs:{templateUrl:tpl+"views/frontend/hs.deck-builder.html"}}}).state("app.hs.deckBuilder.class",{url:"",views:{deckBuilder:{templateUrl:tpl+"views/frontend/hs.deck-builder.class.html",controller:"DeckBuilderClassCtrl"}},seo:{title:"Deck Builder",description:"Deck building tool for Hearthstone.",keywords:""}}).state("app.hs.deckBuilder.build",{url:"/:playerClass",views:{deckBuilder:{templateUrl:tpl+"views/frontend/hs.deck-builder.build.html",controller:"DeckBuilderCtrl",resolve:{data:["$stateParams","DeckBuilder",function(a,b){var c=a.playerClass,d=1,e=15,f=[],g="all",h="";return b.loadCards(d,e,h,f,g,c)}],toStep:["$stateParams",function(a){return a.goTo?a.goTo:void 0}]}}}}).state("app.hs.deckBuilder.edit",{url:"/edit/:slug",views:{deckBuilder:{templateUrl:tpl+"views/frontend/hs.deck-builder.edit.html",controller:"DeckEditCtrl",resolve:{data:["$stateParams","DeckService",function(a,b){var c=a.slug;return b.deckEdit(c)}]}}},seo:{title:"Deck Edit",description:"Editing tool for hearthstone decks.",keywords:""}}).state("app.hots",{"abstract":!0,url:"heroes-of-the-storm",views:{content:{templateUrl:tpl+"views/frontend/hots.html"}}}).state("app.hots.home",{url:"",views:{hots:{templateUrl:tpl+"views/frontend/hots.home.html",controller:"HOTSHomeCtrl",resolve:{dataArticles:["ArticleService",function(a){var b="all",c=0,d=6;return a.getArticles("hots",b,c,d)}],dataGuidesCommunity:["HOTSGuideService",function(a){return a.getGuidesCommunity()}],dataGuidesFeatured:["HOTSGuideService",function(a){return a.getGuidesFeatured()}],dataHeroes:["HeroService",function(a){return a.getHeroesList()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Heroes of the Storm",description:"TempoStorm Heroes of the Storm home.",keywords:""}}).state("app.hots.guides",{"abstract":!0,url:"/guides",views:{hots:{templateUrl:tpl+"views/frontend/hots.guides.html"}}}).state("app.hots.guides.list",{url:"?p&s&t&h&m&a&o",views:{guides:{templateUrl:tpl+"views/frontend/hots.guides.list.html",controller:"HOTSGuidesListCtrl",resolve:{dataCommunityGuides:["$stateParams","HOTSGuideService",function(a,b){return b.getGuidesCommunity(!1,0,10,!1,!1)}],dataTopGuide:["$stateParams","HOTSGuideService",function(a,b){var c=(a.t||"all",a.h||!1),d=a.o||"high";return b.getGuides("hero",c,1,1,"","",d)}],dataTempostormGuides:["HOTSGuideService",function(a){return a.getGuidesFeatured(!1,0,4)}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guides",description:"Guides for Heroes of the Storm.",keywords:""}}).state("app.hots.guides.guide",{url:"/:slug",views:{guides:{templateUrl:tpl+"views/frontend/hots.guides.guide.html",controller:"HOTSGuideCtrl",resolve:{data:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.getGuide(c).then(function(a){return a.success===!0?a:$q.reject("Unable to find guide")})}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},og:!0}).state("app.hots.guideBuilder",{"abstract":!0,url:"/guide-builder",views:{hots:{templateUrl:tpl+"views/frontend/hots.guideBuilder.html"}}}).state("app.hots.guideBuilder.step1",{url:"",views:{guideBuilder:{templateUrl:tpl+"views/frontend/hots.guideBuilder.step1.html"}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""}}).state("app.hots.guideBuilder.hero",{url:"/hero",views:{guideBuilder:{templateUrl:tpl+"views/frontend/hots.guideBuilder.hero.html",controller:"HOTSGuideBuilderHeroCtrl",resolve:{dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""}}).state("app.hots.guideBuilder.map",{url:"/map",views:{guideBuilder:{templateUrl:tpl+"views/frontend/hots.guideBuilder.map.html",controller:"HOTSGuideBuilderMapCtrl",resolve:{dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""}}).state("app.hots.guideBuilder.edit",{"abstract":!0,url:"/edit/:slug",views:{guideBuilder:{templateUrl:tpl+"views/frontend/hots.guideBuilder.edit.html"}},access:{auth:!0}}).state("app.hots.guideBuilder.edit.step1",{url:"",views:{edit:{templateUrl:tpl+"views/frontend/hots.guideBuilder.edit.step1.html",controller:"HOTSGuideBuilderEditStep1Ctrl",resolve:{dataGuide:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.guideEdit(c)}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""},access:{auth:!0}}).state("app.hots.guideBuilder.edit.hero",{url:"/hero",views:{edit:{templateUrl:tpl+"views/frontend/hots.guideBuilder.edit.hero.html",controller:"HOTSGuideBuilderEditHeroCtrl",resolve:{dataGuide:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.guideEdit(c)}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""},access:{auth:!0}}).state("app.hots.guideBuilder.edit.map",{url:"/map",views:{edit:{templateUrl:tpl+"views/frontend/hots.guideBuilder.edit.map.html",controller:"HOTSGuideBuilderEditMapCtrl",resolve:{dataGuide:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.guideEdit(c)}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""},access:{auth:!0}}).state("app.hots.talentCalculator",{"abstract":!0,url:"/talent-calculator",views:{hots:{templateUrl:tpl+"views/frontend/hots.talentCalculator.html",controller:"HOTSTalentCalculatorCtrl",resolve:{dataHeroesList:["HeroService",function(a){return a.getHeroesList()}]}}}}).state("app.hots.talentCalculator.redirect",{url:"",resolve:{dataHeroesList:["HeroService","$q",function(a,b){return a.getHeroesList().then(function(a){return a.success===!0?a:b.reject("unable to find hero")})}],redirect:["$q","$state","dataHeroesList",function(a,b,c){return b.go("app.hots.talentCalculator.hero",{hero:c.heroes[0].className}),a.reject()}]},seo:{title:"Talent Calculator",description:"Talent Calculator for Heroes of the Storm",keywords:""}}).state("app.hots.talentCalculator.hero",{url:"/:hero",views:{calc:{templateUrl:tpl+"views/frontend/hots.talentCalculator.hero.html",controller:"HOTSTalentCalculatorHeroCtrl",resolve:{dataHero:["$stateParams","$q","HeroService",function(a,b,c){var d=a.hero;return c.getHeroByClass(d).then(function(a){return a.success===!0?a:b.reject("unable to find hero")})}]}}},seo:{title:"Talent Calculator",description:"Talent Calculator for Heroes of the Storm",keywords:""}}).state("app.forum",{"abstract":!0,url:"forum",views:{content:{templateUrl:tpl+"views/frontend/forum.html"}}}).state("app.forum.home",{url:"",views:{forum:{templateUrl:tpl+"views/frontend/forum.home.html",controller:"ForumCategoryCtrl",resolve:{data:["ForumService","$q",function(a,b){return a.getCategories().then(function(a){return a.success===!0?a:b.reject("unable to find catagory")})}]}}},seo:{title:"Forum",description:"",keywords:""}}).state("app.forum.threads",{url:"/:thread",views:{forum:{templateUrl:tpl+"views/frontend/forum.threads.html",controller:"ForumThreadCtrl",resolve:{data:["$stateParams","ForumService","$q",function(a,b,c){var d=a.thread;return b.getThread(d).then(function(a){return a.success===!0?a:c.reject("unable to find thread")})}]}}},og:!0}).state("app.forum.add",{url:"/:thread/add",views:{forum:{templateUrl:tpl+"views/frontend/forum.add.html",controller:"ForumAddCtrl",resolve:{data:["$stateParams","ForumService",function(a,b){var c=a.thread;return b.getThread(c)}]}}}}).state("app.forum.post",{url:"/:thread/:post",views:{forum:{templateUrl:tpl+"views/frontend/forum.post.html",controller:"ForumPostCtrl",resolve:{data:["$stateParams","ForumService","$q",function(a,b,c){var d=a.thread,e=a.post;return b.getPost(d,e).then(function(a){return a.success===!0?a:c.reject("unable to find post")})}]}}},og:!0}).state("app.teams",{url:"teams",views:{content:{controller:"TeamCtrl",templateUrl:tpl+"views/frontend/teams.html",resolve:{data:["TeamService","$q",function(a,b){return a.getMembers().then(function(a){return a.success===!0?a:b.reject("Unable to find members")})}]}}},seo:{title:"Teams",description:"Teams on Tempostorm",keywords:""}}).state("app.polls",{url:"vote",views:{content:{templateUrl:tpl+"views/frontend/polls.html",controller:"PollsCtrl",resolve:{dataPollsMain:["PollService",function(a){return a.getPolls("main")}],dataPollsSide:["PollService",function(a){return a.getPolls("side")}]}}},seo:{title:"Vote",description:"Vote on TempoStorm",keywords:""}}).state("app.sponsors",{url:"sponsors",views:{content:{templateUrl:tpl+"views/frontend/sponsors.html"}},seo:{title:"Sponsors",description:"TempoStorm sponsor page.",keywords:""}}).state("app.premium",{url:"premium",views:{content:{templateUrl:tpl+"views/frontend/premium.html",controller:"PremiumCtrl"}},seo:{title:"Get Premium",description:"Get Premium with TempoStorm",keywords:""}}).state("app.terms",{url:"terms",views:{content:{templateUrl:tpl+"views/frontend/terms.html"}},seo:{title:"Terms and Conditions",description:"TempoStorm Terms and Conditions",keywords:""}}).state("app.privacy",{url:"privacy",views:{content:{templateUrl:tpl+"views/frontend/privacy.html"}},seo:{title:"Privacy Policy",description:"TempoStorm Privacy Policy",keywords:""}}).state("app.login",{url:"login",views:{content:{templateUrl:tpl+"views/frontend/login.html",controller:"UserCtrl"}},access:{noauth:!0},seo:{title:"Login",description:"Login to TempoStorm",keywords:""}}).state("app.signup",{url:"signup",views:{content:{templateUrl:tpl+"views/frontend/signup.html",controller:"UserCtrl"}},access:{noauth:!0},seo:{title:"Sign up",description:"Sign up for TempoStorm.",keywords:""}}).state("app.verify",{url:"verify?email&code",views:{content:{templateUrl:tpl+"views/frontend/verify.html",controller:"UserVerifyCtrl"}},access:{noauth:!0},seo:{title:"Verify your Email",description:"",keywords:""}}).state("app.forgotPassword",{url:"forgot-password",views:{content:{templateUrl:tpl+"views/frontend/forgot-password.html",controller:"UserCtrl"}},access:{noauth:!0},seo:{title:"Forgot your Password?",description:"Recover your Password.",keywords:""}}).state("app.resetPassword",{url:"forgot-password/reset?email&code",views:{content:{templateUrl:tpl+"views/frontend/reset-password.html",controller:"UserResetPasswordCtrl"}},access:{noauth:!0},seo:{title:"Reset your Password",description:"",keywords:""}}).state("app.profile",{"abstract":!0,url:"user/:username",views:{content:{templateUrl:tpl+"views/frontend/profile.html",controller:"ProfileCtrl",resolve:{dataProfile:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getProfile(c).then(function(a){return a.success===!0?a:$q.reject("Unable to find profile")})}]}}}}).state("app.profile.activity",{url:"",views:{profile:{templateUrl:tpl+"views/frontend/profile.activity.html",controller:"ProfileActivityCtrl",resolve:{dataActivity:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getActivity(c)}]}}}}).state("app.profile.articles",{url:"/articles",views:{profile:{templateUrl:tpl+"views/frontend/profile.articles.html",controller:"ProfileArticlesCtrl",resolve:{dataArticles:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getArticles(c)}]}}}}).state("app.profile.decks",{url:"/decks",views:{profile:{templateUrl:tpl+"views/frontend/profile.decks.html",controller:"ProfileDecksCtrl",resolve:{dataDecks:["User","$stateParams","ProfileService","AuthenticationService",function(a,b,c,d){var e=b.username;return d.isLogged()?c.getDecksLoggedIn(e):c.getDecks(e)}]}}}}).state("app.profile.guides",{url:"/guides",views:{profile:{templateUrl:tpl+"views/frontend/profile.guides.html",controller:"ProfileGuidesCtrl",resolve:{dataGuides:["$stateParams","ProfileService","AuthenticationService","User",function(a,b,c,d){var e=a.username;return c.isLogged()?b.getGuidesLoggedIn(e):b.getGuides(e)}]}}}}).state("app.profile.posts",{url:"/posts",views:{profile:{templateUrl:tpl+"views/frontend/profile.posts.html",controller:"ProfilePostsCtrl",resolve:{dataPosts:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getProfile(c)}]}}}}).state("app.profile.edit",{url:"/edit",views:{profile:{templateUrl:tpl+"views/frontend/profile.edit.html",controller:"ProfileEditCtrl",resolve:{dataProfileEdit:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getUserProfile(c)}]}}},access:{auth:!0}}).state("app.profile.changeEmail",{url:"/email-change-confirm?code",views:{profile:{templateUrl:tpl+"views/frontend/blank.html",controller:"ProfileEmailChangeCtrl",resolve:{data:["$stateParams","ProfileService",function(a,b){var c=a.code||!1;return b.changeEmail(c)}]}}},access:{auth:!0},seo:{title:"Change my Email",description:"",keywords:""}}).state("app.profile.updateEmail",{url:"/email-verify?code",views:{profile:{templateUrl:tpl+"views/frontend/blank.html",controller:"ProfileEmailConfirmCtrl",resolve:{data:["$stateParams","ProfileService",function(a,b){var c=a.code||!1;return b.updateEmail(c)}]}}},access:{auth:!0}}).state("app.profile.subscription",{url:"/subscription?plan",views:{profile:{templateUrl:tpl+"views/frontend/profile.subscription.html",controller:"ProfileSubscriptionCtrl",resolve:{dataProfileEdit:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getUserProfile(c)}]}}},access:{auth:!0},seo:{title:"My Subscription",description:"",keywords:""}}).state("app.admin",{"abstract":!0,url:"admin",views:{content:{templateUrl:tpl+"views/admin/index.html",resolve:{admin:["User",function(a){return!0}]}}},access:{auth:!0,admin:!0}}).state("app.admin.dashboard",{url:"",views:{admin:{templateUrl:tpl+"views/admin/dashboard.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles",{"abstract":!0,url:"/articles",views:{admin:{templateUrl:tpl+"views/admin/articles.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles.list",{url:"",views:{articles:{templateUrl:tpl+"views/admin/articles.list.html",controller:"AdminArticleListCtrl",resolve:{data:["AdminArticleService",function(a){var b=1,c=50,d="";return a.getArticles(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles.add",{url:"/add",views:{articles:{templateUrl:tpl+"views/admin/articles.add.html",controller:"AdminArticleAddCtrl",resolve:{dataDecks:["AdminDeckService",function(a){return a.getDecks(1,10,"")}],dataGuides:["AdminHOTSGuideService",function(a){return a.getGuides(1,10,"")}],dataArticles:["AdminArticleService",function(a){return a.getArticles(1,10,"")}],dataProviders:["AdminUserService",function(a){return a.getProviders()}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles.edit",{url:"/edit/:articleID",views:{articles:{templateUrl:tpl+"views/admin/articles.edit.html",controller:"AdminArticleEditCtrl",resolve:{data:["$stateParams","AdminArticleService",function(a,b){var c=a.articleID;return b.getArticle(c)}],dataDecks:["AdminDeckService",function(a){var b=1,c=10,d="";return a.getDecks(b,c,d)}],dataGuides:["AdminHOTSGuideService",function(a){return a.getAllGuides()}],dataArticles:["AdminArticleService",function(a){return a.getAllArticles()}],dataProviders:["AdminUserService",function(a){return a.getProviders()}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone",{"abstract":!0,url:"/hs",views:{admin:{templateUrl:tpl+"views/admin/hearthstone.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks",{"abstract":!0,url:"/decks",views:{hearthstone:{templateUrl:tpl+"views/admin/decks.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.list",{url:"",views:{decks:{templateUrl:tpl+"views/admin/decks.list.html",controller:"AdminDeckListCtrl",resolve:{data:["AdminDeckService",function(a){var b=1,c=50,d="";return a.getDecks(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.add",{url:"/add",views:{decks:{templateUrl:tpl+"views/admin/decks.add.class.html",controller:"AdminDeckBuilderClassCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.addBuild",{url:"/add/:playerClass",views:{decks:{templateUrl:tpl+"views/admin/decks.add.build.html",controller:"AdminDeckAddCtrl",resolve:{data:["$stateParams","DeckBuilder",function(a,b){var c=1,d=15,e="",f=[],g="all",h=a.playerClass;return b.loadCards(c,d,e,f,g,h)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.edit",{url:"/edit/:deckID",views:{decks:{templateUrl:tpl+"views/admin/decks.edit.html",controller:"AdminDeckEditCtrl",resolve:{data:["$stateParams","AdminDeckService",function(a,b){var c=a.deckID;return b.getDeck(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.cards",{"abstract":!0,url:"/cards",views:{hearthstone:{templateUrl:tpl+"views/admin/cards.html"}},access:{auth:!0,admin:!0}}).state("app.admin.hearthstone.cards.list",{url:"",views:{cards:{templateUrl:tpl+"views/admin/cards.list.html",controller:"AdminCardListCtrl",resolve:{data:["AdminCardService",function(a){return a.getCards()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.cards.add",{url:"/add",views:{cards:{templateUrl:tpl+"views/admin/cards.add.html",controller:"AdminCardAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.cards.edit",{url:"/edit/:cardID",views:{cards:{templateUrl:tpl+"views/admin/cards.edit.html",controller:"AdminCardEditCtrl",resolve:{data:["$stateParams","AdminCardService",function(a,b){var c=a.cardID;return b.getCard(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots",{"abstract":!0,url:"/hots",views:{admin:{templateUrl:tpl+"views/admin/hots.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.heroes",{"abstract":!0,url:"/heroes",views:{hots:{templateUrl:tpl+"views/admin/hots.heroes.html"}},access:{auth:!0,admin:!0}}).state("app.admin.hots.heroes.list",{url:"",views:{heroes:{templateUrl:tpl+"views/admin/hots.heroes.list.html",controller:"AdminHeroListCtrl",resolve:{data:["AdminHeroService",function(a){var b=1,c=50,d="";return a.getHeroes(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.heroes.add",{url:"/add",views:{heroes:{templateUrl:tpl+"views/admin/hots.heroes.add.html",controller:"AdminHeroAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.heroes.edit",{url:"/edit/:heroID",views:{heroes:{templateUrl:tpl+"views/admin/hots.heroes.edit.html",controller:"AdminHeroEditCtrl",resolve:{data:["$stateParams","AdminHeroService",function(a,b){var c=a.heroID;return b.getHero(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps",{"abstract":!0,url:"/maps",views:{hots:{templateUrl:tpl+"views/admin/hots.maps.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps.list",{url:"",views:{maps:{templateUrl:tpl+"views/admin/hots.maps.list.html",controller:"AdminMapsListCtrl",resolve:{data:["AdminMapService",function(a){var b=1,c=50,d="";return a.getMaps(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps.add",{url:"/add",views:{maps:{templateUrl:tpl+"views/admin/hots.maps.add.html",controller:"AdminMapAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps.edit",{url:"/edit/:mapID",views:{maps:{templateUrl:tpl+"views/admin/hots.maps.edit.html",controller:"AdminMapEditCtrl",resolve:{data:["$stateParams","AdminMapService",function(a,b){var c=a.mapID;return b.getMap(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides",{"abstract":!0,url:"/guides",views:{hots:{templateUrl:tpl+"views/admin/hots.guides.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.list",{url:"",views:{guides:{templateUrl:tpl+"views/admin/hots.guides.list.html",controller:"AdminHOTSGuideListCtrl",resolve:{data:["AdminHOTSGuideService",function(a){var b=1,c=50,d="";return a.getGuides(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add",{"abstract":!0,url:"/add",views:{guides:{templateUrl:tpl+"views/admin/hots.guides.add.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add.step1",{url:"",views:{add:{templateUrl:tpl+"views/admin/hots.guides.add.step1.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add.hero",{url:"/hero",views:{add:{templateUrl:tpl+"views/admin/hots.guides.add.hero.html",controller:"AdminHOTSGuideAddHeroCtrl",resolve:{dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add.map",{url:"/map",views:{add:{templateUrl:tpl+"views/admin/hots.guides.add.map.html",controller:"AdminHOTSGuideAddMapCtrl",resolve:{dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit",{"abstract":!0,url:"/edit",views:{guides:{templateUrl:tpl+"views/admin/hots.guides.edit.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit.step1",{url:"/:guideID",views:{edit:{templateUrl:tpl+"views/admin/hots.guides.edit.step1.html",controller:"AdminHOTSGuideEditStep1Ctrl",resolve:{dataGuide:["$stateParams","AdminHOTSGuideService",function(a,b){var c=a.guideID;return b.getGuide(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit.hero",{url:"/:guideID/hero",views:{edit:{templateUrl:tpl+"views/admin/hots.guides.edit.hero.html",controller:"AdminHOTSGuideEditHeroCtrl",resolve:{dataGuide:["$stateParams","AdminHOTSGuideService",function(a,b){var c=a.guideID;return b.getGuide(c)}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit.map",{url:"/:guideID/map",views:{edit:{templateUrl:tpl+"views/admin/hots.guides.edit.map.html",controller:"AdminHOTSGuideEditMapCtrl",resolve:{dataGuide:["$stateParams","AdminHOTSGuideService",function(a,b){var c=a.guideID;return b.getGuide(c)}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum",{"abstract":!0,url:"/forum",views:{admin:{templateUrl:tpl+"views/admin/forum.html"}},access:{auth:!0,admin:!0}}).state("app.admin.forum.structure",{"abstract":!0,url:"/structure",views:{forum:{templateUrl:tpl+"views/admin/forum.structure.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.list",{url:"",views:{
categories:{templateUrl:tpl+"views/admin/forum.structure.list.html",controller:"AdminForumStructureListCtrl",resolve:{data:["AdminForumService",function(a){return a.getCategories()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.categoryAdd",{url:"/category/add",views:{categories:{templateUrl:tpl+"views/admin/forum.categories.add.html",controller:"AdminForumCategoryAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.categoryEdit",{url:"/category/edit/:categoryID",views:{categories:{templateUrl:tpl+"views/admin/forum.categories.edit.html",controller:"AdminForumCategoryEditCtrl",resolve:{data:["$stateParams","AdminForumService",function(a,b){var c=a.categoryID;return b.getCategory(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.threadAdd",{url:"/thread/add",views:{categories:{templateUrl:tpl+"views/admin/forum.threads.add.html",controller:"AdminForumThreadAddCtrl",resolve:{data:["AdminForumService",function(a){return a.getCategories()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.threadEdit",{url:"/thread/edit/:threadID",views:{categories:{templateUrl:tpl+"views/admin/forum.threads.edit.html",controller:"AdminForumThreadEditCtrl",resolve:{dataCategories:["AdminForumService",function(a){return a.getCategories()}],dataThread:["$stateParams","AdminForumService",function(a,b){var c=a.threadID;return b.getThread(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.management",{url:"/management",views:{admin:{templateUrl:tpl+"views/admin/forum.management.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users",{"abstract":!0,url:"/users",views:{admin:{templateUrl:tpl+"views/admin/users.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users.list",{url:"",views:{users:{templateUrl:tpl+"views/admin/users.list.html",controller:"AdminUserListCtrl",resolve:{data:["AdminUserService",function(a){var b=1,c=50,d="";return a.getUsers(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users.add",{url:"/add",views:{users:{templateUrl:tpl+"views/admin/users.add.html",controller:"AdminUserAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users.edit",{url:"/edit/:userID",views:{users:{templateUrl:tpl+"views/admin/users.edit.html",controller:"AdminUserEditCtrl",resolve:{data:["$stateParams","AdminUserService",function(a,b){var c=a.userID;return b.getUser(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners",{"abstract":!0,url:"/banners",views:{admin:{templateUrl:tpl+"views/admin/banners.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners.list",{url:"",views:{banners:{templateUrl:tpl+"views/admin/banners.list.html",controller:"AdminBannerListCtrl",resolve:{data:["AdminBannerService",function(a){return a.getBanners()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners.add",{url:"/add",views:{banners:{templateUrl:tpl+"views/admin/banners.add.html",controller:"AdminBannerAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners.edit",{url:"/edit/:bannerID",views:{banners:{templateUrl:tpl+"views/admin/banners.edit.html",controller:"AdminBannerEditCtrl",resolve:{data:["$stateParams","AdminBannerService",function(a,b){var c=a.bannerID;return b.getBanner(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls",{"abstract":!0,url:"/polls",views:{admin:{templateUrl:tpl+"views/admin/polls.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls.list",{url:"",views:{polls:{templateUrl:tpl+"views/admin/polls.list.html",controller:"AdminPollListCtrl",resolve:{data:["AdminPollService",function(a){var b=1,c=50,d="";return a.getPolls(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls.add",{url:"/add",views:{polls:{templateUrl:tpl+"views/admin/polls.add.html",controller:"AdminPollAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls.edit",{url:"/edit/:pollID",views:{polls:{templateUrl:tpl+"views/admin/polls.edit.html",controller:"AdminPollEditCtrl",resolve:{data:["$stateParams","AdminPollService",function(a,b){var c=a.pollID;return b.getPoll(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.snapshots",{"abstract":!0,url:"/snapshots",views:{admin:{templateUrl:tpl+"views/admin/snapshots.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.snapshots.list",{url:"",views:{snapshots:{templateUrl:tpl+"views/admin/snapshots.list.html",controller:"AdminSnapshotListCtrl",resolve:{data:["AdminSnapshotService",function(a){var b=1,c=50,d="";return a.getSnapshots(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.snapshots.add",{url:"/add",views:{snapshots:{templateUrl:tpl+"views/admin/snapshots.add.html",controller:"AdminSnapshotAddCtrl",resolve:{dataPrevious:["AdminSnapshotService",function(a){return a.getLatest()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.snapshots.edit",{url:"/:snapshotID",views:{snapshots:{templateUrl:tpl+"views/admin/snapshots.edit.html",controller:"AdminSnapshotEditCtrl",resolve:{data:["$stateParams","AdminSnapshotService",function(a,b){var c=a.snapshotID;return b.getSnapshot(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.teams",{"abstract":!0,url:"/team",views:{admin:{templateUrl:tpl+"views/admin/teams.html"}}}).state("app.admin.teams.list",{url:"",views:{teamMembers:{templateUrl:tpl+"views/admin/teams.list.html",controller:"AdminTeamListCtrl",resolve:{data:["AdminTeamService",function(a){return a.getMembers()}]}}}}).state("app.admin.teams.add",{url:"/add",views:{teamMembers:{templateUrl:tpl+"views/admin/teams.add.html",controller:"AdminTeamAddCtrl"}}}).state("app.admin.teams.edit",{url:"/:memberID",views:{teamMembers:{templateUrl:tpl+"views/admin/teams.edit.html",controller:"AdminTeamEditCtrl",resolve:{data:["$stateParams","AdminTeamService",function(a,b){var c=a.memberID;return b.getMember(c)}]}}}}).state("app.admin.subscriptions",{url:"/subscriptions",views:{admin:{templateUrl:tpl+"views/admin/subscriptions.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.vod",{"abstract":!0,url:"/vod",views:{admin:{templateUrl:tpl+"views/admin/vod.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.vod.list",{url:"",views:{vod:{templateUrl:tpl+"views/admin/vod.list.html",controller:"AdminVodListCtrl",resolve:{data:["AdminVodService",function(a){return a.getVods()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.vod.add",{url:"/add",views:{vod:{templateUrl:tpl+"views/admin/vod.add.html",controller:"AdminVodAddCtrl"}}}).state("app.admin.vod.edit",{url:"/:id",views:{vod:{templateUrl:tpl+"views/admin/vod.edit.html",controller:"AdminVodEditCtrl",resolve:{data:["$stateParams","AdminVodService",function(a,b){var c=a.id;return b.getVod(c)}]}}}}).state("app.admin.streams",{url:"/streams",views:{admin:{templateUrl:tpl+"views/admin/streams.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.contact",{url:"contact",views:{content:{templateUrl:tpl+"views/frontend/contact.html",controller:"ContactCtrl"}},seo:{title:"Contact Us",description:"Contact Page",keywords:""}})}]);angular.module("ui.gravatar").config(["gravatarServiceProvider",function(a){a.defaults={size:200,"default":"https://s3-us-west-2.amazonaws.com/ts-node2/img/profile.jpg"},a.secure=!0}]),angular.module("app.controllers",["ngCookies"]).controller("AppCtrl",["$scope","$localStorage","$cookies","$window","$location","SubscriptionService","AuthenticationService","UserService","$rootScope",function(a,b,c,d,e,f,g,h,i){function j(a){var b=a.navigator.userAgent||a.navigator.vendor||a.opera;return/iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/.test(b)}var k=!!navigator.userAgent.match(/MSIE/i);k&&angular.element(d.document.body).addClass("ie"),j(d)&&angular.element(d.document.body).addClass("smart"),a.app={name:"TempoStorm",version:"0.0.1",copyright:(new Date).getFullYear(),cdn:tpl&&tpl.length?tpl:"./",settings:{token:c.token||null,deck:null,show:{deck:null,article:null,decks:null},secondaryPortrait:[]},user:{getUserEmail:function(){return d.sessionStorage.email||!1},getUserID:function(){return d.sessionStorage.userID},getUsername:function(){return d.sessionStorage.username},isSubscribed:function(){return f.isSubscribed()},getSubscription:function(){return f.getSubscription()},isAdmin:g.isAdmin,isProvider:g.isProvider,isLogged:g.isLogged,logout:function(){g.isLogged()&&(g.setLogged(!1),g.setAdmin(!1),g.setProvider(!1),f.setSubscribed(!1),f.setTsPlan(!1),f.setExpiry(!1),delete d.sessionStorage.userID,delete d.sessionStorage.username,delete d.sessionStorage.token,delete d.sessionStorage.email,a.app.settings.token=null,delete c.token)}}},i.app=a.app,angular.isDefined(b.settings)?(a.app.settings=b.settings,a.app.settings.show||(a.app.settings.show={deck:null,article:null,decks:null}),a.app.settings.show.deck||(a.app.settings.show.deck=null),a.app.settings.show.article||(a.app.settings.show.article=null),a.app.settings.show.decks||(a.app.settings.show.decks=null)):b.settings=a.app.settings,a.$watch("app.settings",function(){b.settings=a.app.settings},!0)}]).controller("RootCtrl",["$scope","LoginModalService",function(a,b){a.loginModal=function(a){b.showModal(a)}}]).controller("404Ctrl",["$scope","MetaService",function(a,b){b.setStatusCode(404)}]).controller("UserCtrl",["$scope","$location","$window","$state","$cookies","UserService","AuthenticationService","AlertService","SubscriptionService",function(a,b,c,d,e,f,g,h,i){a.remember,a.loginInfo={email:"",password:""},a.verify={email:"",code:""};var j=e.rememberEmail,k=e.rememberPassword;void 0!=j&&void 0!=k&&(a.remember=!0,a.loginInfo.email=j,a.loginInfo.password=k),h.hasAlert()&&(a.success=h.getSuccess(),h.reset()),a.login=function(d,e){void 0!==d&&void 0!==e&&f.login(d,e).success(function(d){g.setLogged(!0),g.setAdmin(d.isAdmin),g.setProvider(d.isProvider),i.setSubscribed(d.subscription.isSubscribed),i.setTsPlan(d.subscription.plan),i.setExpiry(d.subscription.expiry),c.sessionStorage.userID=d.userID,c.sessionStorage.username=d.username,c.sessionStorage.email=d.email,a.app.settings.token=c.sessionStorage.token=d.token,b.path("/")}).error(function(b,c){a.showError=!0})}}]).controller("UserVerifyCtrl",["$scope","$location","$window","$state","$stateParams","UserService","AuthenticationService","SubscriptionService",function(a,b,c,d,e,f,g,h){a.verify={email:e.email||"",code:e.code||""},a.verifyEmail=function(){f.verifyEmail(a.verify.email,a.verify.code).success(function(b){b.success?(g.setLogged(!0),g.setAdmin(b.isAdmin),g.setProvider(b.isProvider),h.setSubscribed(b.subscription.isSubscribed),h.setTsPlan(b.subscription.plan),h.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,d.transitionTo("app.home",{})):(a.errors=b.errors,a.showError=!0)})},void 0!==a.verify.email&&a.verify.email.length&&void 0!==a.verify.code&&a.verify.code.length&&a.verifyEmail()}]).controller("UserResetPasswordCtrl",["$scope","$state","$stateParams","UserService","AlertService",function(a,b,c,d,e){a.reset={email:c.email||"",code:c.code||"",password:"",cpassword:""},a.resetPassword=function(){d.resetPassword(a.reset.email,a.reset.code,a.reset.password,a.reset.cpassword).success(function(c){c.success?(e.setSuccess({show:!0,msg:"Your password has been reset successfully."}),b.transitionTo("app.login",{})):(a.errors=c.errors,a.showError=!0)})}}]).controller("HomeCtrl",["$scope","$sce","dataArticles","ArticleService",function(a,b,c,d){a.articles={loading:!1,viewable:function(){switch(a.app.bootstrapWidth){case"xs":return 1;case"sm":return 3;case"md":return 4;case"lg":case"default":return 6}},perpage:function(){switch(a.app.bootstrapWidth){case"xs":return 1;case"sm":return 3;case"md":return 4;case"lg":case"default":return 6}},offset:0,total:c.total,data:c.articles},a.getArticleDesc=function(a,b){var c=a.split(" ");return c.length>b?c.slice(0,b).join(" ")+"...":c.join(" ")},a.isArticleActive=function(a){return!0},a.canArticlePrev=function(){return a.articles.offset>0},a.canArticleNext=function(){return a.articles.data.length<a.articles.total},a.prevArticles=function(){a.articles.offset=a.articles.offset-a.articles.perpage()>=0?a.articles.offset-a.articles.perpage():0},a.nextArticles=function(){if(a.articles.offset+a.articles.viewable()+a.articles.perpage()<=a.articles.data.length)a.articles.offset+=a.articles.perpage();else{var b=a.articles.data.length+a.articles.perpage()<=a.articles.total?a.articles.perpage():a.articles.total-a.articles.data.length;b>0&&(a.articles.loading="next",d.getArticles("all","all",a.articles.data.length,b).then(function(c){a.articles.data=a.articles.data.concat(c.articles),a.articles.offset+=b,a.articles.loading=!1}))}}}]).controller("HearthstoneHomeCtrl",["$scope","$timeout","dataArticles","dataDecksCommunity","dataDecksTempostorm","ArticleService","DeckService","Hearthstone",function(a,b,c,d,e,f,g,h){function i(c,d){f.getArticles("hs",a.filters.classes,c,d).then(function(c){b(function(){a.articles=c.articles})})}function j(c,d){g.getDecksFeatured(a.filters.classes,c,d,a.filters.search).then(function(c){b(function(){a.tempostormDecks=c.decks})})}function k(c,d){g.getDecksCommunity(a.filters.classes,c,d,a.filters.search).then(function(c){b(function(){a.communityDecks=c.decks})})}a.articles=c.articles,a.tempostormDecks=e.decks,a.communityDecks=d.decks,a.classes=angular.copy(h.classes).splice(1,9),a.filters={classes:[],search:""};var l=!0;a.$watch(function(){return a.filters},function(a){l?b(function(){l=!1}):(i(0,6),j(1,10),k(1,10))},!0),a.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1}}]).controller("PremiumCtrl",["$scope","$state","$window","$compile","bootbox","UserService","LoginModalService",function(a,b,c,d,e,f,g){var h,i;a.getPremium=function(c){a.app.user.isLogged()?a.app.user.isSubscribed()||b.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:c}):g.showModal("login",function(){a.getPremium(c)})},a.login=function(b,d){void 0!==b&&void 0!==d&&f.login(b,d).success(function(b){AuthenticationService.setLogged(!0),AuthenticationService.setAdmin(b.isAdmin),AuthenticationService.setProvider(b.isProvider),SubscriptionService.setSubscribed(b.subscription.isSubscribed),SubscriptionService.setTsPlan(b.subscription.plan),SubscriptionService.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,h.modal("hide"),i()}).error(function(){a.showError=!0})}}]).controller("ProfileCtrl",["$scope","dataProfile","MetaService","HOTSGuideService",function(a,b,c,d){function e(){return a.app.user.getUsername()==a.user.username?"My Profile":"@"+a.user.username+" - Profile"}a.user=b.user,a.postCount=b.postCount,a.deckCount=b.deckCount,a.guideCount=b.guideCount,a.activities=b.activities,a.metaservice=c,a.metaservice.set(e())}]).controller("ProfileEditCtrl",["$scope","$state","ProfileService","AlertService","dataProfileEdit",function(a,b,c,d,e){a.profile=e.user,d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.editProfile=function(){c.updateProfile(a.profile).success(function(c){if(c.success){var e="Your profile has been updated successfully.";a.profile.changeEmail&&(e+=" Email address changes must be verified by email before they will take effect."),d.setSuccess({show:!0,msg:e}),b.go(b.current,{username:a.profile.username},{reload:!0})}else console.log(c.error)})}}]).controller("ProfileEmailChangeCtrl",["$scope","$state","$stateParams","AlertService","data",function(a,b,c,d,e){return e.success&&d.setSuccess({show:!0,msg:"An email has been sent to the new address. Please confirm your new email before changes take effect."}),b.transitionTo("app.profile.edit",{username:c.username})}]).controller("ProfileEmailConfirmCtrl",["$scope","$state","$stateParams","AlertService","data",function(a,b,c,d,e){return e.success&&d.setSuccess({show:!0,msg:"Your email address has been updated successfully."}),b.transitionTo("app.profile.edit",{username:c.username})}]).controller("ProfileSubscriptionCtrl",["$scope","$stateParams","SubscriptionService","dataProfileEdit",function(a,b,c,d){if(a.loading=!1,a.profile=d.user,a.error="",a.success="",a.profile.subscription.isSubscribed)a.plan=d.user.subscription.plan||"tempostorm_semi";else{var e;switch(b.plan){case"monthly":e="tempostorm_monthly";break;case"quarterly":e="tempostorm_quarterly";break;case"semi":default:e="tempostorm_semi"}a.plan=e}a.isLoading=function(){return a.loading},a.setLoading=function(b){a.loading=b},a.setSuccess=function(b){a.error="",a.success=b},a.setError=function(b){a.success="",a.error=b},a.setErrorCode=function(b){a.error="An error has occured. Code: "+b+": "+a.getError(b)},a.getError=function(a){switch(a){case 400:return"Missing a required parameter.";case 401:return"No valid API key provided.";case 402:return"Parameters were valid but request failed. Check your information and please try again.";case 404:return"The requested item doesn't exist!";case 500:return"Something went wrong on Stripe's end."}},a.getExpiryDate=function(){var b=a.profile.subscription.expiryDate;if(!b)return!1;var c=(new Date).getTime(),d=new Date(b).getTime();return d>c?d:!1},a.isSubscribed=function(){return a.profile.subscription.isSubscribed},a.subscribe=function(b,d){a.setLoading(!0),d.error?(a.setErrorCode(b),a.setLoading(!1)):c.setPlan(a.plan,d.id).success(function(b){b.success?(c.setSubscribed(!0),c.setTsPlan(b.plan),a.profile.subscription.isSubscribed=!0,a.profile.subscription.plan=b.plan,a.number="",a.cvc="",a.expiry="",a.error="",a.setSuccess("We have successfully processed your payment. Thank you for subscribing with TempoStorm.com!")):(a.setError("An unknown error has occured."),a.setLoading(!1))})},a.updateCard=function(b,d){d.error?console.log(d):c.setCard(d.id).success(function(b){b.success?(a.profile.subscription.last4=b.subscription.last4,a.cardPlaceholder="xxxx xxxx xxxx "+b.subscription.last4,a.number="",a.cvc="",a.expiry=""):console.log("error")})},a.updatePlan=function(){c.setPlan(a.plan).success(function(b){b.success&&(c.setTsPlan(b.plan),a.profile.subscription.plan=b.plan,a.plan=b.plan)})},a.cancel=function(){c.cancel().success(function(b){b.success&&(c.setSubscribed(!1),c.setExpiry(b.subscription.expiryDate),a.profile.subscription.isSubscribed=!1,a.profile.subscription.expiryDate=b.subscription.expiryDate)})}}]).controller("ProfileActivityCtrl",["$scope","$sce","dataActivity","ProfileService","HOTSGuideService","DeckService",function(a,b,c,d,e,f){a.activities=c.activities,a.total=c.total,a.filterActivities=["comments","articles","decks","guides","forumposts"],a.getActivityType=function(a){switch(a.activityType){case"articleComment":case"deckComment":case"forumComment":case"guideComment":case"snapshotComment":return"comments";case"createArticle":return"articles";case"createDeck":return"decks";case"createGuide":return"guides";case"forumPost":return"forumposts"}},a.isFiltered=function(b){for(var c=0;c<a.filterActivities.length;c++)if(a.filterActivities[c]==b)return!0;return!1},a.toggleFilter=function(b){for(var c=0;c<a.filterActivities.length;c++)if(console.log(a.filterActivities[c],b),b==a.filterActivities[c])return void a.filterActivities.splice(c,1);a.filterActivities.push(b)},a.activities.forEach(function(a){a.getActivity=function(){return b.trustAsHtml(a.activity)}}),a.loadActivities=function(){d.getActivity(a.user.username,a.activities.length).then(function(b){a.activities=a.activities.concat(b.activities)})},a.deleteGuide=function(b){var c=bootbox.dialog({title:"Delete guide: "+b.guide.name+"?",message:"Are you sure you want to delete <strong>"+b.guide.name+"</strong>? All the data will be permanently deleted!",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){e.guideDelete(b.guide._id).success(function(c){c.success&&(b.exists=!1,a.success={show:!0,msg:'guide "'+b.guide.name+'" deleted successfully.'})})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){c.modal("hide")}}}});c.modal("show")},a.deleteDeck=function(b){var c=bootbox.dialog({title:"Delete deck: "+b.deck.name+"?",message:"Are you sure you want to delete <strong>"+b.deck.name+"</strong>? All the data will be permanently deleted!",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){f.deckDelete(b.deck._id).success(function(c){c.success&&(b.exists=!1,a.success={show:!0,msg:'deck "'+b.deck.name+'" deleted successfully.'})})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){c.modal("hide")}}}});c.modal("show")}}]).controller("ProfileArticlesCtrl",["$scope","dataArticles",function(a,b){a.articles=b.articles}]).controller("ProfileDecksCtrl",["$scope","$state","bootbox","DeckService","dataDecks",function(a,b,c,d,e){a.decks=e.decks,a.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1},a.deckEdit=function(a,c){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1,b.transitionTo("app.hs.deckBuilder.edit",{slug:c.slug})},a.deckDelete=function(b,e){b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),b.cancelBubble=!0,b.returnValue=!1;var f=c.dialog({title:"Delete deck: "+e.name+"?",message:"Are you sure you want to delete the deck <strong>"+e.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){d.deckDelete(e._id).success(function(b){if(b.success){var c=a.decks.indexOf(e);-1!==c&&a.decks.splice(c,1),a.success={show:!0,msg:'Deck "'+e.name+'" deleted successfully.'}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){f.modal("hide")}}}});f.modal("show")}}]).controller("ProfileGuidesCtrl",["$scope","$state","bootbox","HOTSGuideService","dataGuides",function(a,b,c,d,e){a.guides=e.guides,a.getGuideCurrentHero=function(a){return a.currentHero?a.currentHero:a.heroes[0]},a.getGuideClass=function(b){return"hero"==b.guideType?a.getGuideCurrentHero(b).hero.className:b.maps[0].className},a.guidePrevHero=function(b,c){b.preventDefault(),b.stopPropagation();for(var d=a.getGuideCurrentHero(c),e=0,f=0;f<c.heroes.length;f++)if(d.hero._id==c.heroes[f].hero._id){e=f;break}c.currentHero=0==e?c.heroes[c.heroes.length-1]:c.heroes[e-1]},a.guideNextHero=function(b,c){b.preventDefault(),b.stopPropagation();for(var d=a.getGuideCurrentHero(c),e=0,f=0;f<c.heroes.length;f++)if(d.hero._id==c.heroes[f].hero._id){e=f;break}c.currentHero=e==c.heroes.length-1?c.heroes[0]:c.heroes[e+1]},a.getTalents=function(a,b){for(var c=[],d=0;d<a.hero.talents.length;d++)a.hero.talents[d].tier===b&&c.push(a.hero.talents[d]);return c},a.selectedTalent=function(a,b,c){return a.talents["tier"+b]._id==c._id},a.getTalent=function(a,b){for(var c=0;c<a.hero.talents.length;c++)if(a.talents["tier"+b]==a.hero.talents[c]._id)return a.hero.talents[c];return!1},a.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1},a.guideEdit=function(a,c){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1,"hero"==c.guideType?b.transitionTo("app.hots.guideBuilder.edit.hero",{slug:c.slug}):b.transitionTo("app.hots.guideBuilder.edit.map",{slug:c.slug})},a.guideDelete=function(b,e){b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),b.cancelBubble=!0,b.returnValue=!1;var f=c.dialog({title:"Delete guide: "+e.name+"?",message:"Are you sure you want to delete the guide <strong>"+e.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){d.guideDelete(e._id).success(function(b){if(b.success){var c=a.guides.indexOf(e);-1!==c&&a.guides.splice(c,1),a.success={show:!0,msg:'guide "'+e.name+'" deleted successfully.'}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){f.modal("hide")}}}});f.modal("show")}}]).controller("ProfilePostsCtrl",["$scope","dataPosts",function(a,b){a.posts=b.activity}]).controller("AdminCardAddCtrl",["$scope","$window","$stateParams","$upload","$compile","bootbox","Util","Hearthstone","AdminCardService",function(a,b,c,d,e,f,g,h,i){var j={id:"",name:"",cost:"",cardType:h.types[0],rarity:h.rarities[0],race:h.races[0],playerClass:h.classes[0],expansion:h.expansions[0],text:"",mechanics:[],flavor:"",artist:"",attack:"",health:"",durabiltiy:"",dust:"",photos:{small:"",medium:"",large:""},deckable:!0,active:!0};a.cardImg=a.deckImg=a.app.cdn+"img/blank.png",a.card=angular.copy(j),a.cardTypes=g.toSelect(h.types),a.cardRarities=g.toSelect(h.rarities),a.cardRaces=g.toSelect(h.races),a.cardClasses=g.toSelect(h.classes),a.cardMechanics=g.toSelect(h.mechanics),a.cardExpansions=g.toSelect(h.expansions),a.cardActive=a.cardDeckable=[{name:"Yes",value:!0},{name:"No",value:!1}],a.cardUpload=function(b){if(!b.length)return!1;var c=f.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var g=0;g<b.length;g++){var h=b[g];a.upload=d.upload({url:"/api/admin/upload/card",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.card.photos.medium=b.medium,a.card.photos.large=b.large,a.cardImg=a.app.cdn+b.path+b.large,c.modal("hide")})}},a.deckUpload=function(b){if(!b.length)return!1;var c=f.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var g=0;g<b.length;g++){var h=b[g];a.upload=d.upload({url:"/api/admin/upload/deck",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.card.photos.small=b.small,a.deckImg=a.app.cdn+b.path+b.small,c.modal("hide")})}},a.addCard=function(){a.showError=!1,a.showSuccess=!1,i.addCard(a.card).success(function(c){c.success?(a.showError=!1,a.card=angular.copy(j),a.form.$setPristine(),a.showSuccess=!0):(a.errors=c.errors,a.showError=!0),b.scrollTo(0,0)})}}]).controller("AdminCardEditCtrl",["$location","$scope","$window","$state","$upload","$compile","bootbox","Util","Hearthstone","AdminCardService","AlertService","data",function(a,b,c,d,e,f,g,h,i,j,k,l){return l&&l.success?(b.card=l.card,b.cardTypes=h.toSelect(i.types),b.cardRarities=h.toSelect(i.rarities),b.cardRaces=h.toSelect(i.races),b.cardClasses=h.toSelect(i.classes),b.cardMechanics=h.toSelect(i.mechanics),b.cardExpansions=h.toSelect(i.expansions),b.cardActive=b.cardDeckable=[{name:"Yes",value:!0},{name:"No",value:!1}],b.cardImg=b.card.photos.large.length?b.app.cdn+"cards/"+b.card.photos.large:b.app.cdn+"img/blank.png",b.deckImg=b.card.photos.small.length?b.app.cdn+"cards/"+b.card.photos.small:b.app.cdn+"img/blank.png",b.cardUpload=function(a){if(!a.length)return!1;var c=g.dialog({message:f('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(b),closeButton:!1,animate:!1});b.uploading=0,c.modal("show");for(var d=0;d<a.length;d++){var h=a[d];b.upload=e.upload({url:"/api/admin/upload/card",method:"POST",file:h}).progress(function(a){b.uploading=parseInt(100*a.loaded/a.total)}).success(function(a,d,e,f){b.card.photos.medium=a.medium,b.card.photos.large=a.large,b.cardImg=b.app.cdn+a.path+a.large,c.modal("hide")})}},b.deckUpload=function(a){if(!a.length)return!1;var c=g.dialog({message:f('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(b),closeButton:!1,animate:!1});b.uploading=0,c.modal("show");for(var d=0;d<a.length;d++){var h=a[d];b.upload=e.upload({url:"/api/admin/upload/deck",method:"POST",file:h}).progress(function(a){b.uploading=parseInt(100*a.loaded/a.total)}).success(function(a,d,e,f){b.card.photos.small=a.small,b.deckImg=b.app.cdn+a.path+a.small,c.modal("hide")})}},void(b.editCard=function(){b.showError=!1,b.showSuccess=!1,j.editCard(b.card).success(function(a){a.success?(k.setSuccess({show:!0,msg:b.card.name+" has been updated successfully."}),d.go("app.admin.hearthstone.cards.list")):(b.errors=a.errors,b.showError=!0,c.scrollTo(0,0))})})):a.path("/admin/cards")}]).controller("AdminCardListCtrl",["$scope","bootbox","Util","Hearthstone","AdminCardService","AlertService","Pagination","data",function(a,b,c,d,e,f,g,h){f.hasAlert()&&(a.success=f.getSuccess(),f.reset()),a.cards=h.cards,a.expansions=[{name:"All Expansions",value:""}].concat(c.toSelect(d.expansions)),a.classes=[{name:"All Classes",value:""}].concat(c.toSelect(d.classes)),a.types=[{name:"All Types",value:""}].concat(c.toSelect(d.types)),a.rarities=[{name:"All Rarities",value:""}].concat(c.toSelect(d.rarities)),a.filterExpansion=a.filterClass=a.filterType=a.filterRarity="",a.pagination=g["new"](),a.pagination.results=function(){return a.filtered?a.filtered.length:a.cards.length},a.deleteCard=function(c){var d=b.dialog({title:"Delete card: "+c.name+"?",message:"Are you sure you want to delete the card <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){e.deleteCard(c._id).then(function(b){if(b.success){var d=a.cards.indexOf(c);-1!==d&&a.cards.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminArticleAddCtrl",["$scope","$state","$window","$upload","$compile","bootbox","Hearthstone","Util","AlertService","AdminArticleService","AdminDeckService","AdminHOTSGuideService","dataGuides","dataArticles","dataProviders","dataHeroes","dataDecks",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var s=new Date;s.setMonth(s.getMonth()+1);var t,u={author:a.app.user.getUserID(),title:"",slug:{url:"",linked:!0
},description:"",content:"",photos:{large:"",medium:"",small:"",square:""},deck:void 0,guide:void 0,related:[],classTags:[],theme:"none",featured:!1,premium:{isPremium:!1,expiryDate:s},articleType:[],active:!0};a.search="",a.getDecks=function(){k.getDecks(1,10,r(a.search)).then(function(b){a.decks=b.decks})},a.getArticles=function(){j.getArticles(1,10,r(a.search)).then(function(b){a.articles=b.articles})},a.getGuides=function(){l.getGuides(1,10,r(a.search)).then(function(b){a.guides=b.guides})},a.addItemArticle=function(){t=f.dialog({message:e("<div article-item-add></div>")(a),closeButton:!0,animate:!0,onEscape:function(){a.search="",a.getDecks(),a.getGuides()}}),t.modal("show"),t.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.closeBox=function(){t.modal("hide")},a.modifyItem=function(b){switch(a.article.articleType.toString()){case"hs":a.article.deck=b;break;case"hots":a.article.guide=b}a.search="",t.modal("hide")},a.addRelatedArticle=function(){t=f.dialog({message:e("<div article-related-add></div>")(a),closeButton:!1,animate:!0}),t.modal("show"),t.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.isRelated=function(b){for(var c=0;c<a.article.related.length;c++)if(b._id==a.article.related[c]._id)return!0;return!1},a.modifyRelated=function(b){return a.isRelated(b)?void a.removeRelatedArticle(b):void a.article.related.push(b)},a.removeRelatedArticle=function(b){for(var c=0;c<a.article.related.length;c++)b._id===a.article.related[c]._id&&a.article.related.splice(c,1)},a.article=angular.copy(u),a.decks=q.decks,a.guides=[{_id:void 0,name:"No Guide"}].concat(m.guides),a.articles=n.articles,a.providers=o.users,a.setSlug=function(){return a.article.slug.linked?void(a.article.slug.url=h.slugify(a.article.title)):!1},a.toggleSlugLink=function(){a.article.slug.linked=!a.article.slug.linked,a.setSlug()},a.hasTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;return c&&!d||d&&!c},a.getTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;if(c&&!d)return["Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"];if(d&&!c){for(var e=[],f=0;f<p.heroes.length;f++)e.push(p.heroes[f].name);return e}},a.articleTypes=j.articleTypes(),a.articleFeatured=a.articlePremium=a.articleActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.articleTheme=[{name:"None",value:"none"},{name:"Overcast",value:"overcast"}],a.dateOptions={},a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.photoUpload=function(b){if(!b.length)return!1;var c=f.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var g=0;g<b.length;g++){var h=b[g];a.upload=d.upload({url:"/api/admin/upload/article",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.article.photos={large:b.large,medium:b.medium,small:b.small,square:b.square},a.cardImg=a.app.cdn+b.path+b.small,c.modal("hide")})}},a.getImage=function(){return a.imgPath="articles/",a.article?a.article.photos&&""===a.article.photos.small?a.app.cdn+"img/blank.png":a.app.cdn+a.imgPath+a.article.photos.small:"img/blank.png"},a.addArticle=function(){a.showError=!1,j.addArticle(a.article).success(function(d){d.success?(i.setSuccess({show:!0,msg:a.article.title+" has been added successfully."}),b.go("app.admin.articles.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminArticleEditCtrl",["$scope","$state","$window","$upload","$compile","$filter","bootbox","Hearthstone","Util","AlertService","AdminArticleService","AdminDeckService","AdminHOTSGuideService","data","dataDecks","dataGuides","dataArticles","dataProviders","dataHeroes",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var u;a.article=n.article,a.decks=[{_id:void 0,name:"No deck"}].concat(o.decks),a.guides=[{_id:void 0,name:"No Guide"}].concat(p.guides),a.articles=q.articles,a.providers=r.users,a.search="",a.getDecks=function(){l.getDecks(1,10,t(a.search)).then(function(b){a.decks=b.decks})},a.getArticles=function(){k.getArticles(1,10,t(a.search)).then(function(b){a.articles=b.articles})},a.getGuides=function(){m.getGuides(1,10,t(a.search)).then(function(b){a.guides=b.guides})},a.addItemArticle=function(){u=g.dialog({message:e("<div article-item-add></div>")(a),closeButton:!0,animate:!0,onEscape:function(){a.search="",a.getDecks(),a.getGuides()}}),u.modal("show"),u.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.modifyItem=function(b){switch(a.article.articleType.toString()){case"hs":a.article.deck=b;break;case"hots":a.article.guide=b}a.search="",u.modal("hide")},a.addRelatedArticle=function(){u=g.dialog({message:e("<div article-related-add></div>")(a),closeButton:!1,animate:!0}),u.modal("show"),u.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.isRelated=function(b){for(var c=0;c<a.article.related.length;c++)if(b._id==a.article.related[c]._id)return!0;return!1},a.modifyRelated=function(b){return a.isRelated(b)?void a.removeRelatedArticle(b):void a.article.related.push(b)},a.removeRelatedArticle=function(b){for(var c=0;c<a.article.related.length;c++)b._id===a.article.related[c]._id&&a.article.related.splice(c,1)},a.closeBox=function(){u.modal("hide")},a.setSlug=function(){return a.article.slug.linked?void(a.article.slug.url=i.slugify(a.article.title)):!1},a.toggleSlugLink=function(){a.article.slug.linked=!a.article.slug.linked,a.setSlug()},a.cardImg=a.article.photos.small&&a.article.photos.small.length?a.app.cdn+"articles/"+a.article.photos.small:a.app.cdn+"img/blank.png",a.hasTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;return c&&!d||d&&!c},a.getTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;if(c&&!d)return["Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"];if(d&&!c){for(var e=[],f=0;f<s.heroes.length;f++)e.push(s.heroes[f].name);return e}},a.articleTypes=k.articleTypes(),a.articleFeatured=a.articlePremium=a.articleActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.articleTheme=[{name:"None",value:"none"},{name:"Overcast",value:"overcast"}],a.article.premium.expiryDate=new Date(a.article.premium.expiryDate),a.dateOptions={},a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.photoUpload=function(b){if(!b.length)return!1;var c=g.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var h=b[f];a.upload=d.upload({url:"/api/admin/upload/article",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.article.photos={large:b.large,medium:b.medium,small:b.small,square:b.square},a.cardImg=a.app.cdn+b.path+b.small,c.modal("hide")})}},a.getImage=function(){return a.imgPath="articles/",a.article?a.article.photos&&""===a.article.photos.small?a.app.cdn+"img/blank.png":a.app.cdn+a.imgPath+a.article.photos.small:"img/blank.png"},a.editArticle=function(){a.showError=!1,k.editArticle(a.article).success(function(d){d.success?(j.setSuccess({show:!0,msg:a.article.title+" has been updated successfully."}),b.go("app.admin.articles.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})},a.getNames=function(){k.getNames(a.article).success(function(a){if(a.success){for(var b="",c=0;c<a.names.length;c++)b=b+a.names[c]+"<br>";var d=g.dialog({message:b,animate:!1});d.modal("show")}else console.log(a)})}}]).controller("AdminArticleListCtrl",["$scope","AdminArticleService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.articles=e.articles,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getArticles=function(){b.getArticles(a.page,a.perpage,a.search).then(function(b){a.articles=b.articles,a.page=b.page,a.total=b.total})},a.searchArticles=function(){a.page=1,a.getArticles()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getArticles()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteArticle=function(c){var d=bootbox.dialog({title:"Delete article: "+c.title+"?",message:"Are you sure you want to delete the article <strong>"+c.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteArticle(c._id).then(function(b){if(b.success){var d=a.articles.indexOf(c);-1!==d&&a.articles.splice(d,1),a.success={show:!0,msg:c.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminSnapshotListCtrl",["$scope","data","AdminSnapshotService","AlertService",function(a,b,c,d){d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.snapshots=b.snapshots,a.page=b.page,a.perpage=b.perpage,a.total=b.total,a.search=b.search,a.getSnapshots=function(){c.getSnapshots(a.page,a.perpage,a.search).then(function(b){a.snapshots=b.snapshots,a.page=b.page,a.total=b.total})},a.searchSnapshots=function(){a.page=1,a.getSnapshots()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getSnapshots()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteSnapshot=function(b){var d=bootbox.dialog({title:"Delete Meta Snapshot: "+b.title+"?",message:"Are you sure you want to delete the Meta Snapshot <strong>"+b.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.deleteSnapshot(b._id).then(function(c){if(c.success){var d=a.snapshots.indexOf(b);-1!==d&&a.snapshots.splice(d,1),a.success={show:!0,msg:b.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminSnapshotEditCtrl",["$scope","$compile","$timeout","$state","$window","$upload","data","AlertService","Util","bootbox","AdminDeckService","AdminSnapshotService","AdminUserService","AdminCardService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){for(var b=[],c=a.snapshot.tiers.length,d=c>2?2:c,e=0;d>e;e++)for(var f=0;f<a.snapshot.tiers[e].decks.length;f++)b.push(a.snapshot.tiers[e].decks[f]);return b}function p(b){for(var c=a.snapshot.tiers.length,d=c>2?2:c,e=0;d>e;e++)for(var f=0;f<a.snapshot.tiers[e].decks.length;f++)if(a.snapshot.tiers[e].decks[f].deck._id==b.deck._id){for(var g=0;g<a.snapshot.matches.length;g++)if(a.snapshot.matches[g]["for"]._id==b.deck._id||a.snapshot.matches[g].against._id==b.deck._id)return;return a.selectedDecks.push(b),void(a.tier=a.snapshot.tiers[e].tier)}z(b.deck)}function q(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r(b){k.getDecks(1,10,q(a.search)).then(function(a){c(function(){b(a)})})}function s(b){m.getProviders(1,10,q(a.search)).then(function(a){c(function(){b(a)})})}function t(a){n.getDeckableCards().then(function(b){c(function(){a(b)})})}function u(c,d){A=j.dialog({message:b("<div snapshot-add-deck></div>")(a),animate:!0,closeButton:!1}),A.modal("show")}function v(){B=j.dialog({message:b("<div snapshot-add-author></div>")(a),animate:!0,closeButton:!1}),B.modal("show")}function w(c,d){a.type=d,C=j.dialog({message:b("<div snapshot-add-card></div>")(a),animate:!0,closeButton:!1}),C.modal("show")}function x(b,c){for(var d=a.snapshot.tiers,e=(d.length,0);e<a.selectedDecks.length;e++){if(a.tier<3){a.matches.push(a.selectedDecks[e]);for(var f=0;f<a.matches.length;f++)a.snapshot.matches.push({"for":a.selectedDecks[e].deck,against:a.matches[f].deck,forChance:a.selectedDecks[e].deck._id===a.matches[f].deck._id?50:0,againstChance:a.selectedDecks[e].deck._id===a.matches[f].deck._id?50:0})}c&&a.snapshot.tiers[a.tier-1].decks.push(a.selectedDecks[e])}for(var f=0;f<a.removedDecks.length;f++)a.removeDeck(a.removedDecks[f]);return b()}function y(a){return a.deck={_id:a.deck._id,name:a.deck.name},a}function z(b){for(var c=0;c<a.snapshot.matches.length;c++)(b._id==a.snapshot.matches[c]["for"]._id||b._id==a.snapshot.matches[c].against._id)&&(a.snapshot.matches.splice(c,1),c--);for(var d=0;d<a.matches.length;d++)b._id==a.matches[d].deck._id&&(a.matches.splice(d,1),d--)}var A=void 0,B=void 0,C=void 0,D={tier:1,decks:[]},E={name:"",explanation:"",weeklyNotes:"",deck:void 0,rank:{current:1,last:[0,0,0,0,0,0,0,0,0,0,0,0]},tech:[]},F={user:void 0,description:"",klass:[]},G={title:"",cards:[],orderNum:1},H={card:void 0,toss:!1,orderNum:1};a.snapshot=g.snapshot,a.search="",a.decks=[],a.matches=o(),a.matching=!1,a.selectedDecks=[],a.removedDecks=[],a.photoUpload=function(c){if(!c.length)return!1;var d=j.dialog({message:b('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,d.modal("show");for(var e=0;e<c.length;e++){var g=c[e];a.upload=f.upload({url:"/api/admin/upload/snapshot",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,c,e,f){a.snapshot.photos={large:b.large,medium:b.medium,small:b.small,square:b.square},a.cardImg=a.app.cdn+b.path+b.small,d.modal("hide")})}},a.getImage=function(){return a.imgPath="snapshots/",a.snapshot?a.snapshot.photos&&""===a.snapshot.photos.small?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.snapshot.photos.small:"/img/blank.png"},a.updateDND=function(b,c,d){b.splice(c,1);for(var e=0;e<b.length;e++)b[e].orderNum=e+1;p(d),x(function(){a.selectedDecks=[],a.removedDecks=[],a.deckRanks()},!1)},a.openAddBox=function(b,c,d,e){switch(a.tier=c,a.deck=d,a.tech=e,b){case"author":s(function(c){a.authorData=c.users,v(c,b)});break;case"deck":r(function(d){a.deckData=d.decks,a.tierAbsolute=c-1,u(d,b)});break;case"card":t(function(c){a.cardData=c.cards,w(c,b)});break;default:console.log("That does not exist!")}},a.closeCardBox=function(){w.modal("hide"),w=void 0},a.closeBox=function(){j.hideAll(),a.search=""},a.closeDeckBox=function(){x(function(){j.hideAll(),a.deckRanks(),a.search="",a.selectedDecks=[],a.removedDecks=[]},!0)},a.setSlug=function(){return a.snapshot.slug.linked?void(a.snapshot.slug.url="meta-snapshot-"+a.snapshot.snapNum+"-"+i.slugify(a.snapshot.title)):!1},a.toggleSlugLink=function(){a.snapshot.slug.linked=!a.snapshot.slug.linked,a.setSlug()},a.isAuthor=function(b){for(var c=0;c<a.snapshot.authors.length;c++)if(b._id==a.snapshot.authors[c].user._id)return!0;return!1},a.addAuthor=function(b){if(a.isAuthor(b))return void a.removeAuthor(b);var c=angular.copy(F);c.user=b,a.snapshot.authors.push(c)},a.removeAuthor=function(b){for(var c=0;c<a.snapshot.authors.length;c++)b._id===a.snapshot.authors[c].user._id&&a.snapshot.authors.splice(c,1)},a.addTier=function(){var b=angular.copy(D);b.tier=a.snapshot.tiers.length+1,a.snapshot.tiers.push(b)},a.removePrompt=function(b){j.confirm("Are you sure you want to remove tier "+b.tier+"? All the deck data for this tier will be lost!",function(c){c&&a.$apply(function(){a.removeTier(b)})})},a.removeTier=function(b){for(var c=0;c<b.decks.length;c++)a.removedDecks.push(b.decks[c].deck);for(var d=0;d<a.snapshot.tiers.length;d++)if(b.tier===a.snapshot.tiers[d].tier){a.snapshot.tiers.splice(d,1);for(var c=0;c<a.snapshot.tiers.length;c++)a.snapshot.tiers[c].tier=c+1}x(function(){a.deckRanks},!0)},a.deckRanks=function(){for(var b=1,c=0;c<a.snapshot.tiers.length;c++)for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)a.snapshot.tiers[c].decks[d].rank.current=b++},a.changeAgainstChance=function(a){a.forChance=100-a.againstChance},a.changeForChance=function(a){a.againstChance=100-a.forChance},a.getMatches=function(b){for(var c=a.snapshot.matches,d=[],e=0;e<c.length;e++)(b==c[e]["for"]._id||b==c[e].against._id)&&d.push(c[e]);return d},a.addDeck=function(b){var c=(a.snapshot.tiers,a.selectedDecks),d=angular.copy(E);if(a.isDeck(b)||a.isSelected(b)){for(var e=0;e<a.selectedDecks.length;e++)b._id==a.selectedDecks[e].deck._id&&a.selectedDecks.splice(e,1);for(var f=0;f<a.matches.length;f++)b._id==a.matches[f].deck._id&&a.matches.splice(f,1);a.removeDeck(b)}else{for(var g=0;g<a.removedDecks.length;g++)b._id==a.removedDecks[g]._id&&a.removedDecks.splice(g,1);d.deck=b,c.push(y(d))}a.deckRanks()},a.isDeck=function(b){for(var c=0;c<a.matches.length;c++)if(b._id==a.matches[c].deck._id)return"true";return!1},a.isSelected=function(b){for(var c=0;c<a.selectedDecks.length;c++)if(b._id==a.selectedDecks[c].deck._id)return!0;return!1},a.removeDeckPrompt=function(b){j.confirm("Are you sure you want to remove deck "+b.name+"? All the data for this deck will be lost!",function(c){c&&a.$apply(function(){a.removeDeck(b)})})},a.removeDeck=function(b){for(var c=0;c<a.snapshot.tiers.length;c++){for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)b._id==a.snapshot.tiers[c].decks[d].deck._id&&(a.snapshot.tiers[c].decks.splice(d,1),d--);z(b)}a.deckRanks()},a.searchDecks=function(b){a.search=b,r(function(b){a.deckData=b.decks})},a.addCard=function(b,c){var d=a.tech,e=(a.deck,a.tier,angular.copy(H));e.toss=c,e.card=b;for(var f=0;f<a.snapshot.tiers.length;f++)for(var g=0;g<a.snapshot.tiers[f].decks.length;g++)for(var h=0;h<a.snapshot.tiers[f].decks[g].tech.length;h++)d.orderNum==a.snapshot.tiers[f].decks[g].tech[h].orderNum&&(a.isCard(b)||(e.orderNum=a.snapshot.tiers[f].decks[g].tech[h].cards.length,a.snapshot.tiers[f].decks[g].tech[h].cards.push(e)))},a.isCard=function(b){var c=a.tech;if(c){for(var d=0;d<c.cards.length;d++)if(b._id==c.cards[d]._id)return!0;return!1}},a.addTech=function(b,c){for(var d=angular.copy(G),e=0,f=0;f<a.snapshot.tiers.length;f++)for(var g=0;g<a.snapshot.tiers[f].decks.length;g++){b.rank.current==a.snapshot.tiers[f].decks[g].rank.current&&a.snapshot.tiers[f].decks[g].tech.push(d);for(var h=0;h<a.snapshot.tiers[f].decks[g].tech.length;h++)a.snapshot.tiers[f].decks[g].tech[h].orderNum=++e}},a.removeTech=function(b){for(var c=0;c<a.snapshot.tiers.length;c++)for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)for(var e=0;e<a.snapshot.tiers[c].decks[d].tech.length;e++)if(b.orderNum==a.snapshot.tiers[c].decks[d].tech[e].orderNum)return void a.snapshot.tiers[c].decks[d].tech.splice(e,1)},a.removeTechCard=function(a,b){for(var c in a.cards)if(b._id==a.cards[c]._id){a.cards.splice(c,1);break}},a.setBoth=function(a){a.both?a.both=!1:a.both=!0},a.trendsLength=12,a.trends=function(a){return new Array(a)},a.editSnapshot=function(){a.showError=!1,l.editSnapshot(a.snapshot).success(function(b){b.success?(h.setSuccess({show:!0,msg:a.snapshot.title+" has been edited successfully."}),d.go("app.admin.snapshots.list")):(a.errors=b.errors,a.showError=!0,e.scrollTo(0,0))})}}]).controller("AdminSnapshotAddCtrl",["$scope","$compile","$timeout","$upload","dataPrevious","$state","$window","AlertService","Util","bootbox","AdminDeckService","AdminSnapshotService","AdminUserService","AdminCardService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(b){for(var c=a.snapshot.tiers.length,d=c>2?2:c,e=0;d>e;e++)for(var f=0;f<a.snapshot.tiers[e].decks.length;f++)if(a.snapshot.tiers[e].decks[f].deck._id==b.deck._id){for(var g=0;g<a.snapshot.matches.length;g++)if(a.snapshot.matches[g]["for"]._id==b.deck._id||a.snapshot.matches[g].against._id==b.deck._id)return;return a.selectedDecks.push(b),void(a.tier=a.snapshot.tiers[e].tier)}y(b.deck)}function p(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function q(b){k.getDecks(1,10,p(a.search)).then(function(a){c(function(){b(a)})})}function r(b){m.getProviders(1,10,p(a.search)).then(function(a){c(function(){b(a)})})}function s(a){n.getDeckableCards().then(function(b){c(function(){a(b)})})}function t(c,d){z=j.dialog({message:b("<div snapshot-add-deck></div>")(a),animate:!0,closeButton:!1}),z.modal("show")}function u(){A=j.dialog({message:b("<div snapshot-add-author></div>")(a),animate:!0,closeButton:!1}),A.modal("show")}function v(c,d){a.type=d,B=j.dialog({message:b("<div snapshot-add-card></div>")(a),animate:!0,closeButton:!1}),B.modal("show")}function w(b,c){for(var d=a.snapshot.tiers,e=(d.length,0);e<a.selectedDecks.length;e++){if(a.tier<3){a.matches.push(a.selectedDecks[e]);for(var f=0;f<a.matches.length;f++)a.snapshot.matches.push({"for":a.selectedDecks[e].deck,against:a.matches[f].deck,forChance:a.selectedDecks[e].deck._id===a.matches[f].deck._id?50:0,againstChance:a.selectedDecks[e].deck._id===a.matches[f].deck._id?50:0})}c&&a.snapshot.tiers[a.tier-1].decks.push(a.selectedDecks[e])}for(var f=0;f<a.removedDecks.length;f++)a.removeDeck(a.removedDecks[f]);return b()}function x(a){return a.deck={_id:a.deck._id,name:a.deck.name},a}function y(b){for(var c=0;c<a.snapshot.matches.length;c++)(b._id==a.snapshot.matches[c]["for"]._id||b._id==a.snapshot.matches[c].against._id)&&(a.snapshot.matches.splice(c,1),c--);for(var d=0;d<a.matches.length;d++)b._id==a.matches[d].deck._id&&(a.matches.splice(d,1),d--)}var z=void 0,A=void 0,B=void 0,C={snapNum:1,title:"",authors:[],slug:{url:"",linked:!0},content:{intro:"",thoughts:""},matches:[],tiers:[],photos:{large:"",medium:"",small:"",square:""},votes:0,active:!1},D={user:void 0,description:"",klass:[]},E={tier:1,decks:[]},F={name:"",explanation:"",weeklyNotes:"",deck:void 0,rank:{current:1,last:[0,0,0,0,0,0,0,0,0,0,0,0]},tech:[]},G={title:"",cards:[],orderNum:1},H={card:void 0,toss:!1,both:!1,orderNum:1};a.snapshot=angular.copy(C),a.search="",a.decks=[],a.matches=[],a.matching=!1,a.selectedDecks=[],a.removedDecks=[],a.lockDND=!0,a.loaded=!1,a.updateDND=function(b,c,d){b.splice(c,1);for(var e=0;e<b.length;e++)b[e].orderNum=e+1;o(d),w(function(){a.selectedDecks=[],a.removedDecks=[],a.deckRanks()},!1)},a.photoUpload=function(c){if(!c.length)return!1;var e=j.dialog({message:b('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,e.modal("show");for(var f=0;f<c.length;f++){var g=c[f];a.upload=d.upload({url:"/api/admin/upload/snapshot",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,c,d,f){a.snapshot.photos={large:b.large,medium:b.medium,small:b.small,square:b.square},a.cardImg=a.app.cdn+b.path+b.small,e.modal("hide")})}},a.getImage=function(){return a.imgPath="/snapshots/",a.snapshot?a.snapshot.photos&&""===a.snapshot.photos.small?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.snapshot.photos.small:"/img/blank.png"},a.openAddBox=function(b,c,d,e){switch(a.tier=c,a.deck=d,a.tech=e,b){case"author":r(function(c){a.authorData=c.users,u(c,b)});break;case"deck":q(function(d){a.deckData=d.decks,a.tierAbsolute=c-1,t(d,b)});break;case"card":s(function(c){a.cardData=c.cards,v(c,b)});break;default:console.log("That does not exist!")}},a.closeCardBox=function(){v.modal("hide"),v=void 0},a.closeBox=function(){j.hideAll(),a.search=""},a.closeDeckBox=function(){w(function(){j.hideAll(),a.deckRanks(),a.search="",a.selectedDecks=[],a.removedDecks=[]},!0)},a.setSlug=function(){return a.snapshot.slug.linked?void(a.snapshot.slug.url="meta-snapshot-"+a.snapshot.snapNum+"-"+i.slugify(a.snapshot.title)):!1},a.toggleSlugLink=function(){a.snapshot.slug.linked=!a.snapshot.slug.linked,a.setSlug()},a.isAuthor=function(b){for(var c=0;c<a.snapshot.authors.length;c++)if(b._id==a.snapshot.authors[c].user._id)return!0;return!1},a.addAuthor=function(b){if(a.isAuthor(b))return void a.removeAuthor(b);var c=angular.copy(D);c.user=b,a.snapshot.authors.push(c)},a.removeAuthor=function(b){for(var c=0;c<a.snapshot.authors.length;c++)b._id===a.snapshot.authors[c].user._id&&a.snapshot.authors.splice(c,1)},a.addTier=function(){var b=angular.copy(E);b.tier=a.snapshot.tiers.length+1,a.snapshot.tiers.push(b)},a.removePrompt=function(b){j.confirm("Are you sure you want to remove tier "+b.tier+"? All the deck data for this tier will be lost!",function(c){c&&a.$apply(function(){a.removeTier(b)})})},a.removeTier=function(b){for(var c=0;c<b.decks.length;c++)a.removedDecks.push(b.decks[c].deck);for(var d=0;d<a.snapshot.tiers.length;d++)if(b.tier===a.snapshot.tiers[d].tier){a.snapshot.tiers.splice(d,1);for(var c=0;c<a.snapshot.tiers.length;c++)a.snapshot.tiers[c].tier=c+1}w(function(){a.deckRanks},!0)},a.deckRanks=function(){for(var b=1,c=0;c<a.snapshot.tiers.length;c++)for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)a.snapshot.tiers[c].decks[d].rank.current=b++},a.changeAgainstChance=function(a){a.forChance=100-a.againstChance},a.changeForChance=function(a){a.againstChance=100-a.forChance},a.getMatches=function(b){for(var c=a.snapshot.matches,d=[],e=0;e<c.length;e++)(b==c[e]["for"]._id||b==c[e].against._id)&&d.push(c[e]);return d},a.addDeck=function(b){var c=(a.snapshot.tiers,a.selectedDecks),d=angular.copy(F);if(d.name=b.name,a.isDeck(b)||a.isSelected(b)){for(var e=0;e<a.selectedDecks.length;e++)b._id==a.selectedDecks[e].deck._id&&a.selectedDecks.splice(e,1);for(var f=0;f<a.matches.length;f++)b._id==a.matches[f].deck._id&&a.matches.splice(f,1);a.removeDeck(b)}else{for(var g=0;g<a.removedDecks.length;g++)b._id==a.removedDecks[g]._id&&a.removedDecks.splice(g,1);d.deck=b,c.push(x(d))}a.deckRanks()},a.isDeck=function(b){for(var c=0;c<a.matches.length;c++)if(b._id==a.matches[c].deck._id)return"true";for(var d=2;d<a.snapshot.tiers.length;d++)for(var c=0;c<a.snapshot.tiers[d].decks.length;c++)if(b._id==a.snapshot.tiers[d].decks[c].deck._id)return!0;return!1},a.isSelected=function(b){for(var c=0;c<a.selectedDecks.length;c++)if(b._id==a.selectedDecks[c].deck._id)return!0;return!1},a.removeDeckPrompt=function(b){j.confirm("Are you sure you want to remove deck "+b.name+"? All the data for this deck will be lost!",function(c){c&&a.$apply(function(){a.removeDeck(b)})})},a.removeDeck=function(b){for(var c=0;c<a.snapshot.tiers.length;c++){for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)b._id==a.snapshot.tiers[c].decks[d].deck._id&&(a.snapshot.tiers[c].decks.splice(d,1),d--);y(b)}a.deckRanks()},a.searchDecks=function(b){a.search=b,q(function(b){a.deckData=b.decks})},a.addCard=function(b,c){var d=a.tech,e=(a.deck,a.tier,angular.copy(H));e.toss=c,e.card=b;for(var f=0;f<a.snapshot.tiers.length;f++)for(var g=0;g<a.snapshot.tiers[f].decks.length;g++)for(var h=0;h<a.snapshot.tiers[f].decks[g].tech.length;h++)d.orderNum==a.snapshot.tiers[f].decks[g].tech[h].orderNum&&(a.isCard(b)||(e.orderNum=a.snapshot.tiers[f].decks[g].tech[h].cards.length,a.snapshot.tiers[f].decks[g].tech[h].cards.push(e)))},a.isCard=function(b){var c=a.tech;if(c){for(var d=0;d<c.cards.length;d++)if(b._id==c.cards[d]._id)return!0;return!1}},a.addTech=function(b,c){for(var d=angular.copy(G),e=0,f=0;f<a.snapshot.tiers.length;f++)for(var g=0;g<a.snapshot.tiers[f].decks.length;g++){b.rank.current==a.snapshot.tiers[f].decks[g].rank.current&&a.snapshot.tiers[f].decks[g].tech.push(d);for(var h=0;h<a.snapshot.tiers[f].decks[g].tech.length;h++)a.snapshot.tiers[f].decks[g].tech[h].orderNum=++e}},a.removeTech=function(b){for(var c=0;c<a.snapshot.tiers.length;c++)for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)for(var e=0;e<a.snapshot.tiers[c].decks[d].tech.length;e++)if(b.orderNum==a.snapshot.tiers[c].decks[d].tech[e].orderNum)return void a.snapshot.tiers[c].decks[d].tech.splice(e,1)},a.removeTechCard=function(a,b){for(var c in a.cards)if(b._id==a.cards[c]._id){a.cards.splice(c,1);break}},a.setBoth=function(a){a.both?a.both=!1:a.both=!0},a.trendsLength=12,a.trends=function(a){return new Array(a)},a.loadLatest=function(){l.getLatest().then(function(b){if(b.success){a.loaded=!0,a.snapshot=b.snapshot,a.snapshot.comments=[],a.snapshot.snapNum++,a.matches=[];for(var c=0;c<a.snapshot.tiers.length;c++)for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)2>c&&a.matches.push(b.snapshot.tiers[c].decks[d]),a.snapshot.tiers[c].decks[d].rank.last.splice(0,0,b.snapshot.tiers[c].decks[d].rank.current),a.snapshot.tiers[c].decks[d].rank.last.length>12&&a.snapshot.tiers[c].decks[d].rank.last.pop();a.deckRanks(),a.setSlug()}else a.errors=b.errors,a.showError=!0})},a.addSnapshot=function(){a.showError=!1,l.addSnapshot(a.snapshot).success(function(b){b.success?(h.setSuccess({show:!0,msg:a.snapshot.title+" has been added successfully."}),f.go("app.admin.snapshots.list")):(a.errors=b.errors,a.showError=!0,g.scrollTo(0,0))})}}]).controller("AdminTeamListCtrl",["$scope","data","AdminTeamService","AlertService",function(a,b,c,d){a.members=b.members,a.hsMembers=b.hsMembers,a.hotsMembers=b.hotsMembers,a.wowMembers=b.wowMembers,a.fifaMembers=b.fifaMembers,a.fgcMembers=b.fgcMembers,d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.updateDND=function(a,b){a.splice(b,1);for(var d=0;d<a.length;d++)a[d].orderNum=d+1;c.updateOrder(a)},a.deleteMember=function(b,d){var e=bootbox.dialog({title:"Delete member: "+b.screenName+" - "+b.fullName+"?",message:"Are you sure you want to delete the member <strong>"+b.screenName+" - "+b.fullName+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.deleteMember(b._id).then(function(c){if(c.success){var e=d.indexOf(b);-1!==e&&d.splice(e,1),a.success={show:!0,msg:b.screenName+" - "+b.fullName+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("TeamCtrl",["$scope","$compile","$timeout","$location","$anchorScroll","$sce","data",function(a,b,c,d,e,f,g){
a.members=g.members,a.hsMembers=g.hsMembers,a.hotsMembers=g.hotsMembers,a.wowMembers=g.wowMembers,a.fgcMembers=g.fgcMembers,a.fifaMembers=g.fifaMembers,d.hash()&&c(function(){e()});for(var h=0;h<a.members.length;h++)a.members[h].description=a.members[h].description.replace(/(?:\r\n|\r|\n)/g,"<br />");a.openLink=function(a,b){a.stopPropagation(),window.open(b,"_blank")},a.getTitle=function(a){for(var b=0;b<a.length&&"-"!=a[b];b++);return a=a.slice(0,b)},a.getDescription=function(a){var b=a,c=180;if(a.length>c){if(" "!=a[c]){for(var d=0;" "!=a[c+d];d++);a=b.slice(0,c+d)}else a=b.slice(0,c);a+="..."}return f.trustAsHtml(a)},a.showMember=function(c){a.member=c;bootbox.dialog({title:c.screenName,className:"member-modal",message:b('<button type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true">×</button><img class="responsive" src="{{app.cdn}}team/{{member.photo}}" /><div class="wrapper-md content-wrapper "><h1 class="m-b-xs">{{member.screenName}}</h1><span class="btn-team-wrapper-modal"><a href="#" target="_blank" ng-click="openLink($event, \'https://twitter.com/\' + member.social.twitter)" ng-if="member.social.twitter" class="m-r-xs btn-team"><div class="btn-team-inner"><i class="fa fa-twitter"></i></div></a><a href="#" target="_blank" ng-click="openLink($event, \'https://twitch.tv/\' + member.social.twitch)" ng-if="member.social.twitch" class="m-r-xs btn-team"><div class="btn-team-inner"><i class="fa fa-twitch"></i></div></a><a href="#" target="_blank" ng-click="openLink($event, \'https://youtube.com/\' + member.social.youtube)" ng-if="member.social.youtube" class="m-r-xs btn-team"><div class="btn-team-inner"><i class="fa fa-youtube"></i></div></a><a href="#" target="_blank" ng-click="openLink($event, \'https://facebook.com/\' + member.social.facebook)" ng-if="member.social.facebook" class="m-r-xs btn-team"><div class="btn-team-inner"><i class="fa fa-facebook"></i></div></a><a href="#" target="_blank" ng-click="openLink($event, \'https://instagram.com/\' + member.social.instagram)" ng-if="member.social.instagram" class="m-r-xs btn-team"><div class="btn-team-inner"><i class="fa fa-instagram"></i></div></a></span><h3>{{member.fullName}}</h3><p>{{member.description}}</p></div>')(a)})}}]).controller("AdminTeamAddCtrl",["$scope","$state","$window","$upload","$compile","AdminTeamService","AlertService",function(a,b,c,d,e,f,g){var h={game:"",screenName:"",fullName:"",description:"",social:{twitter:"",twitch:"",youtube:"",facebook:"",instagram:"",esea:""},photo:"",active:!0};a.member=angular.copy(h),a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=d.upload({url:"/api/admin/upload/team",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.member.photo=b.photo,a.cardImg=a.app.cdn+b.path+b.photo,c.modal("hide")})}},a.getImage=function(){return a.imgPath="/team/",a.member?a.member.photo&&""===a.member.photo?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.member.photo:"/img/blank.png"},a.saveMember=function(){f.addMember(a.member).then(function(d){d.success?(g.setSuccess({show:!0,msg:a.member.screenName+" - "+a.member.fullName+" has been added successfully."}),b.go("app.admin.teams.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminTeamEditCtrl",["$scope","$state","$window","$compile","$upload","data","AdminTeamService","AlertService",function(a,b,c,d,e,f,g,h){a.member=f.member,a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:d('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=e.upload({url:"/api/admin/upload/team",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.member.photo=b.photo,a.cardImg=a.app.cdn+b.path+b.photo,c.modal("hide")})}},a.getImage=function(){return a.imgPath="/team/",a.team?a.snapshot.photo&&""===a.snapshot.photo?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.snapshot.photo:"/img/blank.png"},a.saveMember=function(){g.editMember(a.member).then(function(d){d.success?(h.setSuccess({show:!0,msg:a.member.screenName+" - "+a.member.fullName+" has been added successfully."}),b.go("app.admin.teams.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminVodListCtrl",["$scope","data","AdminVodService",function(a,b,c){a.vods=b.vods,a.getDate=function(a){return a=new Date(a)},a.convertMonth=function(a){switch(a){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December"}},a.deleteVod=function(b){var d=bootbox.dialog({title:"Delete VOD: "+b.date+"?",message:"Are you sure you want to delete the VOD <strong>"+b.date+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.vodRemove(b._id).then(function(c){if(c.success){var d=a.vods.indexOf(b);-1!==d&&a.vods.splice(d,1),a.success={show:!0,msg:b.date+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminVodAddCtrl",["$scope","$window","$state","AdminVodService","AlertService",function(a,b,c,d,e){var f={date:{},url:"",subTitle:"",vars:{list:""}};a.isPlaylist=!0,a.vod=angular.copy(f),a.saveVod=function(){d.vodAdd(a.vod).then(function(d){d.success?(e.setSuccess({show:!0,msg:"Video of the Day has been added successfully."}),a.showSuccess=!0,a.vod=angular.copy(f),a.playlist={vars:{list:""}},c.go("app.admin.vod.add")):(a.errors=d.errors,a.showError=!0),b.scrollTo(0,0)})}}]).controller("AdminVodEditCtrl",["$scope","$state","$window","data","AdminVodService","AlertService",function(a,b,c,d,e,f){d.vod.date=Date.parse(d.vod.date),a.vod=d.vod,a.isPlaylist=""!=a.vod.url?!1:!0,a.saveVod=function(){e.vodEdit(a.vod).then(function(d){d.success?(f.setSuccess({show:!0,msg:"Video of the Day has been edited successfully."}),a.showSuccess=!0,b.go("app.admin.vod.add")):(a.errors=d.errors,a.showError=!0),c.scrollTo(0,0)})}}]).controller("AdminDeckListCtrl",["$scope","AdminDeckService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.decks=e.decks,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getDecks=function(){b.getDecks(a.page,a.perpage,a.search).then(function(b){a.decks=b.decks,a.page=b.page,a.total=b.total})},a.searchDecks=function(){a.page=1,a.getDecks()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getDecks()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteDeck=function(c){var d=bootbox.dialog({title:"Delete deck: "+c.name+"?",message:"Are you sure you want to delete the deck <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteDeck(c._id).then(function(b){if(b.success){var d=a.decks.indexOf(c);-1!==d&&a.decks.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminDeckBuilderClassCtrl",["$scope",function(a){function b(b){return a.heroes[b]["class"][0].toUpperCase()+a.heroes[b]["class"].slice(1)}function c(a){return d[a]==Hearthstone.heroNames[b(a)].length-1?0:++d[a]}(void 0==a.app.settings.secondaryPortrait||0==a.app.settings.secondaryPortrait.length)&&(a.app.settings.secondaryPortrait=[0,0,0,0,0,0,0,0,0]);var d=a.app.settings.secondaryPortrait;a.heroNames=Hearthstone.heroNames,a.klass=!1,a.heroes=[{"class":"druid",hasSecondary:Hearthstone.heroNames.Druid.length>1,secondary:d[0]},{"class":"hunter",hasSecondary:Hearthstone.heroNames.Hunter.length>1,secondary:d[1]},{"class":"mage",hasSecondary:Hearthstone.heroNames.Mage.length>1,secondary:d[2]},{"class":"paladin",hasSecondary:Hearthstone.heroNames.Paladin.length>1,secondary:d[3]},{"class":"priest",hasSecondary:Hearthstone.heroNames.Priest.length>1,secondary:d[4]},{"class":"rogue",hasSecondary:Hearthstone.heroNames.Rogue.length>1,secondary:d[5]},{"class":"shaman",hasSecondary:Hearthstone.heroNames.Shaman.length>1,secondary:d[6]},{"class":"warlock",hasSecondary:Hearthstone.heroNames.Warlock.length>1,secondary:d[7]},{"class":"warrior",hasSecondary:Hearthstone.heroNames.Warrior.length>1,secondary:d[8]}],a.getName=function(a,c){if(c)return Hearthstone.heroNames[b(a)][d[a]];var e=Hearthstone.heroNames[b(a)][d[a]];return e[0].toLowerCase()+e.slice(1)},a.updateHero=function(b){var e=c(b);d[b]=e,a.app.settings.secondaryPortrait[b]=e};for(var e=0;e<a.app.settings.secondaryPortrait.length;e++)(void 0==a.getName(e,!0)||""==a.getName(e,!0))&&(a.app.settings.secondaryPortrait[e]=0,d[e]=0)}]).controller("AdminDeckAddCtrl",["$state","$scope","$compile","$q","$timeout","$window","AjaxPagination","Hearthstone","DeckBuilder","ImgurService","AlertService","AdminDeckService","data",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a,c,d,f,g,h){b.fetching=!0,i.loadCards(a,c,d,f,g,b.className.toLowerCase()).then(function(c){b.classPagination.total=b.isClassCards()?c.classTotal:c.neutralTotal,b.classPagination.page=a,b.neutralPagination.total=b.isClassCards()?c.classTotal:c.neutralTotal,b.neutralPagination.page=a,e(function(){return b.cards.current=b.isClassCards()?c.cards["class"]:c.cards.neutral,b.fetching=!1,h?h(c):void 0})})}if(!m||!m.success)return a.transitionTo("app.hs.deckBuilder.class"),!1;b.step=1,b.showManaCurve=!1,b.classes=angular.copy(h.classes).splice(1,9),b.getDust=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].qty<2?a[c].dust:2*a[c].dust;return b},b.isSecondary=function(a){switch(a){case"druid":return b.app.settings.secondaryPortrait[0];case"hunter":return b.app.settings.secondaryPortrait[1];case"mage":return b.app.settings.secondaryPortrait[2];case"paladin":return b.app.settings.secondaryPortrait[3];case"priest":return b.app.settings.secondaryPortrait[4];case"rogue":return b.app.settings.secondaryPortrait[5];case"shaman":return b.app.settings.secondaryPortrait[6];case"warlock":return b.app.settings.secondaryPortrait[7];case"warrior":return b.app.settings.secondaryPortrait[8]}},b.getName=function(){return h.heroNames[b.deck.playerClass][b.isSecondary(b.deck.playerClass.toLowerCase())]},b.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},b.type=1,b.basic=!1,b.prevStep=function(){b.step>1&&(b.step=b.step-1)},b.nextStep=function(){b.step<5&&(b.step=b.step+1)},b.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]};var o=!0;b.isClassCards=function(){return o},b.className=m.className,b.cards=m.cards,b.cards.current=b.cards["class"],b.search=function(){n(1,15,b.filters.search,b.filters.mechanics,b.filters.mana)},b.classPagination=g["new"](15,m.classTotal,function(a,c){var e=d.defer();return n(a,c,b.filters.search,b.filters.mechanics,b.filters.mana,function(a){e.resolve(a.classTotal)}),e.promise}),b.neutralPagination=g["new"](15,m.neutralTotal,function(a,c){var e=d.defer();return n(a,c,b.filters.search,b.filters.mechanics,b.filters.mana,function(a){e.resolve(a.neutralTotal)}),e.promise}),b.filters={search:"",mechanics:[],mana:"all"},b.setClassCards=function(a){o=a,n(1,15,b.filters.search,b.filters.mechanics,b.filters.mana)},b.mechanics=h.mechanics,b.inMechanics=function(a){return b.filters.mechanics.indexOf(a)>=0},b.toggleMechanic=function(a){n(1,15,b.filters.search,b.filters.mechanics,b.filters.mana);var c=b.filters.mechanics.indexOf(a);-1===c?b.filters.mechanics.push(a):b.filters.mechanics.splice(c,1)},b.filters.byMechanics=function(){return function(a){if(!b.filters.mechanics.length)return!0;for(var c=0,d=0;d<a.mechanics.length;d++)b.inMechanics(a.mechanics[d])&&c++;return c===b.filters.mechanics.length}},b.doFilterByMana=function(a){b.filters.mana=a,n(1,15,b.filters.search,b.filters.mechanics,b.filters.mana)},b.filters.byMana=function(){return function(a){switch(b.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===b.filters.mana;case"7+":return a.cost>=7}}},b.getManaCost=function(){switch(b.filters.mana){case"all":return"All";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case"7+":return b.filters.mana}},b.deckTypes=h.deckTypes,b.deck=b.app.settings.deck&&null!==b.app.settings.deck&&m.className===b.app.settings.deck.playerClass?i["new"](m.className,b.app.settings.deck):i["new"](m.className),b.$watch("deck",function(){b.app.settings.deck={name:b.deck.name,deckType:b.deck.deckType,description:b.deck.description,chapters:b.deck.chapters,cards:b.deck.cards,matches:b.deck.matches,playerClass:b.deck.playerClass,type:b.deck.type,basic:b.deck.basic,mulligans:b.deck.mulligans,video:b.deck.video,"public":b.deck["public"]}},!0),b.currentMulligan=b.deck.getMulligan(b.classes[2]),b.setMulligan=function(a){b.currentMulligan=a},b.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length};var p={title:"",content:""};b.deck.chapters=[p],b.newChapter=function(){var a=angular.copy(p);b.deck.chapters.push(a)},b.removeChapter=function(a){b.deck.chapters.splice(a,1)};var q={deckName:"",klass:"",match:0};b.deck.matches=[],b.newMatch=function(a){var c=angular.copy(q);c.klass=a,b.deck.matches.push(c)},b.removeMatch=function(a){b.deck.matches.splice(a,1)},b.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isPremium=function(){for(var a=b.deck.premium.isPremium,c=0;c<b.premiumTypes.length;c++)if(b.premiumTypes[c].value===a)return b.premiumTypes[c].text},b.getMulliganCards=function(a){if(!b.currentMulligan)return!1;var c=b.currentMulligan;return a?c.withCoin.cards:c.withoutCoin.cards},b.cardLeft=function(a,c){return 80/b.getMulliganCards(c).length*a},b.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isFeatured=function(){for(var a=b.deck.featured,c=0;c<b.featuredTypes.length;c++)if(b.featuredTypes[c].value===a)return b.featuredTypes[c].text};b.saveDeck=function(){return b.deck.validDeck()&&b.deck.validVideo()?void(b.app.user.isLogged()?(b.deck.heroName=b.getName(),i.saveDeck(b.deck).success(function(c){c.success?(b.app.settings.deck=null,a.transitionTo("app.hs.decks.deck",{slug:c.slug})):(b.errors=c.errors,b.showError=!0,f.scrollTo(0,0))})):LoginModalService.showModal("login")):!1}}]).controller("AdminDeckEditCtrl",["$state","$q","$scope","$compile","$timeout","$window","AjaxPagination","Hearthstone","DeckBuilder","ImgurService","AlertService","AdminDeckService","data",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a,b,d,f,g,h){i.loadCards(a,b,d,f,g,c.className.toLowerCase()).then(function(b){c.classPagination.total=c.isClassCards()?b.classTotal:b.neutralTotal,c.classPagination.page=a,c.neutralPagination.total=c.isClassCards()?b.classTotal:b.neutralTotal,c.neutralPagination.page=a,e(function(){return c.cards.current=c.isClassCards()?b.cards["class"]:b.cards.neutral,h?h(b):void 0})})}if(!m||!m.success)return a.transitionTo("app.hs.deckBuilder.class"),!1;c.step=1,c.showManaCurve=!1,c.classes=angular.copy(h.classes).splice(1,9),c.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},c.isSecondary=function(a){switch(a){case"druid":return c.app.settings.secondaryPortrait[0];case"hunter":return c.app.settings.secondaryPortrait[1];case"mage":return c.app.settings.secondaryPortrait[2];case"paladin":return c.app.settings.secondaryPortrait[3];case"priest":return c.app.settings.secondaryPortrait[4];case"rogue":return c.app.settings.secondaryPortrait[5];case"shaman":return c.app.settings.secondaryPortrait[6];case"warlock":return c.app.settings.secondaryPortrait[7];case"warrior":return c.app.settings.secondaryPortrait[8]}},console.log(m),c.getDust=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].dust*a[c].qty;return b},c.prevStep=function(){c.step>1&&(c.step=c.step-1)},c.nextStep=function(){c.step<5&&(c.step=c.step+1)},c.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]};var o=!0;c.isClassCards=function(){return o},c.setClassCards=function(a){n(1,15,c.filters.search,c.filters.mechanics,c.filters.mana),e(function(){o=a})},c.className=m.deck.playerClass,c.cards={},c.search=function(){n(1,15,c.filters.search,c.filters.mechanics,c.filters.mana)},c.classPagination=g["new"](15,m.classTotal,function(a,d){var e=b.defer();return n(a,d,c.filters.search,c.filters.mechanics,c.filters.mana,function(a){e.resolve(a.classTotal)}),e.promise}),c.neutralPagination=g["new"](15,m.neutralTotal,function(a,d){var e=b.defer();return n(a,d,c.filters.search,c.filters.mechanics,c.filters.mana,function(a){e.resolve(a.neutralTotal)}),e.promise}),c.filters={search:"",mechanics:[],mana:"all"},c.mechanics=h.mechanics,c.inMechanics=function(a){return c.filters.mechanics.indexOf(a)>=0},c.toggleMechanic=function(a){n(1,15,c.filters.search,c.filters.mechanics,c.filters.mana);var b=c.filters.mechanics.indexOf(a);-1===b?c.filters.mechanics.push(a):c.filters.mechanics.splice(b,1)},c.filters.byMechanics=function(){return function(a){if(!c.filters.mechanics.length)return!0;for(var b=0,d=0;d<a.mechanics.length;d++)c.inMechanics(a.mechanics[d])&&b++;return b===c.filters.mechanics.length}},c.doFilterByMana=function(a){c.filters.mana=a,n(1,15,c.filters.search,c.filters.mechanics,c.filters.mana)},c.filters.byMana=function(){return function(a){switch(c.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===c.filters.mana;case"7+":return a.cost>=7}}},c.getManaCost=function(){switch(c.filters.mana){case"all":return"All";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case"7+":return c.filters.mana}},c.deckTypes=h.deckTypes,c.deck=i["new"](m.deck.className,m.deck),c.currentMulligan=c.deck.getMulligan(c.classes[2]),c.setMulligan=function(a){c.currentMulligan=a},c.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length};var p={title:"",content:""};c.newChapter=function(){var a=angular.copy(p);c.deck.chapters.push(a)},c.removeChapter=function(a){c.deck.chapters.splice(a,1)};var q={deckName:"",klass:"",match:0};c.newMatch=function(a){var b=angular.copy(q);b.klass=a,c.deck.matches.push(b)},c.removeMatch=function(a){c.deck.matches.splice(a,1)},c.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],c.isPremium=function(){for(var a=c.deck.premium.isPremium,b=0;b<c.premiumTypes.length;b++)if(c.premiumTypes[b].value===a)return c.premiumTypes[b].text},c.getMulliganCards=function(a){if(!c.currentMulligan)return!1;var b=c.currentMulligan;return a?b.withCoin.cards:b.withoutCoin.cards},c.cardLeft=function(a,b){return 80/c.getMulliganCards(b).length*a},c.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],c.isFeatured=function(){for(var a=c.deck.featured,b=0;b<c.featuredTypes.length;b++)if(c.featuredTypes[b].value===a)return c.featuredTypes[b].text},n(1,15,c.filters.search,c.filters.mechanics,c.filters.mana),c.updateDeck=function(){return c.deck.validDeck()&&c.deck.validVideo()?void i.updateDeck(c.deck).success(function(b){b.success?a.transitionTo("app.hs.decks.deck",{slug:b.slug}):(c.errors=b.errors,c.showError=!0,f.scrollTo(0,0))}):!1}}]).controller("AdminUserListCtrl",["$scope","bootbox","Pagination","AlertService","AdminUserService","data",function(a,b,c,d,e,f){d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.users=f.users,a.page=f.page,a.perpage=f.perpage,a.total=f.total,a.search=f.search,a.getUsers=function(){e.getUsers(a.page,a.perpage,a.search).then(function(b){a.users=b.users,a.page=b.page,a.total=b.total})},a.searchUsers=function(){a.page=1,a.getUsers()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getUsers()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteUser=function(c){var d=b.dialog({title:"Delete user: "+c.username+"?",message:"Are you sure you want to delete the user <strong>"+c.username+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){e.deleteUser(c._id).then(function(b){if(b.success){var d=a.users.indexOf(c);-1!==d&&a.users.splice(d,1),a.success={show:!0,msg:c.username+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminUserAddCtrl",["$scope","$state","$window","AdminUserService","AlertService",function(a,b,c,d,e){var f=new Date;f.setMonth(f.getMonth()+1);var g={email:"",username:"",password:"",cpassword:"",about:"",social:{twitter:"",facebook:"",twitch:"",instagram:"",youtube:""},subscription:{isSubscribed:!1,expiryDate:f},isProvider:!1,providerDescription:"",isAdmin:!1,active:!0};a.user=angular.copy(g),a.userSubscription=a.userProvider=a.userAdmin=a.userActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.dateOptions={},a.addUser=function(){d.addUser(a.user).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.user.username+" has been added successfully."}),b.go("app.admin.users.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminUserEditCtrl",["$scope","$state","$window","AdminUserService","AlertService","data",function(a,b,c,d,e,f){return f&&f.success?(a.user=f.user,a.userSubscription=a.userProvider=a.userAdmin=a.userActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.dateOptions={},void(a.editUser=function(){d.editUser(a.user).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.user.username+" has been updated successfully."}),b.go("app.admin.users.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})})):b.go("app.admin.users.list")}]).controller("AdminPollListCtrl",["$scope","$compile","bootbox","Pagination","AlertService","AdminPollService","data",function(a,b,c,d,e,f,g){e.hasAlert()&&(a.success=e.getSuccess(),e.reset()),a.polls=g.polls,a.page=g.page,a.perpage=g.perpage,a.total=g.total,a.search=g.search,a.getPolls=function(){f.getPolls(a.page,a.perpage,a.search).then(function(b){a.polls=b.polls,a.page=b.page,a.total=b.total})},a.searchPolls=function(){a.page=1,a.getPolls()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getPolls()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deletePoll=function(b){var d=c.dialog({title:"Delete poll: "+b.title+"?",message:"Are you sure you want to delete the poll <strong>"+b.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){f.deletePoll(b._id).then(function(c){if(c.success){var d=a.polls.indexOf(b);-1!==d&&a.polls.splice(d,1),a.success={show:!0,msg:b.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminPollAddCtrl",["$scope","$state","$window","$upload","$compile","AdminPollService","AlertService",function(a,b,c,d,e,f,g){var h,i={title:"",subTitle:"",description:"",type:"",active:!1,view:"",items:[]},j={name:"",orderNum:0,photos:{large:"",thumb:""}};a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.poll=angular.copy(i),a.item=angular.copy(j),a.currentItem=angular.copy(j),a.imgPath="polls/",a.pollType=[{name:"Image",value:"img"},{name:"Text",value:"txt"}],a.pollView=[{name:"Main",value:"main"},{name:"Sidebar",value:"side"},{name:"Hide",value:"hide"}],a.pollActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],a.voteLimit=function(){for(var b=[],c=0;c<a.poll.items.length;c++)b.push(c+1);return b},a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=d.upload({url:"/api/admin/upload/polls",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.currentItem.photos={large:b.large,thumb:b.thumb},c.modal("hide")})}},a.itemEditWnd=function(b){a.currentItem=b,h=bootbox.dialog({title:"Edit Item",message:e("<div poll-item-edit-form></div>")(a)})},a.editItem=function(){h.modal("hide"),a.currentItem=!1},a.deleteItem=function(b){var c=a.poll.items.indexOf(b);a.poll.items.splice(c,1);for(var d=0;d<a.poll.items.length;d++)a.poll.items[d].orderNum=d+1},a.itemAddWnd=function(){a.currentItem=angular.copy(a.item),h=bootbox.dialog({title:"Add Item",message:e("<div poll-item-add-form></div>")(a)})},a.addItem=function(){a.currentItem.orderNum=a.poll.items.length+1,a.poll.items.push(a.currentItem),h.modal("hide"),a.currentItem=!1},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.getImage=function(){return a.currentItem.photos&&""===a.currentItem.photos.thumb?a.app.cdn+"img/blank.png":a.app.cdn+a.imgPath+a.currentItem.photos.thumb},a.addPoll=function(){f.addPoll(a.poll).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.poll.title+" has been added successfully."}),b.go("app.admin.polls.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminPollEditCtrl",["$scope","$state","$window","$compile","$upload","AdminPollService","AlertService","data",function(a,b,c,d,e,f,g,h){var i,j={name:"",orderNum:0,photos:{large:"",thumb:""}};a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.poll=h.poll,a.item=angular.copy(j),a.currentItem=angular.copy(j),a.imgPath="polls/",a.pollType=[{name:"Image",value:"img"},{name:"Text",value:"txt"}],a.pollView=[{name:"Main",value:"main"},{name:"Sidebar",value:"side"},{name:"Hide",value:"hide"}],a.pollActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],a.voteLimit=function(){for(var b=[],c=0;c<a.poll.items.length;c++)b.push(c+1);return b},a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:d('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=e.upload({url:"/api/admin/upload/polls",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.currentItem.photos={large:b.large,thumb:b.thumb},c.modal("hide")})}},a.itemEditWnd=function(b){a.currentItem=b,i=bootbox.dialog({title:"Edit Item",message:d("<div poll-item-edit-form></div>")(a)})},a.editItem=function(){i.modal("hide"),a.currentItem=!1},a.deleteItem=function(b){var c=a.poll.items.indexOf(b);a.poll.items.splice(c,1);for(var d=0;d<a.poll.items.length;d++)a.poll.items[d].orderNum=d+1},a.itemAddWnd=function(){a.currentItem=angular.copy(a.item),i=bootbox.dialog({title:"Add Item",message:d("<div poll-item-add-form></div>")(a)})},a.addItem=function(){a.currentItem.orderNum=a.poll.items.length+1,a.poll.items.push(a.currentItem),i.modal("hide"),a.currentItem=!1},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.getImage=function(){return a.currentItem?a.currentItem.photos&&""===a.currentItem.photos.thumb?a.app.cdn+"img/blank.png":a.app.cdn+a.imgPath+a.currentItem.photos.thumb:"img/blank.png"},a.editPoll=function(){a.showError=!1,f.editPoll(a.poll).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.poll.title+" has been updated successfully."}),b.go("app.admin.polls.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminBannerListCtrl",["$scope","$compile","bootbox","Pagination","AlertService","AdminBannerService","data",function(a,b,c,d,e,f,g){e.hasAlert()&&(a.success=e.getSuccess(),
e.reset()),a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1;f.updateOrder(a)},a.tsBanners=g.tsBanners,a.hsBanners=g.hsBanners,a.hotsBanners=g.hotsBanners,a.page=g.page,a.perpage=g.perpage,a.total=g.total,a.search=g.search,a.getBanners=function(){f.getBanners(a.page,a.perpage,a.search).then(function(b){a.banners=b.banners,a.page=b.page,a.total=b.total})},a.deleteBanner=function(b,d){var e=c.dialog({title:"Delete banner: "+d.title+"?",message:"Are you sure you want to delete the banner <strong>"+d.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){f.deleteBanner(d._id).then(function(c){if(c.success){var e=a[b],f=e.indexOf(d);-1!==f&&e.splice(f,1),a.success={show:!0,msg:d.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("AdminBannerAddCtrl",["$scope","$state","$window","$upload","$compile","AdminBannerService","AlertService",function(a,b,c,d,e,f,g){var h={title:"",description:"",bannerType:"ts",active:!1,photo:"",button:{hasButton:!1,buttonText:"",buttonLink:""}};a.descriptionMax=250,a.hasButton=!1,a.summerNoteIsFull=function(a){},a.options={disableDragAndDrop:!0,height:100,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.banner=angular.copy(h),a.imgPath="banners/",a.bannerTypes=[{name:"TempoStorm",value:"ts"},{name:"Hearthstone",value:"hs"},{name:"Heroes of the Storm",value:"hots"}],a.bannerActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=d.upload({url:"/api/admin/upload/banners",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.banner.photo=b.large,c.modal("hide")})}},a.getImage=function(){return a.imgPath="banners/",""===a.banner.photo?a.app.cdn+"img/blank.png":a.app.cdn+a.imgPath+a.banner.photo},a.addBanner=function(){f.addBanner(a.banner).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.banner.title+" has been added successfully."}),b.go("app.admin.banners.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminBannerEditCtrl",["$window","$scope","$state","$compile","$upload","AlertService","data","AdminBannerService","$q",function(a,b,c,d,e,f,g,h,i){b.banner=g.banner,b.bannerTypes=[{name:"TempoStorm",value:"ts"},{name:"Hearthstone",value:"hs"},{name:"Heroes of the Storm",value:"hots"}],b.bannerActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],b.descriptionMax=250,b.summerNoteIsFull=function(){},b.options={disableDragAndDrop:!0,height:100,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},b.photoUpload=function(a){if(!a.length)return!1;var c=bootbox.dialog({message:d('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(b),closeButton:!1,animate:!1});b.uploading=0,c.modal("show");for(var f=0;f<a.length;f++){var g=a[f];b.upload=e.upload({url:"/api/admin/upload/banners",method:"POST",file:g}).progress(function(a){b.uploading=parseInt(100*a.loaded/a.total)}).success(function(a,d,e,f){b.banner.photo=a.large,c.modal("hide")})}},b.getImage=function(){return b.imgPath="banners/",""===b.banner.photo?b.app.cdn+"img/blank.png":b.app.cdn+b.imgPath+b.banner.photo},b.editBanner=function(){b.showError=!1,h.editBanner(b.banner).success(function(d){d.success?(f.setSuccess({show:!0,msg:b.banner.title+" has been updated successfully."}),c.go("app.admin.banners.list")):(b.errors=d.errors,b.showError=!0,a.scrollTo(0,0))})}}]).controller("DeckBuilderClassCtrl",["$scope","Hearthstone",function(a,b){function c(b){return a.heroes[b]["class"][0].toUpperCase()+a.heroes[b]["class"].slice(1)}function d(a){return e[a]==b.heroNames[c(a)].length-1?0:++e[a]}(void 0==a.app.settings.secondaryPortrait||0==a.app.settings.secondaryPortrait.length)&&(a.app.settings.secondaryPortrait=[0,0,0,0,0,0,0,0,0]);var e=a.app.settings.secondaryPortrait;a.heroNames=b.heroNames,a.klass=!1,a.heroes=[{"class":"druid",hasSecondary:b.heroNames.Druid.length>1,secondary:e[0]},{"class":"hunter",hasSecondary:b.heroNames.Hunter.length>1,secondary:e[1]},{"class":"mage",hasSecondary:b.heroNames.Mage.length>1,secondary:e[2]},{"class":"paladin",hasSecondary:b.heroNames.Paladin.length>1,secondary:e[3]},{"class":"priest",hasSecondary:b.heroNames.Priest.length>1,secondary:e[4]},{"class":"rogue",hasSecondary:b.heroNames.Rogue.length>1,secondary:e[5]},{"class":"shaman",hasSecondary:b.heroNames.Shaman.length>1,secondary:e[6]},{"class":"warlock",hasSecondary:b.heroNames.Warlock.length>1,secondary:e[7]},{"class":"warrior",hasSecondary:b.heroNames.Warrior.length>1,secondary:e[8]}],a.getName=function(d,f){try{if(f)return b.heroNames[c(d)][e[d]];var g=b.heroNames[c(d)][e[d]];return g[0].toLowerCase()+g.slice(1)}catch(h){a.app.settings.secondaryPortrait=[0,0,0,0,0,0,0,0,0],e=a.app.settings.secondaryPortrait,a.getName(d,f)}},a.updateHero=function(b){var c=d(b);e[b]=c,a.app.settings.secondaryPortrait[b]=c};for(var f=0;f<a.app.settings.secondaryPortrait.length;f++)(void 0==a.getName(f,!0)||""==a.getName(f,!0))&&(a.app.settings.secondaryPortrait[f]=0,e[f]=0)}]).controller("DeckBuilderCtrl",["$q","$state","$scope","$timeout","$compile","$window","LoginModalService","AjaxPagination","Hearthstone","DeckBuilder","ImgurService","UserService","AuthenticationService","SubscriptionService","data","toStep",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a,b,e,f,g,h){c.fetching=!0,j.loadCards(a,b,e,f,g,c.className.toLowerCase()).then(function(b){c.classPagination.total=c.isClassCards()?b.classTotal:b.neutralTotal,c.classPagination.page=a,c.neutralPagination.total=c.isClassCards()?b.classTotal:b.neutralTotal,c.neutralPagination.page=a,d(function(){return c.cards.current=c.isClassCards()?b.cards["class"]:b.cards.neutral,c.fetching=!1,h?h(b):void 0})})}if(!o||!o.success)return b.transitionTo("app.hs.deckBuilder.class"),!1;c.isSecondary=function(a){switch(a){case"druid":return c.app.settings.secondaryPortrait[0];case"hunter":return c.app.settings.secondaryPortrait[1];case"mage":return c.app.settings.secondaryPortrait[2];case"paladin":return c.app.settings.secondaryPortrait[3];case"priest":return c.app.settings.secondaryPortrait[4];case"rogue":return c.app.settings.secondaryPortrait[5];case"shaman":return c.app.settings.secondaryPortrait[6];case"warlock":return c.app.settings.secondaryPortrait[7];case"warrior":return c.app.settings.secondaryPortrait[8]}},c.step=1,c.showManaCurve=!1,c.classes=angular.copy(i.classes).splice(1,9),c.getDust=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].dust*a[c].qty;return b},c.getName=function(a,b){try{return i.heroNames[b][c.isSecondary(b.toLowerCase())]}catch(d){c.app.settings.secondaryPortrait=[0,0,0,0,0,0,0,0,0],c.getName(a,caps)}},c.getActiveDeckName=function(){return i.heroNames[c.deck.playerClass][c.isSecondary(c.deck.playerClass.toLowerCase())]},c.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},c.type=1,c.basic=!1,c.prevStep=function(){c.step>1&&(c.step=c.step-1)},c.nextStep=function(){c.step<5&&(c.step=c.step+1)},c.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]};var r=!0;c.isClassCards=function(){return r},c.className=o.className,c.cards=o.cards,c.cards.current=c.cards["class"],c.search=function(){q(1,15,c.filters.search,c.filters.mechanics,c.filters.mana)},c.classPagination=h["new"](15,o.classTotal,function(b,d){var e=a.defer();return q(b,d,c.filters.search,c.filters.mechanics,c.filters.mana,function(a){e.resolve(a.classTotal)}),e.promise}),c.neutralPagination=h["new"](15,o.neutralTotal,function(b,d){var e=a.defer();return q(b,d,c.filters.search,c.filters.mechanics,c.filters.mana,function(a){e.resolve(a.neutralTotal)}),e.promise}),c.filters={search:"",mechanics:[],mana:"all"},c.setClassCards=function(a){r=a,q(1,15,c.filters.search,c.filters.mechanics,c.filters.mana)},c.mechanics=i.mechanics,c.inMechanics=function(a){return c.filters.mechanics.indexOf(a)>=0},c.toggleMechanic=function(a){q(1,15,c.filters.search,c.filters.mechanics,c.filters.mana);var b=c.filters.mechanics.indexOf(a);-1===b?c.filters.mechanics.push(a):c.filters.mechanics.splice(b,1)},c.filters.byMechanics=function(){return function(a){if(!c.filters.mechanics.length)return!0;for(var b=0,d=0;d<a.mechanics.length;d++)c.inMechanics(a.mechanics[d])&&b++;return b===c.filters.mechanics.length}},c.doFilterByMana=function(a){c.filters.mana=a,q(1,15,c.filters.search,c.filters.mechanics,c.filters.mana)},c.filters.byMana=function(){return function(a){switch(c.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===c.filters.mana;case"7+":return a.cost>=7}}},c.getManaCost=function(){switch(c.filters.mana){case"all":return"All";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case"7+":return c.filters.mana}},c.deckTypes=i.deckTypes,c.deck=c.app.settings.deck&&null!==c.app.settings.deck&&o.className===c.app.settings.deck.playerClass?j["new"](o.className,c.app.settings.deck):j["new"](o.className),c.$watch("deck",function(){c.app.settings.deck={name:c.deck.name,deckType:c.deck.deckType,description:c.deck.description,chapters:c.deck.chapters,matches:c.deck.matches,cards:c.deck.cards,heroName:c.deck.heroName,playerClass:c.deck.playerClass,type:c.deck.type,basic:c.deck.basic,mulligans:c.deck.mulligans,video:c.deck.video,"public":c.deck["public"]}},!0),c.currentMulligan=c.deck.getMulligan(c.classes[0]),c.setMulligan=function(a){c.currentMulligan=a},c.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length},c.isMulliganCard=function(a,b){if(a){for(var d=0;d<c.currentMulligan.withCoin.cards.length;d++)if(c.currentMulligan.withCoin.cards[d]._id==b._id)return!0}else for(var d=0;d<c.currentMulligan.withoutCoin.cards.length;d++)if(c.currentMulligan.withoutCoin.cards[d]._id==b._id)return!0},c.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],c.isPremium=function(){for(var a=c.deck.premium.isPremium,b=0;b<c.premiumTypes.length;b++)if(c.premiumTypes[b].value===a)return c.premiumTypes[b].text},c.getMulliganCards=function(a){if(!c.currentMulligan)return!1;var b=c.currentMulligan;return a?b.withCoin.cards:b.withoutCoin.cards},c.cardLeft=function(a,b){return 80/c.getMulliganCards(b).length*a},c.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],c.isFeatured=function(){for(var a=c.deck.featured,b=0;b<c.featuredTypes.length;b++)if(c.featuredTypes[b].value===a)return c.featuredTypes[b].text};c.saveDeck=function(){return c.deck.validDeck()&&c.deck.validVideo()?void(c.app.user.isLogged()?(c.deck.heroName=c.getActiveDeckName(),j.saveDeck(c.deck).success(function(a){a.success?(c.app.settings.deck=null,b.transitionTo("app.hs.decks.deck",{slug:a.slug})):(c.errors=a.errors,c.showError=!0,f.scrollTo(0,0))})):g.showModal("login")):!1}}]).controller("DeckEditCtrl",["$state","$scope","$compile","$window","$timeout","$q","LoginModalService","AjaxPagination","Hearthstone","DeckBuilder","ImgurService","UserService","AuthenticationService","data",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,c,d,f,g,h){j.loadCards(a,c,d,f,g,b.className.toLowerCase()).then(function(c){b.classPagination.total=b.isClassCards()?c.classTotal:c.neutralTotal,b.classPagination.page=a,b.neutralPagination.total=b.isClassCards()?c.classTotal:c.neutralTotal,b.neutralPagination.page=a,e(function(){return b.cards.current=b.isClassCards()?c.cards["class"]:c.cards.neutral,h?h(c):void 0})})}if(!n||!n.success)return a.transitionTo("app.hs.deckBuilder.class"),!1;b.isSecondary=function(a){switch(a){case"druid":return b.app.settings.secondaryPortrait[0];case"hunter":return b.app.settings.secondaryPortrait[1];case"mage":return b.app.settings.secondaryPortrait[2];case"paladin":return b.app.settings.secondaryPortrait[3];case"priest":return b.app.settings.secondaryPortrait[4];case"rogue":return b.app.settings.secondaryPortrait[5];case"shaman":return b.app.settings.secondaryPortrait[6];case"warlock":return b.app.settings.secondaryPortrait[7];case"warrior":return b.app.settings.secondaryPortrait[8]}},b.step=1,b.showManaCurve=!1,b.classes=angular.copy(i.classes).splice(1,9),b.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},b.prevStep=function(){b.step>1&&(b.step=b.step-1)},b.nextStep=function(){b.step<5&&(b.step=b.step+1)},b.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]};var p=!0;b.isClassCards=function(){return p},b.setClassCards=function(a){o(1,15,b.filters.search,b.filters.mechanics,b.filters.mana),e(function(){p=a})},b.className=n.deck.playerClass,b.cards={},b.search=function(){o(1,15,b.filters.search,b.filters.mechanics,b.filters.mana)},b.classPagination=h["new"](15,n.classTotal,function(a,c){var d=f.defer();return o(a,c,b.filters.search,b.filters.mechanics,b.filters.mana,function(a){d.resolve(a.classTotal)}),d.promise}),b.neutralPagination=h["new"](15,n.neutralTotal,function(a,c){var d=f.defer();return o(a,c,b.filters.search,b.filters.mechanics,b.filters.mana,function(a){d.resolve(a.neutralTotal)}),d.promise}),b.filters={search:"",mechanics:[],mana:"all"},b.mechanics=i.mechanics,b.inMechanics=function(a){return b.filters.mechanics.indexOf(a)>=0},b.toggleMechanic=function(a){o(1,15,b.filters.search,b.filters.mechanics,b.filters.mana);var c=b.filters.mechanics.indexOf(a);-1===c?b.filters.mechanics.push(a):b.filters.mechanics.splice(c,1)},b.filters.byMechanics=function(){return function(a){if(!b.filters.mechanics.length)return!0;for(var c=0,d=0;d<a.mechanics.length;d++)b.inMechanics(a.mechanics[d])&&c++;return c===b.filters.mechanics.length}},b.doFilterByMana=function(a){b.filters.mana=a,o(1,15,b.filters.search,b.filters.mechanics,b.filters.mana)},b.filters.byMana=function(){return function(a){switch(b.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===b.filters.mana;case"7+":return a.cost>=7}}},b.getManaCost=function(){switch(b.filters.mana){case"all":return"All";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case"7+":return b.filters.mana}},b.deckTypes=i.deckTypes,b.deck=j["new"](n.deck.className,n.deck),b.currentMulligan=b.deck.getMulligan(b.classes[2]),b.setMulligan=function(a){b.currentMulligan=a},b.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length};var q={title:"",content:""};b.newChapter=function(){var a=angular.copy(q);b.deck.chapters.push(a)},b.removeChapter=function(a){b.deck.chapters.splice(a,1)};var r={deckName:"",klass:"",match:0};b.newMatch=function(a){var c=angular.copy(r);c.klass=a,b.deck.matches.push(c)},b.removeMatch=function(a){b.deck.matches.splice(a,1)},b.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isPremium=function(){for(var a=b.deck.premium.isPremium,c=0;c<b.premiumTypes.length;c++)if(b.premiumTypes[c].value===a)return b.premiumTypes[c].text},b.getMulliganCards=function(a){if(!b.currentMulligan)return!1;var c=b.currentMulligan;return a?c.withCoin.cards:c.withoutCoin.cards},b.cardLeft=function(a,c){return 80/b.getMulliganCards(c).length*a},b.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isFeatured=function(){for(var a=b.deck.featured,c=0;c<b.featuredTypes.length;c++)if(b.featuredTypes[c].value===a)return b.featuredTypes[c].text},o(1,15,b.filters.search,b.filters.mechanics,b.filters.mana),b.updateDeck=function(){return b.deck.validDeck()&&b.deck.validVideo()?void j.updateDeck(b.deck).success(function(c){c.success?a.transitionTo("app.hs.decks.deck",{slug:c.slug}):(b.errors=c.errors,b.showError=!0,d.scrollTo(0,0))}):!1}}]).controller("SnapshotCtrl",["$scope","$state","$compile","$window","SnapshotService","data","VoteService","LoginModalService",function(a,b,c,d,e,f,g,h){function i(b){for(var c=a.getTier(b),d=[],e=0,f=0,g=0;g<c.decks.length;g++)for(var h=c.decks[g].rank.all,i=0;i<h.length;i++)h[i]>e&&0!=h[i]&&(e=h[i]),(h[i]<f&&0!=h[i]||0==f)&&(f=h[i]);for(var g=f;e>=g;g++)d.push(g);return d}function j(b){for(var c=0;c<a.snapshot.tiers.length;c++)for(var d=0;d<a.snapshot.tiers[c].decks.length;d++)if(a.snapshot.tiers[c].decks[d].deck._id==b)return a.snapshot.tiers[c].decks[d].name.length?a.snapshot.tiers[c].decks[d].name:a.snapshot.tiers[c].decks[d].deck.name;return!1}function k(){for(var b=a.snapshot.tiers.length,c=b>2?2:b,d=0;c>d;d++)for(var e=0;e<a.snapshot.tiers[d].decks.length;e++){for(var f=[],g=0;g<a.snapshot.matches.length;g++)if(a.snapshot.tiers[d].decks[e].deck._id==a.snapshot.matches[g]["for"]._id||a.snapshot.tiers[d].decks[e].deck._id==a.snapshot.matches[g].against._id){var h={against:a.snapshot.tiers[d].decks[e].deck._id==a.snapshot.matches[g].against._id?a.snapshot.matches[g]["for"]._id:a.snapshot.matches[g].against._id,chance:a.snapshot.tiers[d].decks[e].deck._id==a.snapshot.matches[g].against._id?a.snapshot.matches[g].forChance:a.snapshot.matches[g].againstChance,playerClass:a.snapshot.tiers[d].decks[e].deck._id==a.snapshot.matches[g].against._id?a.snapshot.matches[g]["for"].playerClass:a.snapshot.matches[g].against.playerClass,name:j(a.snapshot.tiers[d].decks[e].deck._id==a.snapshot.matches[g].against._id?a.snapshot.matches[g]["for"]._id:a.snapshot.matches[g].against._id)};f.push(h)}n[a.snapshot.tiers[d].decks[e].deck._id]=f}}function l(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.snapshot.comments.forEach(b)}a.snapshot=f,a.show=[],a.matchupName=[],a.voted=!1,a.hasVoted=function(){for(var b=0;b<a.snapshot.votes.length;b++)if(a.snapshot.votes[b]==a.app.user.getUserID()){a.voted=!0;break}},a.show.comments=e.getStorage(),a.$watch("app.user.isLogged()",function(){l(),a.hasVoted()}),a.SnapshotService=e;var m=[],n=[],o=0;a.getImage=function(){return""==a.snapshot.photos.large?a.app.cdn+"snapshots/default-banner.jpg":a.app.cdn+"snapshots/"+a.snapshot.photos.large},a.getMouseOver=function(a){return m[a]||!1},a.setMouseOver=function(b,c,d){m[b]=c,a.matchupName[b]=d||!1},a.metaservice.set(a.snapshot.title+" - The Meta Snapshot",a.snapshot.content.intro);var p=""==a.snapshot.photos.square?a.app.cdn+"snapshots/default-banner-square.jpg":a.app.cdn+"snapshots/"+a.snapshot.photos.square;a.metaservice.setOg("https://tempostorm.com/hearthstone/meta-snapshot/"+a.snapshot.slug.url,a.snapshot.title,a.snapshot.content.intro,"article",p);for(var q=0;q<a.snapshot.tiers.length;q++)a.show[q+1]=!1;a.setView=function(a){o=350*a},a.getView=function(){return o},a.currentTier=1,a.currentDeck=!1,a.tierRange=[],a.snapshotTimeline=function(){for(var b=[],c=a.snapshot.snapNum;c>a.snapshot.snapNum-13;c--)b.push(c);return b},a.getTier=function(b){for(var c=0;c<a.snapshot.tiers.length;c++)if(a.snapshot.tiers[c].tier==b)return a.snapshot.tiers[c];return!1};for(var q=0;q<a.snapshot.tiers.length;q++){var r=a.snapshot.tiers[q].tier;a.tierRange[r]=i(r)}a.toggleCurrentDeck=function(b){a.currentDeck=a.currentDeck==b?!1:b},a.hasDeckSelected=function(){return a.currentDeck},a.setCurrentTier=function(b){a.currentTier=b,a.toggleCurrentDeck(!1)},a.getPositionY=function(b,c,d,e){var f=a.tierRange[b].length;return Math.round((d-e)/f*c+e,2)},a.getPositionX=function(a,b){return Math.round(100-b-(100-b)/12*a+b/2,2)},a.getRanks=function(a){var b=a.rank.all;return b},a.getRankIndex=function(b,c){var d=a.tierRange[b];return d.indexOf(c)},a.getNextRank=function(a,b){return a.rank.all[b+1]},a.hasNextRank=function(a,b){return a.rank.all[b+1]},a.voteSnapshot=function(){a.app.user.isLogged()?(a.snapshot.votesCount++,e.vote(a.snapshot._id)):h.showModal("login",function(){a.hasVoted()||(a.snapshot.votesCount++,e.vote(a.snapshot._id))}),a.voted=!0};var s={comment:""};a.comment=angular.copy(s),a.commentPost=function(){a.app.user.isLogged()?e.addComment(a.snapshot,a.comment).success(function(b){b.success&&(a.snapshot.comments.push(b.comment),a.comment.comment="")}):h.showModal("login",function(){a.commentPost()})},l(),a.voteComment=function(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return bootbox.alert("You can't vote for your own content."),!1;g.voteComment(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else h.showModal("login",function(){a.voteComment(b,snapshot)})},a.scrollToDeck=function(a){$("html, body").animate({scrollTop:a.offset().top-100},400)},a.findDeck=function(b,c){var d=$("#collapseTier"+b),e=$("#collapseDeck-"+c);d.collapse("show"),e.collapse("show"),a.scrollToDeck(e)},a.goToTwitch=function(a,b){a.stopPropagation();var c="http://twitch.tv/"+b;window.open(c,"_blank")},a.goToTwitter=function(a,b){a.stopPropagation();var c="http://twitter.com/"+b;window.open(c,"_blank")},a.getMatches=function(a){return n[a]},a.getMatchClass=function(a,b){return a["for"]._id==b?a.against.playerClass:a["for"].playerClass},a.goToDeck=function(a,c){a.stopPropagation();var d=b.href("app.hs.decks.deck",{slug:c});window.open(d,"_blank")},a.goToTwitch=function(a,b){a.stopPropagation();var c="http://twitch.tv/"+b;window.open(c,"_blank")},a.goToTwitter=function(a,b){a.stopPropagation();var c="http://twitter.com/"+b;window.open(c,"_blank")},a.toggleComments=function(){e.setStorage(e.getStorage()?!1:!0),a.show.comments=e.getStorage()},k()}]).controller("SnapshotsCtrl",["$scope","SnapshotService","data","MetaService",function(a,b,c,d){a.snapshots=c.snapshots,a.total=c.total,a.page=parseInt(c.page),a.perpage=c.perpage,a.search=c.search,a.metaservice=d,a.metaservice.setOg("https://tempostorm.com/hearthstone/snapshots"),a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getArticles()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):1}}}]).controller("ArticlesCtrl",["$scope","$state","$q","$timeout","ArticleService","data","MetaService","AjaxPagination",function(a,b,c,d,e,f,g,h){function i(b,c,f,g){a.fetching=!0,e.getArticles("all","all",b*c-c,12,f).then(function(e){a.articlePagination.total=e.total,a.articlePagination.page=b,a.articlePagination.perpage=c,d(function(){return a.articles=e.articles,a.fetching=!1,g?g(e):void 0})})}a.articles=f.articles,a.total=f.total,a.articleType=f.articleType,a.filter=f.filter,a.page=parseInt(f.page),a.perpage=f.perpage,a.search=f.search,a.fetching=!1,a.metaservice=g,a.metaservice.setOg("https://tempostorm.com/articles"),a.hasSearch=function(){return f.search?f.search.length:!1},a.setKlass=function(b){a.filter=b,a.page=1,a.getArticles()},a.getArticles=function(){var c={};a.search&&(c.s=a.search),1!==a.page&&(c.p=a.page),"all"!=a.articleType&&(c.t=a.articleType),"all"!=a.filter&&(c.f=a.filter),a.loading=!0,b.transitionTo("app.articles.list",c)},a.articlePagination=h["new"](12,f.total,function(b,d){var e=c.defer();return i(b,d,a.search,function(a){e.resolve(a.total)}),e.promise})}]).controller("ArticleCtrl",["$scope","$parse","$sce","data","$state","$compile","$window","bootbox","ArticleService","VoteService","MetaService","LoginModalService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){for(var b=0;b<a.article.votes.length;b++)if("object"==typeof a.article.votes[b]){if(a.article.votes[b].userID==a.app.user.getUserID()){a.hasVoted=!0;break}}else if(a.article.votes[b]==a.app.user.getUserID()){a.hasVoted=!0;break}return a.hasVoted}function n(b){a.app.user.isLogged()?a.hasVoted||j.voteArticle(b).then(function(c){c.success&&(a.hasVoted=!0,b.votesCount=c.votesCount)}):l.showModal("login",function(){n(b)}),m(),o()}function o(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.article.comments.forEach(b)}a.article=d.article,a.authorEmail=d.article.author.email,a.ArticleService=i,a.$watch("app.user.isLogged()",function(){for(var b=0;b<a.article.votes.length;b++)a.article.votes[b]==a.app.user.getUserID()&&(m(),o())}),a.isPremium=function(){if(!a.article.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.article.premium.expiryDate).getTime();return c>b?!0:!1},a.metaservice=k,a.metaservice.set(a.article.title+" - Articles",a.article.description);var p=void 0!=a.article.photos.square?a.app.cdn+"articles/"+a.article.photos.square:a.app.cdn+"articles/"+a.article.photos.large;a.metaservice.setOg("https://tempostorm.com/articles/"+d.article.slug.url,a.article.title,a.article.description,"article",p),a.getContent=function(){return c.trustAsHtml(a.article.content)},a.app.settings.show.article||(a.app.settings.show.article={related:!0,comments:!0}),a.show=a.app.settings.show.article,a.$watch("show",function(){a.app.settings.show.article=a.show},!0),a.relatedActive=function(){var b=a.article.related;if(!b||!b.length)return!1;for(var c=0;c<b.length;c++)if(b[c].active)return!0;return!1},a.getType=function(a){if(a.articleType[1])return"tempostorm";switch(a.articleType[0]){case"hs":return"hearthstone";case"ts":return"tempostorm";case"hots":return"heroes"}};a.voteArticle=function(a){n(a)};var q={comment:""};a.comment=angular.copy(q),a.commentPost=function(){a.app.user.isLogged()?i.addComment(a.article,a.comment).success(function(b){b.success&&(a.article.comments.push(b.comment),a.comment.comment="")}):l.showModal("login",function(){a.commentPost()})},a.app.user.isLogged()&&o(),a.voteComment=function(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return h.alert("You can't vote for your own content."),!1;j.voteComment(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else l.showModal("login",function(){a.voteComment(b,c)});m(),o()},a.getPremium=function(b){a.app.user.isLogged()?a.app.user.isSubscribed()||e.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:b}):l.showModal("login",function(){a.app.user.isSubscribed()||a.app.user.isAdmin()||a.app.user.isProvider()||a.getPremium(b)})}}]).controller("DecksCtrl",["$scope","$state","$timeout","$q","AjaxPagination","Hearthstone","Util","DeckService","dataDecksTempostorm","dataDecksCommunity",function(a,b,c,d,e,f,g,h,i,j){function k(b,d,e){h.getDecksFeatured(a.filters.classes,b,d,a.filters.search).then(function(d){a.tempostormPagination.total=d.total,a.tempostormPagination.page=b,c(function(){return a.tempostormDecks=d.decks,e?e(d):void 0})})}function l(b,d,e){h.getDecksCommunity(a.filters.classes,b,d,a.filters.search).then(function(d){a.communityPagination.total=d.total,a.communityPagination.page=b,c(function(){return a.communityDecks=d.decks,e?e(d):void 0})})}a.metaservice.setOg("https://tempostorm.com/hearthstone/decks"),a.deckSearch="",a.tempostormDecks=i.decks,a.communityDecks=j.decks,a.filters={classes:[],search:""},a.classes=angular.copy(f.classes).splice(1,9);var m=!0;a.$watch(function(){return a.filters},function(a){m?c(function(){m=!1}):(k(1,4),l(1,12))},!0),a.dustFormatted=function(a){return g.numberWithCommas(a)},a.newSearch=function(){a.filters.search=a.deckSearch},a.tempostormPagination=e["new"](4,i.total,function(a,b){var c=d.defer();return k(a,b,function(a){c.resolve(a.total)}),c.promise}),a.communityPagination=e["new"](12,j.total,function(a,b){var c=d.defer();return l(a,b,function(a){c.resolve(a.total)}),c.promise}),a.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1}}]).controller("DeckCtrl",["$scope","$state","$sce","$compile","$window","bootbox","Hearthstone","DeckService","VoteService","data","MetaService","LoginModalService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}b(a.deck)}function n(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;i.voteDeck(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else l.showModal("login",function(){n(b,c)});updateCommentVotes(),m()}if(!j||!j.success)return b.go("app.hs.decks.list");a.deck=j.deck,a.DeckService=h,a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){if(!a.deck.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.deck.premium.expiryDate).getTime();return c>b?!0:!1},a.metaservice=k,a.metaservice.set(a.deck.name+" - Decks",a.deck.description);var o=a.app.cdn+"img/decks/"+a.deck.playerClass+".png";a.metaservice.setOg("https://tempostorm.com/hearthstone/decks/"+a.deck.slug,a.deck.name,a.deck.description,"article",o.toLowerCase()),a.classes=angular.copy(g.classes).splice(1,9),a.app.settings.show.deck||(a.app.settings.show.deck={mana:!0,description:!0,mulligans:!0,video:!0,matchups:!0,gameplay:!0,stats:!0,comments:!0}),a.show=a.app.settings.show.deck,a.$watch("show",function(){a.app.settings.show.deck=a.show},!0),a.coin=!0,a.toggleCoin=function(){a.coin=!a.coin},a.getFirstMulligan=function(){for(var b=a.deck.mulligans,c=0;c<b.length;c++)if(a.isMulliganSet(b[c])===!0)return b[c];return!1},a.getMulligan=function(b){for(var c=a.deck.mulligans,d=0;d<c.length;d++)if(c[d].klass===b)return c[d];return!1},a.setMulligan=function(b){a.currentMulligan=b},a.isMulliganSet=function(a){return a.withCoin.cards.length>0||a.withCoin.instructions.length>0||a.withoutCoin.cards.length>0||a.withoutCoin.instructions.length>0},a.anyMulliganSet=function(){for(var b=a.deck.mulligans,c=0;c<b.length;c++)if(a.isMulliganSet(b[c])===!0)return!0;return!1},a.mulliganHide=function(b){if(!a.anyMulliganSet())return!1;if(!a.currentMulligan)return!1;for(var c=a.coin?a.currentMulligan.withCoin.cards:a.currentMulligan.withoutCoin.cards,d=0;d<c.length;d++)if(c[d]._id===b.card._id)return!1;
return!0},a.getMulliganInstructions=function(){if(!a.currentMulligan)return!1;var b=a.currentMulligan;return a.coin?b.withCoin.instructions:b.withoutCoin.instructions},a.getMulliganCards=function(){if(!a.currentMulligan)return!1;var b=a.currentMulligan;return a.coin?b.withCoin.cards:b.withoutCoin.cards},a.cardLeft=function(b){return 80/a.getMulliganCards().length*b},a.cardRight=function(){return 80*a.getMulliganCards().length/2},a.charts={colors:["rgba(151,187,205,1)","rgba(151,187,205,1)","rgba(151,187,205,1)","rgba(151,187,205,1)"]},a.labels=["Download Sales","In-Store Sales","Mail-Order Sales"],a.data=[300,500,100],a.getVideo=function(){return a.getContent('<iframe src="//www.youtube.com/embed/'+a.deck.video+'" frameborder="0" height="360" width="100%" allowfullscreen></iframe>')},a.getContent=function(a){return c.trustAsHtml(a)},a.mouseOver="",a.setMouseOver=function(b){0!=b?a.mouseOver=b:a.mouseOver=!1},a.getMouseOver=function(b){return a.mouseOver},a.deck.getDust=function(){for(var b=0,c=0;c<a.deck.cards.length;c++)b+=a.deck.cards[c].qty*a.deck.cards[c].card.dust;return b},a.deck.manaCurve=function(b){for(var c,d=0,e=0;7>=e;e++)c=a.deck.manaCount(e),c>d&&(d=c);return 0===d?0:Math.ceil(a.deck.manaCount(b)/d*98)},a.deck.manaCount=function(b){for(var c=0,d=0;d<a.deck.cards.length;d++)(a.deck.cards[d].card.cost===b||7===b&&a.deck.cards[d].card.cost>=7)&&(c+=a.deck.cards[d].qty);return c},a.voteDown=function(a){n(-1,a)},a.voteUp=function(a){n(1,a)};m(),a.getPremium=function(c){a.app.user.isLogged()?a.app.user.isSubscribed()||b.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:c}):l.showModal("login",function(){a.app.user.isSubscribed()||a.app.user.isAdmin()||a.app.user.isProvider()||a.getPremium(c)})}}]).controller("ForumCategoryCtrl",["$scope","data","MetaService",function(a,b,c){a.categories=b.categories,a.metaservice.setOg("https://tempostorm.com/forum")}]).controller("ForumThreadCtrl",["$scope","Pagination","data","MetaService",function(a,b,c,d){a.thread=c.thread,a.metaservice=d,a.metaservice.set(a.thread.title+" - Forum"),a.metaservice.setOg("https://tempostorm.com/forum/"+a.thread.slug.url,a.thread.title),a.pagination=b["new"](20),a.pagination.results=function(){return a.thread.posts.length}}]).controller("ForumAddCtrl",["$scope","$location","$window","$compile","bootbox","ForumService","UserService","AuthenticationService","SubscriptionService","data",function(a,b,c,d,e,f,g,h,i,j){a.thread=j.thread;var k={title:"",content:""};a.post=angular.copy(k),a.options={disableDragAndDrop:!0,height:300,toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]};var l,m;a.addPost=function(){a.app.user.isLogged()?f.addPost(a.thread,a.post).success(function(d){d.success?b.path("/forum/"+a.thread.slug.url):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):(l=e.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),l.modal("show"),m=function(){a.addPost()})},a.login=function(b,d){void 0!==b&&void 0!==d&&g.login(b,d).success(function(b){h.setLogged(!0),h.setAdmin(b.isAdmin),h.setProvider(b.isProvider),i.setSubscribed(b.subscription.isSubscribed),i.setTsPlan(b.subscription.plan),i.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,l.modal("hide"),m()}).error(function(){a.showError=!0})}}]).controller("ForumPostCtrl",["$scope","$sce","$compile","$window","bootbox","ForumService","UserService","AuthenticationService","VoteService","SubscriptionService","data","MetaService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.post.comments.forEach(b)}a.post=k.post,a.ForumService=f,a.thread=k.thread,a.metaservice=l,a.metaservice.set(a.post.title+" - "+a.thread.title),a.metaservice.setOg("https://tempostorm.com/forum/"+a.thread.slug.url+"/"+a.post.slug.url,a.post.title,a.post.content);var n={comment:""};a.comment=angular.copy(n),a.post.getContent=function(){return b.trustAsHtml(a.post.content)};var o,p;a.commentPost=function(){a.app.user.isLogged()?f.addComment(a.post,a.comment).success(function(b){b.success&&(a.post.comments.push(b.comment),a.comment.comment="",m())}):(o=e.dialog({title:"Login Required",message:c("<div login-form></div>")(a)}),o.modal("show"),p=function(){a.commentPost()})},a.app.user.isLogged()&&m(),a.voteComment=function(b,d){if(a.app.user.isLogged()){if(d.author._id===a.app.user.getUserID())return e.alert("You can't vote for your own content."),!1;i.voteComment(b,d).then(function(a){a.success&&(d.voted=b,d.votesCount=a.votesCount)})}else o=e.dialog({title:"Login Required",message:c("<div login-form></div>")(a)}),o.modal("show"),p=function(){a.voteComment(b,d)}},a.login=function(b,c){void 0!==b&&void 0!==c&&g.login(b,c).success(function(b){h.setLogged(!0),h.setAdmin(b.isAdmin),h.setProvider(b.isProvider),j.setSubscribed(b.subscription.isSubscribed),j.setTsPlan(b.subscription.plan),j.setExpiry(b.subscription.expiry),d.sessionStorage.userID=b.userID,d.sessionStorage.username=b.username,d.sessionStorage.email=b.email,a.app.settings.token=d.sessionStorage.token=b.token,o.modal("hide"),p()}).error(function(){a.showError=!0})}}]).controller("AdminForumStructureListCtrl",["$scope","bootbox","AlertService","AdminForumService","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.categories=e.categories,a.deleteCategory=function(c){var e=b.dialog({title:"Delete category: "+c.title+"?",message:"Are you sure you want to delete the category <strong>"+c.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){d.deleteCategory(c._id).then(function(b){if(b.success){var d=a.categories.indexOf(c);-1!==d&&a.categories.splice(d,1),a.success={show:!0,msg:c.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")},a.deleteThread=function(c){var e=b.dialog({title:"Delete thread: "+c.title+"?",message:"Are you sure you want to delete the thread <strong>"+c.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){d.deleteThread(c._id,c.category).then(function(b){if(b.success){var d=a.threads.indexOf(c);-1!==d&&a.threads.splice(d,1),a.success={show:!0,msg:c.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("AdminForumCategoryAddCtrl",["$scope","$state","$window","AdminForumService","AlertService",function(a,b,c,d,e){var f={title:"",active:!0};a.category=angular.copy(f),a.categoryActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.addCategory=function(){a.showError=!1,d.addCategory(a.category).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.category.title+" has been added successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminForumCategoryEditCtrl",["$scope","$state","$window","AdminForumService","AlertService","data",function(a,b,c,d,e,f){a.category=f.category,a.categoryActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.editCategory=function(){a.showError=!1,d.editCategory(a.category).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.category.title+" has been updated successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminForumThreadAddCtrl",["$scope","$state","$window","Util","AdminForumService","AlertService","data",function(a,b,c,d,e,f,g){var h={category:g.categories[0]._id||"",title:"",description:"",slug:{url:"",linked:!0},active:!0};a.thread=angular.copy(h),a.setSlug=function(){return a.thread.slug.linked?void(a.thread.slug.url=d.slugify(a.thread.title)):!1},a.toggleSlugLink=function(){a.thread.slug.linked=!a.thread.slug.linked,a.setSlug()},a.selectCategories=g.categories,a.threadActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.addThread=function(){a.showError=!1,e.addThread(a.thread).success(function(d){d.success?(f.setSuccess({show:!0,msg:a.thread.title+" has been added successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminForumThreadEditCtrl",["$scope","$state","$window","Util","AdminForumService","AlertService","dataCategories","dataThread",function(a,b,c,d,e,f,g,h){a.thread=h.thread,a.setSlug=function(){return a.thread.slug.linked?void(a.thread.slug.url=d.slugify(a.thread.title)):!1},a.toggleSlugLink=function(){a.thread.slug.linked=!a.thread.slug.linked,a.setSlug()},a.selectCategories=g.categories,a.threadActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.editThread=function(){a.showError=!1,e.editThread(a.thread).success(function(d){d.success?(f.setSuccess({show:!0,msg:a.thread.title+" has been updated successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("Twitch",["$scope",function(a){a.login=function(){window.location.replace("/auth/twitch")},a.signup=function(){window.location.replace("/auth/twitch")}}]).controller("Bnet",["$scope",function(a){a.login=function(){window.location.replace("/auth/bnet")}}]).controller("AdminHeroListCtrl",["$scope","AdminHeroService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.heroes=e.heroes,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getHeroes=function(){b.getHeroes(a.page,a.perpage,a.search).then(function(b){a.heroes=b.heroes,a.page=b.page,a.total=b.total})},a.searchHeroes=function(){a.page=1,a.getHeroes()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getHeroes()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteHero=function(c){var d=bootbox.dialog({title:"Delete hero: "+c.name+"?",message:"Are you sure you want to delete the hero <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteHero(c._id).then(function(b){if(b.success){var d=a.heroes.indexOf(c);-1!==d&&a.heroes.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminHeroAddCtrl",["$scope","$state","$window","$compile","bootbox","Util","HOTS","AlertService","AdminHeroService",function(a,b,c,d,e,f,g,h,i){var j={name:"",description:"",title:"",role:g.roles[0],heroType:g.types[0],universe:g.universes[0],manaType:g.manaTypes[0],abilities:[],talents:[],characters:[],price:{gold:""},className:"",active:!0},k={name:"",abilityType:g.abilityTypes[0],mana:"",cooldown:"",description:"",damage:"",healing:"",className:"",orderNum:1},l={name:"",tier:g.tiers[0],description:"",ability:null,className:"",orderNum:1},m={name:"",stats:{base:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0},gain:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0}}};a.hero=angular.copy(j),a.roles=g.roles,a.heroTypes=g.types,a.universes=g.universes,a.manaTypes=g.manaTypes,a.heroActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.abilityTypes=g.abilityTypes;var n;a.abilityAddWnd=function(){a.currentAbility=angular.copy(k),f.getObjectID().success(function(b){b.success&&(a.currentAbility._id=b.id,n=e.dialog({title:"Add Ability",message:d("<div ability-add-form></div>")(a)}))})},a.abilityEditWnd=function(b){a.currentAbility=b,n=e.dialog({title:"Edit Ability",message:d("<div ability-edit-form></div>")(a)})},a.addAbility=function(){a.currentAbility.orderNum=a.hero.abilities.length+1,a.hero.abilities.push(a.currentAbility),n.modal("hide"),a.currentAbility=!1},a.editAbility=function(b){n.modal("hide"),a.currentAbility=!1},a.deleteAbility=function(b){var c=a.hero.abilities.indexOf(b);a.hero.abilities.splice(c,1);for(var d=0;d<a.hero.abilities.length;d++)a.hero.abilities[d].orderNum=d+1},a.talentTiers=g.tiers,a.talentAddWnd=function(){a.currentTalent=angular.copy(l),a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Add Talent",message:d("<div talent-add-form></div>")(a)})},a.talentEditWnd=function(b){a.currentTalent=b,a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Edit Talent",message:d("<div talent-edit-form></div>")(a)})},a.addTalent=function(){a.currentTalent.orderNum=a.hero.talents.length+1,a.hero.talents.push(a.currentTalent),n.modal("hide"),a.currentTalent=!1},a.editTalent=function(b){n.modal("hide"),a.currentAbility=!1},a.deleteTalent=function(b){var c=a.hero.talents.indexOf(b);a.hero.talents.splice(c,1);for(var d=0;d<a.hero.talents.length;d++)a.hero.talents[d].orderNum=d+1},a.charAddWnd=function(){a.currentCharacter=angular.copy(m),n=e.dialog({title:"Add Character",message:d("<div char-add-form></div>")(a)})},a.charEditWnd=function(b){a.currentCharacter=b,n=e.dialog({title:"Edit Character",message:d("<div char-edit-form></div>")(a)})},a.addCharacter=function(){a.hero.characters.push(a.currentCharacter),n.modal("hide"),a.currentCharacter=!1},a.editCharacter=function(b){n.modal("hide"),a.currentCharacter=!1},a.deleteChar=function(b){var c=a.hero.characters.indexOf(b);a.hero.characters.splice(c,1)},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.addHero=function(){a.showError=!1,i.addHero(a.hero).success(function(d){d.success?(h.setSuccess({show:!0,msg:a.hero.name+" has been added successfully."}),b.go("app.admin.hots.heroes.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminHeroEditCtrl",["$scope","$state","$window","$compile","bootbox","Util","HOTS","AlertService","AdminHeroService","data",function(a,b,c,d,e,f,g,h,i,j){var k={name:"",abilityType:g.abilityTypes[0],mana:"",cooldown:"",description:"",damage:"",healing:"",className:"",orderNum:1},l={name:"",tier:g.tiers[0],description:"",ability:null,className:"",orderNum:1},m={name:"",stats:{base:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0},gain:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0}}};a.hero=j.hero,a.roles=g.roles,a.heroTypes=g.types,a.universes=g.universes,a.manaTypes=g.manaTypes,a.heroActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.abilityTypes=g.abilityTypes;var n;a.abilityAddWnd=function(){a.currentAbility=angular.copy(k),f.getObjectID().success(function(b){b.success&&(a.currentAbility._id=b.id,n=e.dialog({title:"Add Ability",message:d("<div ability-add-form></div>")(a)}))})},a.abilityEditWnd=function(b){a.currentAbility=b,n=e.dialog({title:"Edit Ability",message:d("<div ability-edit-form></div>")(a)})},a.addAbility=function(){a.currentAbility.orderNum=a.hero.abilities.length+1,a.hero.abilities.push(a.currentAbility),n.modal("hide"),a.currentAbility=!1},a.editAbility=function(b){n.modal("hide"),a.currentAbility=!1},a.deleteAbility=function(b){var c=a.hero.abilities.indexOf(b);a.hero.abilities.splice(c,1);for(var d=0;d<a.hero.abilities.length;d++)a.hero.abilities[d].orderNum=d+1},a.talentTiers=g.tiers,a.talentAddWnd=function(){a.currentTalent=angular.copy(l),a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Add Talent",message:d("<div talent-add-form></div>")(a)})},a.talentEditWnd=function(b){a.currentTalent=b,a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Edit Talent",message:d("<div talent-edit-form></div>")(a)})},a.addTalent=function(){a.currentTalent.orderNum=a.hero.talents.length+1,a.hero.talents.push(a.currentTalent),n.modal("hide"),a.currentTalent=!1},a.editTalent=function(b){n.modal("hide"),a.currentTalent=!1},a.deleteTalent=function(b){var c=a.hero.talents.indexOf(b);a.hero.talents.splice(c,1);for(var d=0;d<a.hero.talents.length;d++)a.hero.talents[d].orderNum=d+1},a.charAddWnd=function(){a.currentCharacter=angular.copy(m),n=e.dialog({title:"Add Character",message:d("<div char-add-form></div>")(a)})},a.charEditWnd=function(b){a.currentCharacter=b,n=e.dialog({title:"Edit Character",message:d("<div char-edit-form></div>")(a)})},a.addCharacter=function(){a.hero.characters.push(a.currentCharacter),n.modal("hide"),a.currentCharacter=!1},a.editCharacter=function(b){n.modal("hide"),a.currentCharacter=!1},a.deleteChar=function(b){var c=a.hero.characters.indexOf(b);a.hero.characters.splice(c,1)},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.editHero=function(){a.showError=!1,i.editHero(a.hero).success(function(d){d.success?(h.setSuccess({show:!0,msg:a.hero.name+" has been updated successfully."}),b.go("app.admin.hots.heroes.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminMapsListCtrl",["$scope","AdminMapService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.maps=e.maps,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getMaps=function(){b.getMaps(a.page,a.perpage,a.search).then(function(b){a.maps=b.maps,a.page=b.page,a.total=b.total})},a.searchMaps=function(){a.page=1,a.getMaps()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getMaps()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteMap=function(c){var d=bootbox.dialog({title:"Delete map: "+c.name+"?",message:"Are you sure you want to delete the map <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteMap(c._id).then(function(b){if(b.success){var d=a.maps.indexOf(c);-1!==d&&a.maps.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminMapAddCtrl",["$scope","$state","$window","$compile","bootbox","HOTS","AlertService","AdminMapService",function(a,b,c,d,e,f,g,h){var i={name:"",description:"",className:"",active:!0};a.map=angular.copy(i),a.mapActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.addMap=function(){a.showError=!1,h.addMap(a.map).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.map.name+" has been added successfully."}),b.go("app.admin.hots.maps.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminMapEditCtrl",["$scope","$state","$window","$compile","bootbox","HOTS","AlertService","AdminMapService","data",function(a,b,c,d,e,f,g,h,i){a.map=i.map,a.mapActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.editMap=function(){a.showError=!1,h.editMap(a.map).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.map.name+" has been updated successfully."}),b.go("app.admin.hots.maps.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminHOTSGuideListCtrl",["$scope","$state","AdminHOTSGuideService","AlertService","Pagination","data",function(a,b,c,d,e,f){d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.guides=f.guides,a.page=f.page,a.perpage=f.perpage,a.total=f.total,a.search=f.search,a.getGuides=function(){c.getGuides(a.page,a.perpage,a.search).then(function(b){a.guides=b.guides,a.page=b.page,a.total=b.total})},a.searchGuides=function(){a.page=1,a.getGuides()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getGuides()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.editGuide=function(a){return"hero"===a.guideType?b.go("app.admin.hots.guides.edit.hero",{guideID:a._id}):b.go("app.admin.hots.guides.edit.map",{guideID:a._id})},a.deleteGuide=function(b){var d=bootbox.dialog({title:"Delete guide: "+b.name+"?",message:"Are you sure you want to delete the guide <strong>"+b.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.deleteGuide(b._id).then(function(c){if(c.success){var d=a.guides.indexOf(b);-1!==d&&a.guides.splice(d,1),a.success={show:!0,msg:b.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminHOTSGuideAddHeroCtrl",["$scope","$state","AlertService","AdminHOTSGuideService","GuideBuilder","HOTS","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h){a.guide=a.app.settings.guide&&"hero"===a.app.settings.guide.guideType?e["new"]("hero",a.app.settings.guide):e["new"]("hero"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=g.heroes,a.maps=h.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.add.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.add.step1",{})};var i=f.heroRows;a.heroRows=[];for(var j=0,k=0;k<i.length;k++){for(var l=[],m=0;m<i[k];m++)l.push(g.heroes[j]?g.heroes[j]:{}),j++;a.heroRows.push(l)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"};var n=f.mapRows;a.mapRows=[];for(var j=0,k=0;k<n.length;k++){for(var o=[],m=0;m<n[k];m++)h.maps[j]&&o.push(h.maps[j]),j++;a.mapRows.push(o)}a.getTalents=function(b){return a.guide.sortTalents(b)},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void d.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,c.setSuccess({show:!0,msg:a.guide.name+" has been added successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=d.errors,a.showError=!0,$window.scrollTo(0,0))}):!1}}]).controller("AdminHOTSGuideAddMapCtrl",["$scope","$state","AlertService","HOTS","AdminHOTSGuideService","GuideBuilder","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h){a.guide=a.app.settings.guide&&"map"===a.app.settings.guide.guideType?f["new"]("map",a.app.settings.guide):f["new"]("map"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=g.heroes,a.maps=h.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.add.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.add.step1",{})};var i=d.mapRows;a.mapRows=[];for(var j=0,k=0;k<i.length;k++){for(var l=[],m=0;m<i[k];m++)h.maps[j]&&l.push(h.maps[j]),j++;a.mapRows.push(l)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void e.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,c.setSuccess({show:!0,msg:a.guide.name+" has been added successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=d.errors,a.showError=!0,$window.scrollTo(0,0))}):!1}}]).controller("AdminHOTSGuideEditStep1Ctrl",["$scope","dataGuide",function(a,b){a.guide=b.guide}]).controller("AdminHOTSGuideEditHeroCtrl",["$scope","$state","$window","AlertService","GuideBuilder","AdminHOTSGuideService","HOTS","dataGuide","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h,i,j){a.guide=e["new"]("hero",h.guide),a.heroes=i.heroes,a.maps=j.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id})};var k=g.heroRows;a.heroRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)n.push(i.heroes[l]?i.heroes[l]:{}),l++;a.heroRows.push(n)}var p=g.mapRows;a.mapRows=[];for(var l=0,m=0;m<p.length;m++){for(var q=[],o=0;o<p[m];o++)j.maps[l]&&q.push(j.maps[l]),l++;a.mapRows.push(q)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"},a.getTalents=function(b){return a.guide.sortTalents(b)},a.hasTalent=function(b,c){return a.guide.hasTalent(b,c)?" active":""},a.hasAnyTalent=function(b,c){return a.guide.hasAnyTalent(b,c)?" tier-selected":""},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void f.editGuide(a.guide).success(function(e){e.success?(d.setSuccess({show:!0,msg:a.guide.name+" has been updated successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=e.errors,a.showError=!0,c.scrollTo(0,0))}):!1}}]).controller("AdminHOTSGuideEditMapCtrl",["$scope","$state","$window","AlertService","HOTS","GuideBuilder","AdminHOTSGuideService","dataGuide","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h,i,j){a.guide=f["new"]("map",h.guide),a.heroes=i.heroes,a.maps=j.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id})};var k=e.mapRows;a.mapRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)j.maps[l]&&n.push(j.maps[l]),l++;a.mapRows.push(n)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void g.editGuide(a.guide).success(function(e){e.success?(d.setSuccess({show:!0,msg:a.guide.name+" has been updated successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=e.errors,a.showError=!0,c.scrollTo(0,0))}):!1}}]).controller("HOTSHomeCtrl",["$scope","$filter","$timeout","dataHeroes","dataMaps","dataArticles","dataGuidesCommunity","dataGuidesFeatured","ArticleService","HOTSGuideService",function(a,b,c,d,e,f,g,h,i,j){function k(b){for(var c=0;c<a.filters.roles.length;c++)if(a.filters.roles[c]==b)return!0;return!1}function l(b){for(var c=0;c<a.filters.universes.length;c++)if(a.filters.universes[c]==b)return!0;return!1}function m(c){var d=a.filters.search&&a.filters.search.length?b("filter")(a.heroes,{name:a.filters.search}):a.heroes;return-1===d.indexOf(c)}function n(){var b=[];if(!(a.filters.roles.length||a.filters.universes.length||a.filters.heroes.length||a.filters.map))return!1;if(a.filters.heroes.length)for(var c=0;c<a.filters.heroes.length;c++)b.push(a.filters.heroes[c]._id);else if(a.filters.roles.length||a.filters.universes.length)for(var c=0;c<a.heroes.length;c++)o(a.heroes[c])||b.push(a.heroes[c]._id);return a.filters.map&&b.push(a.filters.map._id),b}function o(b){return a.filters.roles.length&&!k(b.role)?!0:a.filters.universes.length&&!l(b.universe)?!0:a.filters.search.length&&m(b)?!0:!1}a.heroes=d.heroes,a.maps=e.maps,a.articles=f.articles,a.guidesCommunity=g.guides,a.guidesFeatured=h.guides,a.filters={roles:[],universes:[],search:"",heroes:[],map:!1};var p=!0;a.$watch(function(){return a.filters},function(b){if(p)c(function(){p=!1});else{for(var d=[],e=0;e<a.heroes.length;e++)o(a.heroes[e])||d.push(a.heroes[e].name);i.getArticles("hots",d,0,6).then(function(b){c(function(){a.articles=b.articles})}),j.getGuidesFeatured(n(),0,10,a.filters.search).then(function(b){c(function(){a.guidesFeatured=b.guides})}),j.getGuidesCommunity(n(),0,10,a.filters.search,!1).then(function(b){
c(function(){a.guidesCommunity=b.guides})})}},!0),a.getGuideCurrentHero=function(a){return a.currentHero?a.currentHero:a.heroes[0]},a.getGuideClass=function(b){return"hero"==b.guideType?a.getGuideCurrentHero(b).hero.className:b.maps[0].className},a.guidePrevHero=function(b,c){b.preventDefault(),b.stopPropagation();for(var d=a.getGuideCurrentHero(c),e=0,f=0;f<c.heroes.length;f++)if(d.hero._id==c.heroes[f].hero._id){e=f;break}c.currentHero=0==e?c.heroes[c.heroes.length-1]:c.heroes[e-1]},a.guideNextHero=function(b,c){b.preventDefault(),b.stopPropagation();for(var d=a.getGuideCurrentHero(c),e=0,f=0;f<c.heroes.length;f++)if(d.hero._id==c.heroes[f].hero._id){e=f;break}c.currentHero=e==c.heroes.length-1?c.heroes[0]:c.heroes[e+1]},a.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1}}]).controller("HOTSGuidesListCtrl",["$q","$scope","$state","$timeout","$filter","HOTSGuideService","AjaxPagination","dataCommunityGuides","dataTopGuide","dataTempostormGuides","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){for(var c=0;c<b.filters.roles.length;c++)if(b.filters.roles[c]==a)return!0;return!1}function n(a){for(var c=0;c<b.filters.universes.length;c++)if(b.filters.universes[c]==a)return!0;return!1}function o(a){var c=b.filters.search&&b.filters.search.length?e("filter")(b.heroes,{name:b.filters.search}):b.heroes;return-1===c.indexOf(a)}function p(a){return b.filters.roles.length&&!m(a.role)?!0:b.filters.universes.length&&!n(a.universe)?!0:b.filters.search.length&&o(a)?!0:!1}function q(){var a=[];if(!(b.filters.roles.length||b.filters.universes.length||b.filters.heroes.length||b.filters.map))return!1;if(b.filters.heroes.length)for(var c=0;c<b.filters.heroes.length;c++)a.push(b.filters.heroes[c]._id);else if(b.filters.roles.length||b.filters.universes.length)for(var c=0;c<b.heroes.length;c++)p(b.heroes[c])||a.push(b.heroes[c]._id);return b.filters.map&&a.push(b.filters.map._id),a}function r(){f.getGuides("hero",q(),1,1,b.filters.search).then(function(a){d(function(){b.topGuides=a.total?a.guides:!1})})}function s(a,c,e){var g=a*c-c;f.getGuidesFeatured(q(),g,c,b.filters.search).then(function(c){b.tempostormPagination.total=c.total,b.tempostormPagination.page=a,d(function(){return b.tempostormGuides=c.guides,e?e(c):void 0})})}function t(a,c,e){var g=a*c-c;f.getGuidesCommunity(q(),g,c,b.filters.search,!1).then(function(c){b.communityPagination.total=c.total,b.communityPagination.page=a,d(function(){return b.communityGuides=c.guides,e?e(c):void 0})})}b.communityGuides=h.guides,b.topGuides=i.total?i.guides:!1,b.tempostormGuides=j.guides,b.heroes=k.heroes,b.maps=l.maps,b.filters={roles:[],universes:[],search:"",heroes:[],map:!1};var u=!0;b.$watch(function(){return b.filters},function(a){if(u)d(function(){u=!1});else{for(var c=[],e=0;e<b.filters.heroes.length;e++)c.push(b.filters.heroes[e]._id);b.filters.map&&c.push(b.filters.map._id),r(),s(1,4),t(1,10)}},!0),b.getTopGuideHeroBg=function(a){return"xs"!==b.app.bootstrapWidth?b.getGuideCurrentHero(a).hero.className:""},b.isLarge=function(){var a=b.app.bootstrapWidth;return"lg"===a||"md"===a?"large":""},b.getGuideCurrentHero=function(a){return a.currentHero?a.currentHero:a.heroes[0]},b.getGuideClass=function(a){return"hero"==a.guideType?b.getGuideCurrentHero(a).hero.className:a.maps[0].className},b.guidePrevHero=function(a,c){a.preventDefault(),a.stopPropagation();for(var d=b.getGuideCurrentHero(c),e=0,f=0;f<c.heroes.length;f++)if(d.hero._id==c.heroes[f].hero._id){e=f;break}c.currentHero=0==e?c.heroes[c.heroes.length-1]:c.heroes[e-1]},b.guideNextHero=function(a,c){a.preventDefault(),a.stopPropagation();for(var d=b.getGuideCurrentHero(c),e=0,f=0;f<c.heroes.length;f++)if(d.hero._id==c.heroes[f].hero._id){e=f;break}c.currentHero=e==c.heroes.length-1?c.heroes[0]:c.heroes[e+1]},b.getTalents=function(a,b){for(var c=[],d=0;d<a.hero.talents.length;d++)a.hero.talents[d].tier===b&&c.push(a.hero.talents[d]);return c},b.selectedTalent=function(a,b,c){return a.talents["tier"+b]._id==c._id},b.getTalent=function(a,b){for(var c=0;c<a.hero.talents.length;c++)if(a.talents["tier"+b]==a.hero.talents[c]._id)return a.hero.talents[c];return!1},b.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1},b.tempostormPagination=g["new"](4,j.total,function(b,c){var d=a.defer();return s(b,c,function(a){d.resolve(a.total)}),d.promise}),b.communityPagination=g["new"](10,h.total,function(c,e){var g=a.defer(),h=c*e-e;return f.getGuidesCommunity(q(),h,e,b.filters.search,!1).then(function(a){d(function(){b.communityGuides=a.guides,g.resolve(a.total)})}),g.promise}),b.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1}}]).controller("HOTSGuideCtrl",["$scope","$window","$state","$sce","$compile","bootbox","VoteService","HOTSGuideService","data","dataHeroes","dataMaps","LoginModalService","MetaService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}b(a.guide)}function o(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;g.voteGuide(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else l.showModal("login",function(){o(b,c)});n(),p()}function p(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.guide.comments.forEach(b)}a.guide=i.guide,a.HOTSGuideService=h,a.currentHero=a.guide.heroes.length?a.guide.heroes[0].hero:!1,a.heroes=j.heroes,a.maps=k.maps,a.metaservice=m,a.metaservice.set(a.guide.name+" - Guides",a.guide.description);var q=a.app.cdn+"img/hots/hots-logo.png";a.metaservice.setOg("https://tempostorm.com/heroes-of-the-storm/guides/"+i.guide.slug,a.guide.name,a.guide.description,"article",q),a.app.settings.show.guide||(a.app.settings.show.guide={talents:!0,description:!0,video:!0,matchups:!0,maps:!0,content:[],comments:!0}),a.show=a.app.settings.show.guide,a.$watch("show",function(){a.app.settings.show.guide=a.show},!0),a.setCurrentHero=function(b){a.currentHero=b},a.getCurrentHero=function(){for(var b=0;b<a.guide.heroes.length;b++)if(a.guide.heroes[b].hero._id===a.currentHero._id)return a.guide.heroes[b];return!1},a.justHeroes=function(){for(var b=[],c=0;c<a.guide.heroes.length;c++)b.push(a.guide.heroes[c].hero);return b},a.getTiers=function(){return[1,4,7,10,13,16,20]},a.getTalents=function(a,b){for(var c=[],d=0;d<a.hero.talents.length;d++)a.hero.talents[d].tier===b&&c.push(a.hero.talents[d]);return c},a.selectedTalent=function(a,b,c){return a.talents["tier"+b]==c._id},a.getTalent=function(a,b){for(var c=0;c<a.hero.talents.length;c++)if(a.talents["tier"+b]==a.hero.talents[c]._id)return a.hero.talents[c];return!1},a.hasSynergy=function(b){return-1!==a.guide.synergy.indexOf(b._id)},a.hasStrong=function(b){return-1!==a.guide.against.strong.indexOf(b._id)},a.hasWeak=function(b){return-1!==a.guide.against.weak.indexOf(b._id)},a.hasMap=function(b){for(var c=0;c<a.guide.maps.length;c++)if(a.guide.maps[c]._id===b._id)return!0;return!1},a.getVideo=function(){return a.getContent('<iframe src="//www.youtube.com/embed/'+a.guide.video+'" frameborder="0" height="360" width="100%" allowfullscreen></iframe>')},a.getContent=function(a){return d.trustAsHtml(a)},a.voteDown=function(a){o(-1,a)},a.voteUp=function(a){o(1,a)};n();var r={comment:""};a.comment=angular.copy(r),a.commentPost=function(){a.app.user.isLogged()?h.addComment(a.guide,a.comment).success(function(b){b.success&&(a.guide.comments.push(b.comment),a.comment.comment="")}):l.showModal("login",function(){a.commentPost()})},p(),a.voteComment=function(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;g.voteComment(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else l.showModal("login",function(){a.voteComment(b,deck)});n(),p()},a.isPremium=function(){if(!a.guide.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.guide.premium.expiryDate).getTime();return c>b?!0:!1},a.getPremium=function(b){a.app.user.isLogged()?a.app.user.isSubscribed()||c.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:b}):l.showModal("login",function(){a.getPremium(b)})}}]).controller("HOTSGuideBuilderHeroCtrl",["$scope","$state","$window","$compile","HOTSGuideService","GuideBuilder","HOTS","dataHeroes","dataMaps","LoginModalService",function(a,b,c,d,e,f,g,h,i,j){a.guide=a.app.settings.guide&&"hero"===a.app.settings.guide.guideType?f["new"]("hero",a.app.settings.guide):f["new"]("hero"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.step1",{})};var k=g.heroRows;a.heroRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)n.push(h.heroes[l]?h.heroes[l]:{}),l++;a.heroRows.push(n)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"};var p=g.mapRows;a.mapRows=[];for(var l=0,m=0;m<p.length;m++){for(var q=[],o=0;o<p[m];o++)i.maps[l]&&q.push(i.maps[l]),l++;a.mapRows.push(q)}a.getTalents=function(b){return a.guide.sortTalents(b)},a.hasTalent=function(b,c){return a.guide.hasTalent(b,c)?" active":""},a.hasAnyTalent=function(b,c){return a.guide.hasAnyTalent(b,c)?" tier-selected":""},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.isPremium=function(){if(!a.guide.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.guide.premium.expiryDate).getTime();return c>b?!0:!1},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void(a.app.user.isLogged()?e.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,b.go("app.hots.guides.guide",{slug:d.slug})):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):j.showModal("login")):!1}}]).controller("HOTSGuideBuilderMapCtrl",["$scope","$state","$window","$compile","HOTS","HOTSGuideService","GuideBuilder","dataHeroes","dataMaps","LoginModalService",function(a,b,c,d,e,f,g,h,i,j){a.guide=a.app.settings.guide&&"map"===a.app.settings.guide.guideType?g["new"]("map",a.app.settings.guide):g["new"]("map"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.step1",{})};var k=e.mapRows;a.mapRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)i.maps[l]&&n.push(i.maps[l]),l++;a.mapRows.push(n)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void(a.app.user.isLogged()?f.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,b.go("app.hots.guides.guide",{slug:d.slug})):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):j.showModal("login")):!1}}]).controller("HOTSGuideBuilderEditStep1Ctrl",["$scope","dataGuide",function(a,b){a.guide=b.guide}]).controller("HOTSGuideBuilderEditHeroCtrl",["$scope","$state","$window","GuideBuilder","HOTSGuideService","HOTS","dataGuide","dataHeroes","dataMaps","LoginModalService",function(a,b,c,d,e,f,g,h,i,j){a.guide=d["new"]("hero",g.guide),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug})};var k=f.heroRows;a.heroRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)n.push(h.heroes[l]?h.heroes[l]:{}),l++;a.heroRows.push(n)}var p=f.mapRows;a.mapRows=[];for(var l=0,m=0;m<p.length;m++){for(var q=[],o=0;o<p[m];o++)i.maps[l]&&q.push(i.maps[l]),l++;a.mapRows.push(q)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"},a.getTalents=function(b){return a.guide.sortTalents(b)},a.hasTalent=function(b,c){return a.guide.hasTalent(b,c)?" active":""},a.hasAnyTalent=function(b,c){return a.guide.hasAnyTalent(b,c)?" tier-selected":""},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.login=function(b,d){void 0!==b&&void 0!==d&&UserService.login(b,d).success(function(b){AuthenticationService.setLogged(!0),AuthenticationService.setAdmin(b.isAdmin),AuthenticationService.setProvider(b.isProvider),SubscriptionService.setSubscribed(b.subscription.isSubscribed),SubscriptionService.setTsPlan(b.subscription.plan),SubscriptionService.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,box.modal("hide"),a.saveGuide()}).error(function(){a.showError=!0})},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void(a.app.user.isLogged()?e.editGuide(a.guide).success(function(d){d.success?b.go("app.hots.guides.guide",{slug:d.slug}):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):j.showModal("login")):!1}}]).controller("HOTSGuideBuilderEditMapCtrl",["$scope","$state","$window","HOTS","GuideBuilder","HOTSGuideService","dataGuide","dataHeroes","dataMaps","LoginModalService",function(a,b,c,d,e,f,g,h,i,j){a.guide=e["new"]("map",g.guide),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug})};var k=d.mapRows;a.mapRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)i.maps[l]&&n.push(i.maps[l]),l++;a.mapRows.push(n)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void(a.app.user.isLogged()?f.editGuide(a.guide).success(function(d){d.success?b.go("app.hots.guides.guide",{slug:d.slug}):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):j.showModal("login")):!1}}]).controller("HOTSTalentCalculatorCtrl",["$scope","dataHeroesList",function(a,b){a.heroes=b.heroes,a.currentHero=!1,a.setCurrentHero=function(b){a.currentHero=b},a.getCurrentHero=function(){return a.currentHero}}]).controller("HOTSTalentCalculatorHeroCtrl",["$scope","$state","$stateParams","$location","$window","HOTS","Base64","dataHero","MetaService",function(a,b,c,d,e,f,g,h,i){function j(b){b=b||d.hash();for(var c=g.toInt(b),e=(c+"").split(""),f=0;f<e.length;f++)e[f]=+e[f];k(e)?a.hash=e:a.hash=[1,1,1,1,1,1,1],l()}function k(b){if(7!==b.length)return!1;for(var c=1;7>=c;c++){var d=+b[c-1];if(1>d||d>a.talentsByTier(a.tiers[c-1]).length+1)return!1}return!0}function l(){var b=+a.hash.join(""),c=b>1111111?g.fromInt(b):"";d.hash(c)}function m(){var b=a.hash,c={};if(k(b)){for(var d=1;7>=d;d++){var e=+b[d-1];c["tier"+a.tiers[d-1]]=e>1?a.talentsByTier(a.tiers[d-1])[e-2]._id:null}return c}return angular.copy(p)}function n(b){for(var c=a.getCurrentHero(),d=0;d<c.talents.length;d++)if(c.talents[d]._id==b)return c.talents[d];return!1}function o(a){return a%1==0}if(!h.success)return b.go("app.hots.talentCalculator.hero",{hero:a.heroes[0].className});a.setCurrentHero(h.hero),a.currentCharacter=a.currentHero.characters[0],a.currentAbility=!1,a.level=1;var p={tier1:null,tier4:null,tier7:null,tier10:null,tier13:null,tier16:null,tier20:null};a.metaservice=i,a.metaservice.set(h.hero.name+" - Talent Calculator",h.hero.description);var q=a.app.cdn+"img/hots/hots-logo.png";a.metaservice.setOg(d.absUrl(),h.hero.name,h.hero.description,"article",q),a.getCurrentCharacter=function(){return a.currentCharacter},a.setCurrentCharacter=function(b){a.currentCharacter=b},a.getAbilities=function(){for(var b=a.getCurrentHero().abilities,c=[],d=0;d<b.length;d++)"Ability"==b[d].abilityType&&c.push(b[d]);return c},a.getHeroics=function(){for(var b=a.getCurrentHero().abilities,c=[],d=0;d<b.length;d++)"Heroic Ability"==b[d].abilityType&&c.push(b[d]);return c},a.getTrait=function(){for(var b=a.getCurrentHero().abilities,c=0;c<b.length;c++)if("Combat Trait"==b[c].abilityType)return b[c];return!1},a.getCurrentAbility=function(){return a.currentAbility},a.toggleAbility=function(b){a.getCurrentAbility()&&a.getCurrentAbility()===b?a.currentAbility=!1:a.currentAbility=b},a.tiers=f.tiers,a.talentsByTier=function(b){for(var c=a.currentHero,d=[],e=0;e<c.talents.length;e++)c.talents[e].tier===b&&d.push(c.talents[e]);return d},a.hasTalent=function(b){return a.currentTalents["tier"+b.tier]==b._id?" active":""},a.hasAnyTalent=function(b){return null!==a.currentTalents["tier"+b.tier]?" tier-selected":""},a.toggleTalent=function(b,c,d){a.hasTalent(b)?a.currentTalents["tier"+b.tier]=null:a.currentTalents["tier"+b.tier]=b._id,a.hash[c]=a.hasTalent(b)?d+2:1,k(a.hash)&&l()},a.hash=[1,1,1,1,1,1,1],j(),a.currentTalents=m(),a.$watch(function(){return location.hash},function(b){var c=b.substr(1,b.length-1);j(c),a.currentTalents=m()}),a.getAbilityTalents=function(){var b,c=a.getCurrentAbility(),d=a.currentTalents,e=a.tiers,f=[];if(!c)return f;for(var g=0;g<e.length;g++)null!==d["tier"+e[g]]&&(b=n(d["tier"+e[g]]),b&&b.ability==c._id&&f.push(b));return f},a.url=function(){return d.absUrl()},a.getHealth=function(){var b=a.getCurrentCharacter(),c=a.level;return b.stats.base.health+(c*b.stats.gain.health-b.stats.gain.health)},a.getHealthRegen=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.healthRegen+(c*b.stats.gain.healthRegen-b.stats.gain.healthRegen);return o(d)?d:+d.toFixed(2)},a.getMana=function(){var b=a.getCurrentCharacter(),c=a.level;return b.stats.base.mana+(c*b.stats.gain.mana-b.stats.gain.mana)||"N/A"},a.getManaRegen=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.manaRegen+(c*b.stats.gain.manaRegen-b.stats.gain.manaRegen);return o(d)?d||"N/A":+d.toFixed(2)},a.getSpeed=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.attackSpeed+(c*b.stats.gain.attackSpeed-b.stats.gain.attackSpeed);return o(d)?d:+d.toFixed(2)},a.getRange=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.range+(c*b.stats.gain.range-b.stats.gain.range);return o(d)?d:+d.toFixed(2)},a.getDamage=function(){var b=a.getCurrentCharacter(),c=a.level;return b.stats.base.damage+(c*b.stats.gain.damage-b.stats.gain.damage)},a.getDPS=function(){var b=a.getSpeed()*a.getDamage();return o(b)?b:+b.toFixed(2)},a.copyUrl=function(){var a=document.querySelector(".tc-url");a.select();try{document.execCommand("copy")}catch(b){alert("Your browser does not support this feature.")}window.getSelection().removeAllRanges()},a.reset=function(){d.hash("")}}]).controller("PollsCtrl",["$scope","$sce","$compile","bootbox","PollService","dataPollsMain","dataPollsSide",function(a,b,c,d,e,f,g){var h;a.pollsMain=f.polls,a.pollsSide=g.polls,a.toggleItem=function(b,c){if(b.votes||(b.votes=[]),a.hasVoted(b,c))b.votes.splice(b.votes.indexOf(c._id),1);else{if(b.votes.length>=b.voteLimit)return!1;b.votes.push(c._id)}},a.getContent=function(a){return b.trustAsHtml(a)},a.btnText=function(b,c){return a.hasVoted(b,c)?"Unpick":"Pick"},a.voteCurve=function(a,b){for(var a,c,d=a.votes,e=0,f=0;f<b.items.length;f++)c=b.items[f].votes,c>e&&(e=c);return 0===e?0:Math.ceil(d/e*100)},a.votePercentage=function(a,b){for(var c=a.votes,d=0,e=0;e<b.items.length;e++)d=parseInt(d+b.items[e].votes);return 0===d?0:Math.ceil(c/d*100)},a.hasVoted=function(a,b){return a.votes?-1!==a.votes.indexOf(b._id):!1},a.isDoneVoting=function(a){return e.getStorage(a)?e.getStorage(a):null},a.setDoneVoting=function(a,b){return e.setStorage(a._id,b)},a.getVotes=function(a){return a.votes},a.getLocalVotes=function(a,b){for(var c=e.getStorage(a._id).split(","),d=0;d<c.length;d++)if(b._id==c[d])return!0},a.bigImg=function(b,e){h=d.dialog({title:e,message:c('<a ng-click="closeBox()"><img class="img-responsive" ng-src="'+a.app.cdn+"polls/"+b+'" alt=""></a>')(a),backdrop:!0}),h.modal("show")},a.closeBox=function(){h.modal("hide")},a.submitVote=function(b){e.postVote(b,b.votes).success(function(c){if(c.success){var d=a.getVotes(b).join(",");a.setDoneVoting(b,d);for(var e=0;e!=b.items.length;e++)for(var f=0;f!=a.getVotes(b).length;f++)b.items[e]._id==a.getVotes(b)[f]&&b.items[e].votes++}else $data.errors=c.errors})}}]).controller("twitchCtrl",["$scope","dataTwitch",function(a,b){a.streams=b.stuff}]);var Z;angular.module("app.directives",["ui.load"]).directive("uiModule",["MODULE_CONFIG","uiLoad","$compile",function(a,b,c){return{restrict:"A",compile:function(d,e){var f=d.contents().clone();return function(d,e,g){e.contents().remove(),b.load(a[g.uiModule]).then(function(){c(f)(d,function(a,b){e.append(a)})})}}}}]).directive("uiAdminNav",[function(){return{restrict:"AE",link:function(a,b,c){b.on("click","a",function(a){var b=$(this);b.parent().siblings(".active").toggleClass("active"),b.next().is("ul")&&b.parent().toggleClass("active")})}}}]).directive("hsCard",function(){return{restrict:"A",link:function(a,b,c){var d=c.tooltipPos&&"left"===c.tooltipPos?-344:60;b.wTooltip({delay:500,offsetX:d,offsetY:-40,content:'<img src="'+c.tooltipImg+'" alt="">',style:!1,className:"hs-card-tooltip"})}}}).directive("loginModal",["LoginModalService","$rootScope",function(a,b){return{templateUrl:tpl+"views/frontend/directives/login/login.modal.html",scope:!0,controller:["$scope",function(c){c.state=b.LoginModalService.state,c.callback=b.LoginModalService.callback,c.getState=function(){return c.state},c.setState=function(a){switch(a){case"login":c.state="login",c.title="User Login";break;case"signup":c.state="signup",c.title="User Signup";break;case"forgot":c.state="forgot",c.title="Forgot Password";break;case"verify":c.state="verify",c.title="Verify Email";break;default:c.state="login",c.title="UserLogin"}},c.setState(c.state),c.closeModal=function(){a.hideModal()}}],link:function(a,b,c){a.setTitle=function(a){$(".modal-title")[0].innerHTML=a}}}}]).directive("loginForm",["$window","$cookies","$state","AuthenticationService","LoginModalService","UserService","SubscriptionService",function(a,b,c,d,e,f,g){return{templateUrl:tpl+"views/frontend/directives/login/login.form.html",scope:!0,link:function(e,h,i){e.remember,e.loginInfo={email:"",password:""};var j=b.getObject("TSRememberMe");void 0!=j&&(e.remember=!0,e.loginInfo.email=j.email,e.loginInfo.password=j.password),e.login=function(h,i){void 0!==h&&void 0!==i&&f.login(h,i).success(function(f){if(d.setLogged(!0),d.setAdmin(f.isAdmin),d.setProvider(f.isProvider),g.setSubscribed(f.subscription.isSubscribed),g.setTsPlan(f.subscription.plan),g.setExpiry(f.subscription.expiry),a.sessionStorage.userID=f.userID,a.sessionStorage.username=f.username,a.sessionStorage.email=f.email,a.sessionStorage.token=f.token,e.setState?e.closeModal():c.go("app.home"),e.remember){var h=new Date;h.setDate(h.getDate()+356),b.putObject("TSRememberMe",{email:e.loginInfo.email,password:e.loginInfo.password},{expires:h})}else b.remove("TSRememberMe");e.callback&&e.callback()}).error(function(){e.showError=!0})}}}}]).directive("signupForm",["$state","UserService","LoginModalService",function(a,b,c){return{templateUrl:tpl+"views/frontend/directives/login/signup.form.html",scope:!0,link:function(c,d,e){c.verify={email:"",code:""},c.signup=function(d,e,f,g){void 0!==d&&void 0!==e&&void 0!==f&&void 0!==g&&b.signup(d,e,f,g).success(function(b){b.success?(c.verify.email=d,c.setState?c.state="verify":a.go("app.verify")):(c.errors=b.errors,c.showError=!0)})}}}}]).directive("forgotPasswordForm",["LoginModalService","UserService",function(a,b){return{templateUrl:tpl+"views/frontend/directives/login/forgot.password.form.html",scope:!0,link:function(a,c,d){a.forgotPassword=function(){b.forgotPassword(a.forgot.email).success(function(b){b.success?(a.showSuccess=!0,a.forgot.email=""):(a.errors=b.errors,a.showError=!0)})}}}}]).directive("verifyForm",["LoginModalService",function(a){return{templateUrl:tpl+"views/frontend/directives/login/verify.form.html",scope:!0,link:function(a,b,c){a.verifyEmail=function(b,c){UserService.verifyEmail(b,c).success(function(b){b.success?(AuthenticationService.setLogged(!0),AuthenticationService.setAdmin(b.isAdmin),AuthenticationService.setProvider(b.isProvider),SubscriptionService.setSubscribed(b.subscription.isSubscribed),SubscriptionService.setTsPlan(b.subscription.plan),SubscriptionService.setExpiry(b.subscription.expiry),$window.sessionStorage.userID=b.userID,$window.sessionStorage.username=b.username,$window.sessionStorage.email=b.email,$window.sessionStorage.token=b.token,a.closeModal()):(a.errors=b.errors,a.showError=!0)})}}}}]).directive("commentSection",["$rootScope","$sce","VoteService","LoginModalService",function(a,b,c,d){return{restrict:"E",templateUrl:tpl+"views/frontend/directives/comments/commentSection.html",scope:{commentable:"=",service:"="},controller:["$scope",function(e){function f(){function a(a){var b=a.votes.filter(function(a){return e.app.user.getUserID()===a.userID})[0];b&&(a.voted=b.direction)}e.commentable.comments.forEach(a)}e.commentable,e.service,e.app=a.app;var g="";e.comment=angular.copy(g),e.parseComment=function(a){return b.trustAsHtml(a)},e.commentPost=function(){e.app.user.isLogged()?(console.log(e.comment,e.comment.replace(/<[^>]+>/gm,"")),e.service.addComment(e.commentable,e.comment).success(function(a){a.success&&(e.commentable.comments.push(a.comment),e.comment="",f())})):d.showModal("login",function(){e.commentPost()})},f(),e.voteComment=function(a,b){if(e.app.user.isLogged()){if(b.author._id===e.app.user.getUserID())return bootbox.alert("You can't vote for your own content."),!1;c.voteComment(a,b).then(function(c){c.success&&(b.voted=a,b.votesCount=c.votesCount)})}else d.showModal("login",function(){e.voteComment(a,b)});f()}}],link:function(a,b,c){a.addAreaFocus=!1}}}]).directive("datePicker",function(){return{replace:!0,templateUrl:tpl+"views/admin/date-picker.html",scope:{ngModel:"=",ngDisabled:"=",dateOptions:"="},link:function(a,b,c,d){var e=c.id||"datePicker",f=c.name||"datePicker",g=b.find("button"),h=c["class"]||"",i=b.find("input").attr("id",e).attr("name",f).addClass(h);g.on("click",function(){i.trigger(i.is(":focus")?"blur":"focus")})}}}).directive("ngRightClick",["$parse",function(a){return function(b,c,d){var e=a(d.ngRightClick);c.bind("contextmenu",function(a){b.$apply(function(){a.preventDefault(),e(b,{$event:a})})})}}]).directive("footer",function(){return{templateUrl:tpl+"views/frontend/footer.html"}}).directive("scroll",["$window",function(a){return function(b,c,d){angular.element(a).bind("scroll",function(){this.pageYOffset>=1?b.scrolled=!0:b.scrolled=!1,b.$apply()})}}]).directive("subNav",["$window",function(a){return function(b,c,d){angular.element(a).bind("scroll",function(){this.pageYOffset>=c.parent().offset().top-50?(c.addClass("sticky"),c.parent().addClass("sticky")):(c.removeClass("sticky"),c.parent().removeClass("sticky")),b.$apply()}),angular.element(a).bind("resize",function(){this.pageYOffset>=c.parent().offset().top-50?(c.addClass("sticky"),c.parent().addClass("sticky")):(c.removeClass("sticky"),c.parent().removeClass("sticky")),b.$apply()})}}]).directive("subNavStream",["TwitchService","$timeout","Util",function(a,b,c){return{restrict:"E",replace:!0,scope:!1,templateUrl:"views/frontend/directives/subnav.stream.html",controller:["$scope",function(d){d.subNavStreams=[],d.showSubNavStream=!1,a.getStreams().then(function(a){for(var c=0;c<a.data.length;c++){var e=a.data[c].logoUrl,f=e.substr(4),g="https"+f;a.data[c].logoUrl=g,a.data[c].viewerCount=+a.data[c].viewerCount}d.selectedStream=a.data.length-1,b(function(){a.data.length&&(d.showSubNavStream=!0),d.subNavStreams=a.data})}),d.changeStream=function(a){"increment"==a?++d.selectedStream==d.subNavStreams.length&&(d.selectedStream=0):"decrement"==a&&--d.selectedStream<0&&(d.selectedStream=d.subNavStreams.length-1)},d.getNumber=function(a){return c.numberWithCommas(a)}}]}}]).directive("ngBackground",function(){return function(a,b,c){var d=c.ngBackground;b.css({"background-image":"url('"+d+"')","background-position":"center center","background-size":"cover"})}}).directive("ngTooltip",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){$(c).tooltip()})}}}]).directive("tsArticle",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){c.find("img").addClass("img-responsive").css("height","auto"),c.find("table").addClass("table-responsive").css("table-layout","auto")})}}}]).directive("pollItemAddForm",function(){return{templateUrl:tpl+"views/admin/polls.item.add.html"}}).directive("pollItemEditForm",function(){return{templateUrl:tpl+"views/admin/polls.item.edit.html"}}).directive("abilityAddForm",function(){return{templateUrl:tpl+"views/admin/hots.heroes.ability.add.html"}}).directive("abilityEditForm",function(){return{templateUrl:tpl+"views/admin/hots.heroes.ability.edit.html"
}}).directive("talentAddForm",function(){return{templateUrl:tpl+"views/admin/hots.heroes.talent.add.html"}}).directive("talentEditForm",function(){return{templateUrl:tpl+"views/admin/hots.heroes.talent.edit.html"}}).directive("charAddForm",function(){return{templateUrl:tpl+"views/admin/hots.heroes.char.add.html"}}).directive("charEditForm",function(){return{templateUrl:tpl+"views/admin/hots.heroes.char.edit.html"}}).directive("talentModal",function(){return{templateUrl:tpl+"views/frontend/hots.talent.modal.html"}}).directive("heroModal",function(){return{templateUrl:tpl+"views/frontend/hots.hero.modal.html"}}).directive("mapModal",function(){return{templateUrl:tpl+"views/frontend/hots.map.modal.html"}}).directive("hotsTalent",["$compile",function(a){return{restrict:"A",scope:{hero:"=hero",talent:"=talent"},link:function(b,c,d){var e=d.tooltipPos&&"left"===d.tooltipPos?-560:111;c.wTooltip({delay:500,offsetX:e,offsetY:-70,content:a("<div talent-modal></div>")(b),style:!1,className:"hots-talent-tooltip"})}}}]).directive("hotsHero",["$compile",function(a){return{restrict:"A",link:function(b,c,d){var e=d.tooltipPos&&"left"===d.tooltipPos?-690:60;c.wTooltip({delay:500,offsetX:e,offsetY:-130,content:a("<div hero-modal></div>")(b),style:!1,className:"hots-hero-tooltip"})}}}]).directive("hotsMap",["$compile",function(a){return{restrict:"A",link:function(b,c,d){var e=d.tooltipPos&&"left"===d.tooltipPos?-560:60;c.wTooltip({delay:500,offsetX:e,offsetY:-130,content:a("<div map-modal></div>")(b),style:!1,className:"hots-map-tooltip"})}}}]).directive("activitySignup",function(){return{templateUrl:tpl+"views/frontend/activity/activity.signup.html"}}).directive("activityArticle",function(){return{templateUrl:tpl+"views/frontend/activity/activity.article.html"}}).directive("activityArticleComment",function(){return{templateUrl:tpl+"views/frontend/activity/activity.article.comment.html"}}).directive("activityDeck",function(){return{templateUrl:tpl+"views/frontend/activity/activity.deck.html"}}).directive("activityDeckComment",function(){return{templateUrl:tpl+"views/frontend/activity/activity.deck.comment.html"}}).directive("activityForumPost",function(){return{templateUrl:tpl+"views/frontend/activity/activity.forumPost.html"}}).directive("activityForumPostComment",function(){return{templateUrl:tpl+"views/frontend/activity/activity.forumPost.comment.html"}}).directive("activityGuide",function(){return{templateUrl:tpl+"views/frontend/activity/activity.guide.html"}}).directive("activityGuideComment",function(){return{templateUrl:tpl+"views/frontend/activity/activity.guide.comment.html"}}).directive("activitySnapshotComment",function(){return{templateUrl:tpl+"views/frontend/activity/activity.snapshot.comment.html"}}).directive("premiumPage",function(){return{templateUrl:tpl+"views/frontend/premiumDirective.html"}}).directive("articleItemAdd",function(){return{templateUrl:tpl+"views/admin/articles.item.add.html"}}).directive("articleRelatedAdd",function(){return{templateUrl:tpl+"views/admin/articles.related.add.html"}}).directive("hsBuilder",function(){return{templateUrl:tpl+"views/frontend/hs.deckBuilder.directive.html"}}).directive("hotsBuilder",function(){return{templateUrl:tpl+"views/frontend/hots.guideBuilder.directive.html"}}).directive("hotsTc",function(){return{templateUrl:tpl+"views/frontend/hots.tc.directive.html"}}).directive("a",function(){return{restrict:"E",link:function(a,b,c){(c.ngClick||""===c.href||"#"===c.href)&&b.on("click",function(a){a.preventDefault()})}}}).directive("talentIconLg",["$window",function(a){return{restrict:"A",link:function(b,c,d){b.isLarge=a.innerWidth>=1200?" large":"",angular.element(a).on("resize",function(){b.$apply(function(){b.isLarge=a.innerWidth>=1200?" large":""})})}}}]).directive("talentIconMd",["$window",function(a){return{restrict:"A",link:function(b,c,d){b.isLarge=a.innerWidth>=992?" large":"",angular.element(a).on("resize",function(){b.$apply(function(){b.isLarge=a.innerWidth>=992?" large":""})})}}}]).directive("spinnerButton",[function(){return{restrict:"A",link:function(a,b,c){b.addClass("has-spinner"),b.append(' <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>'),a.$watch(c.spinnerButton,function(a){b.toggleClass("spinning",a)})}}}]).directive("markItUp",["markitupSettings",function(a){return{restrict:"A",scope:{ngModel:"="},link:function(b,c,d){var e;e=a.create(function(a){b.$apply(function(){b.ngModel=a.textarea.value})}),angular.element(c).markItUp(e)}}}]).directive("snapshotAddAuthor",[function(){return{templateUrl:tpl+"views/admin/snapshot.add.author.html"}}]).directive("snapshotAddDeck",[function(){return{templateUrl:tpl+"views/admin/snapshot.add.deck.html"}}]).directive("snapshotAddCard",[function(){return{templateUrl:tpl+"views/admin/snapshot.add.card.html"}}]).directive("fbLikeButton",[function(){return{restrict:"A",replace:!0,scope:{url:"=url"},templateUrl:tpl+"views/frontend/socialmedia/fblikebutton.html"}}]).directive("tweetButton",[function(){return{restrict:"A",replace:!0,scope:{url:"=url"},templateUrl:tpl+"views/frontend/socialmedia/tweetbutton.html"}}]).directive("redditButton",[function(){return{restrict:"A",replace:!0,scope:{url:"=url"},templateUrl:tpl+"views/frontend/socialmedia/redditbutton.html"}}]).directive("dbDeck",[function(){return{restrict:"A",replace:!0,scope:{mulliganHide:"=",deck:"=deck"},link:function(a,b,c){a.getDust=function(){for(var b=0,c=0;c<a.deck.cards.length;c++)b+=a.deck.cards[c].qty*a.deck.cards[c].card.dust;return b}},controller:["$scope",function(a){a.cdn=a.$parent.$parent.$parent.$parent.$parent.app.cdn}],templateUrl:tpl+"views/frontend/directives/db.deck.html"}}]).directive("homeArticles",["$window",function(a){return{restrict:"A",scope:{viewable:"&",offset:"=",size:"="},link:function(b,c,d){function e(){var a=100/b.viewable()*b.size/100*($("body").innerWidth()-20);$(c).find(".home-articles-inner").css("width",a+"px"),$(c).find(".home-article-wrapper").css("width",Math.floor(a/b.size,2)+"px")}function f(){var a=100/b.viewable()*b.size/100*($("body").innerWidth()-20),d=b.offset+b.viewable()>b.size?b.size-b.viewable():b.offset;$(c).find(".home-articles-inner").css("left",Math.floor(a/b.size)*d*-1+"px")}b.$watch(function(a){return a.viewable()},function(a){e(),f()}),b.$watch("offset",function(a){f()}),b.$watch("size",function(a){e()}),angular.element(a).bind("resize",function(){e(),f()})}}}]).directive("bootstrapWidth",["$window","$timeout",function(a,b){return{restrict:"A",link:function(c,d,e){function f(){var a=$("body").innerWidth();768>a?c.app.bootstrapWidth="xs":993>a?c.app.bootstrapWidth="sm":1199>a?c.app.bootstrapWidth="md":c.app.bootstrapWidth="lg",b(function(){c.$apply()})}f(),angular.element(a).bind("resize",function(){f()})}}}]).directive("hotsFiltering",["$filter","$timeout",function(a,b){return{restrict:"A",scope:{maps:"=",heroes:"=",filters:"="},templateUrl:tpl+"views/frontend/directives/hots.filtering.html",link:function(c,d,e){function f(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function g(){var a=c.heroes[i];return{name:a.name,title:a.title,className:a.className}}var h=!0,i=!1;c.$watch(function(){return c.filters},function(a){h?b(function(){h=!1,i=f(0,c.heroes.length-1)}):c.filters=a},!0),c.updateSearch=function(){c.filters.search=c.searchHeroes},c.hasFilterRole=function(a){for(var b=0;b<c.filters.roles.length;b++)if(c.filters.roles[b]==a)return!0;return!1},c.hasFilterUniverse=function(a){for(var b=0;b<c.filters.universes.length;b++)if(c.filters.universes[b]==a)return!0;return!1},c.toggleFilterHero=function(a){var b=c.filters.heroes.indexOf(a);-1===b?(c.filters.roles.length&&-1==c.filters.roles.indexOf(a.role)&&c.filters.roles.push(a.role),c.filters.universes.length&&-1==c.filters.universes.indexOf(a.universe)&&c.filters.universes.push(a.universe),c.filters.heroes=[a]):c.filters.heroes=[],c.filters.heroes.length||(i=f(0,c.heroes.length-1))},c.isFiltered=function(a){return c.hasFilterHero(a)?!1:c.hasAnyFilterHero()&&!c.hasFilterHero(a)?!0:c.filters.roles.length&&!c.hasFilterRole(a.role)?!0:c.filters.universes.length&&!c.hasFilterUniverse(a.universe)?!0:c.searchHeroes&&c.searchHeroes.length&&c.hasFilterSearch(a)?!0:!1},c.hasFilterHero=function(a){return-1!==c.filters.heroes.indexOf(a)},c.hasFilterSearch=function(b){var d=c.searchHeroes&&c.searchHeroes.length?a("filter")(c.heroes,{name:c.searchHeroes}):c.heroes;return-1===d.indexOf(b)},c.hasAnyFilter=function(){return c.filters.roles.length||c.filters.universes.length||c.filters.search.length||c.filters.heroes.length},c.hasAnyFilterHero=function(){return c.filters.heroes.length},c.hasFilterMap=function(a){return c.filters.map===a},c.hasAnyFilterMap=function(){return c.filters.map!==!1},c.toggleFilterMap=function(a){c.filters.map=c.filters.map==a?!1:a},c.currentMapBack=function(){return c.filters.map?c.filters.map.className:"default"},c.heroDots=[{}];for(var j=0;55>j;j++)c.heroDots.push(c.heroes[j]?c.heroes[j]:{});c.hero=function(){return c.filters.heroes.length?c.filters.heroes[c.filters.heroes.length-1]:i?g():{name:" ",title:" ",className:"default"}}}}}]).directive("hotsFilterRole",["$filter","$timeout",function(a,b){return{restrict:"A",scope:{filters:"="},templateUrl:tpl+"views/frontend/directives/hots.filter.role.html",replace:!0,link:function(a,c,d){var e=!0;a.$watch(function(){return a.filters},function(c){e?b(function(){e=!1}):a.filters=c},!0),a.toggleFilterRole=function(b){var c=a.filters.roles.indexOf(b);-1===c?a.filters.roles.push(b):a.filters.roles.splice(c,1)},a.hasFilterRole=function(b){for(var c=0;c<a.filters.roles.length;c++)if(a.filters.roles[c]==b)return!0;return!1}}}}]).directive("hotsFilterUniverse",["$filter","$timeout",function(a,b){return{restrict:"A",scope:{filters:"="},templateUrl:tpl+"views/frontend/directives/hots.filter.universe.html",replace:!0,link:function(a,c,d){var e=!0;a.$watch(function(){return a.filters},function(c){e?b(function(){e=!1}):a.filters=c},!0),a.toggleFilterUniverse=function(b){var c=a.filters.universes.indexOf(b);-1===c?a.filters.universes.push(b):a.filters.universes.splice(c,1)},a.hasFilterUniverse=function(b){for(var c=0;c<a.filters.universes.length;c++)if(a.filters.universes[c]==b)return!0;return!1}}}}]).directive("hsFilterClass",["$filter","$timeout",function(a,b){return{restrict:"A",scope:{classes:"=",filters:"="},templateUrl:tpl+"views/frontend/directives/hs.filter.class.html",replace:!0,link:function(a,c,d){var e=!0;a.$watch(function(){return a.filters},function(c){e?b(function(){e=!1}):a.filters=c},!0),a.toggleFilterClass=function(b){var c=a.filters.classes.indexOf(b);-1===c?a.filters.classes.push(b):a.filters.classes.splice(c,1)},a.hasFilterClass=function(b){if(!b)return a.filters.classes.length>0;for(var c=0;c<a.filters.classes.length;c++)if(a.filters.classes[c]==b)return!0;return!1}}}}]).directive("articleThumb",["$sce",function(a){return{restrict:"E",replace:!0,scope:{article:"="},templateUrl:tpl+"views/frontend/directives/article.thumb.html",controller:["$scope",function(b){b.getDescription=function(b){var c=b,d=170;if(b.length>d-10){if(" "!=b[d]){for(var e=0;" "!=b[d+e]&&void 0!=b[d+e];e++);b=c.slice(0,d+e)}else b=c.slice(0,d);b+="..."}return a.trustAsHtml(b)},b.isPremium=function(a){if(!a.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.premium.expiryDate).getTime();return c>b?!0:!1}}]}}]).directive("hsFilterClassLarge",["$filter","$timeout",function(a,b){return{restrict:"A",scope:{classes:"=",filters:"="},templateUrl:tpl+"views/frontend/directives/hs.filter.class.large.html",replace:!0,link:function(a,c,d){var e=!0;a.$watch(function(){return a.filters},function(c){e?b(function(){e=!1}):a.filters=c},!0),a.toggleFilterClass=function(b){var c=a.filters.classes.indexOf(b);-1===c?a.filters.classes.push(b):a.filters.classes.splice(c,1)},a.hasFilterClass=function(b){if(!b)return a.filters.classes.length>0;for(var c=0;c<a.filters.classes.length;c++)if(a.filters.classes[c]==b)return!0;return!1}}}}]).directive("pagination",["$timeout",function(a){return{restrict:"A",scope:{pagination:"="},templateUrl:function(a,b){var c=b.theme||"default";return tpl+"views/frontend/directives/pagination/"+c+".html"}}}]).directive("noAnimate",["$animate",function(a){return{restrict:"A",link:function(b,c,d){a.enabled(c,!1)}}}]).directive("tempostormTv",["TwitchService","Util",function(a,b){return{restrict:"A",scope:!1,templateUrl:tpl+"views/frontend/directives/twitch.streams.html",link:function(c,d,e){c.streamWheel=!1,c.streams=void 0,c.getNumber=function(a){return b.numberWithCommas(a)},a.getStreams().then(function(a){for(var b=0;b<a.data.length;b++){var d=a.data[b].screenshotUrl,e=d.substr(4),f="https"+e;a.data[b].screenshotUrl=f,a.data[b].viewerCount=+a.data[b].viewerCount}c.streamWheel=!0,c.streams=a.data})}}}]).directive("twitterFeed",["$sce","TwitterService",function(a,b){return{restrict:"A",templateUrl:tpl+"views/frontend/directives/twitter.tweets.html",link:function(c,d,e){c.twitWheel=!1,c.tweets=void 0,b.getFeed().then(function(a){c.twitWheel=!0,c.tweets=a.data}),c.getContent=function(b){return a.trustAsHtml(b)}}}}]).directive("videoOfTheDay",["VodService",function(a){return{restrict:"A",template:function(){return'<h3 class="sub-title m-b-md">{{vod.subTitle}}</h3><youtube-video class="home-vod" ng-if="vod.url" video-url="vod.url"></youtube-video><youtube-video class="home-vod" ng-if="vod.vars.list" player-vars="vod.vars"></youtube-video>'},link:function(b,c,d){a.getLatestVod().then(function(a){b.vod=a.vod})}}}]),angular.module("app.filters",[]).filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}).filter("filterAll",["$filter",function(a){var b=a("filter");return function(a,c){Array.prototype.diff=function(a){var b=[];for(e in this)a.indexOf(this[e])>-1&&b.push(this[e]);return b},c=c||"",c=c.split("+");for(var d=[],e=0;e<c.length;e++)d=0===e?d.concat(b(a,c[e])):d.diff(b(a,c[e]));return d}}]),angular.module("app.services",[]).service("MetaService",function(){var a=void 0,b="",c="",d="",e="They",f="",g="",h="",i="";return{setStatusCode:function(b){a=b},setOg:function(a,g,h,i,j){c=a||"https://tempostorm.com",e=g||"TempoStorm",f=h||"TempoStorm Official Website.",b=i||"website",d=j||""},set:function(a,b,c){i=c,h=b,g=a},ogMetaType:function(){return b},ogMetaUrl:function(){return c},ogMetaImage:function(){return d&&""!=d?d.toLowerCase():tpl+"img/100x100tsoglogo.png"},ogMetaTitle:function(){return e},ogMetaDescription:function(){return f.replace(/<\/?[^>]+(>|$)/g,"")},metaTitle:function(){return g+" - TempoStorm"},metaDescription:function(){return h},metaKeywords:function(){return i},getStatusCode:function(){return a}}}).factory("AuthenticationService",function(){var a=!1,b=!1,c=!1;return{isLogged:function(){return a},setLogged:function(b){a=b},isAdmin:function(){return b},setAdmin:function(a){b=a},isProvider:function(){return c},setProvider:function(a){c=a}}}).factory("SubscriptionService",["$http",function(a){var b=!1,c=!1,d=!1;return{isSubscribed:function(){var a=(new Date).getTime();return b?!0:d?d>a:!1},getSubscription:function(){return{isSubscribed:b,tsPlan:c,expiry:d}},setSubscribed:function(a){b=a},setTsPlan:function(a){c=a},setExpiry:function(a){d=a?new Date(a).getTime():a},setPlan:function(b,c){return c=c||!1,a.post("/api/subscription/setplan",{plan:b,cctoken:c})},setCard:function(b){return a.post("/api/subscription/setcard",{cctoken:b})},cancel:function(){return a.post("/api/subscription/cancel",{})}}}]).factory("UserService",["$http","$compile",function(a,b){return{login:function(b,c){return a.post("/login",{email:b,password:c})},signup:function(b,c,d,e){return a.post("/signup",{email:b,username:c,password:d,cpassword:e})},forgotPassword:function(b){return a.post("/forgot-password",{email:b})},resetPassword:function(b,c,d,e){return a.post("/forgot-password/reset",{email:b,code:c,password:d,cpassword:e})},verifyEmail:function(b,c){return a.post("/verify",{email:b,code:c})},verify:function(){return a.post("/api/verify",{})},twitch:function(){return a.post("/auth/twitch",{})},logout:function(){username="",profileImg=""}}}]).factory("LoginModalService",["$rootScope","$compile",function(a,b){var c=void 0;return{showModal:function(d,e){a.LoginModalService.callback=e,a.LoginModalService.state=d,c=bootbox.dialog({title:function(){switch(d){case"login":return"User Login";case"signup":return"User Signup";case"forgot":return"Forgot Password";case"verify":return"Verify Email";default:return"User Login"}},className:"login-modal",message:b('<login-modal callback="LoginModalService.callback()"></login-modal>')(a)}),c.modal("show")},hideModal:function(){c.modal("hide")}}}]).factory("ArticleService",["$http","$q",function(a,b){return{getArticles:function(c,d,e,f,g){var h=b.defer(),c=c||"all",d=d||"all",e=e||0,f=f||20,g=g||"";return a.post("/articles",{articleType:c,filter:d,offset:e,num:f,search:g}).success(function(a){h.resolve(a)}),h.promise},getArticle:function(c){var d=b.defer();return a.post("/article",{slug:c}).success(function(a){d.resolve(a)}),d.promise},addComment:function(b,c){return a.post("/api/article/comment/add",{articleID:b._id,comment:c})}}}]).factory("AdminSnapshotService",["$http","$q",function(a,b){return{getSnapshots:function(c,d,e){var c=c||1,d=d||10,e=e||"",f=b.defer();return a.post("/api/admin/snapshots",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getSnapshot:function(c){var d=b.defer();return a.post("/api/admin/snapshot",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getLatest:function(){var c=b.defer();return a.post("/api/admin/snapshot/latest",{}).success(function(a){c.resolve(a)}),c.promise},addSnapshot:function(b){return a.post("/api/admin/snapshot/add",b)},editSnapshot:function(b){return a.post("/api/admin/snapshot/edit",b)},deleteSnapshot:function(c){var d=b.defer();return a.post("/api/admin/snapshot/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("SnapshotService",["$http","$q","$localStorage",function(a,b,c){return{getSnapshots:function(c,d,e){var f=b.defer(),c=c||1,d=d||10,e=e||"";return a.post("/snapshots",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getSnapshot:function(c){var d=b.defer();return a.post("/snapshot",{slug:c}).success(function(a){d.resolve(a)}),d.promise},getLatest:function(){var c=b.defer();return a.post("/snapshot/latest",{}).success(function(a){c.resolve(a)}),c.promise},addComment:function(b,c){return a.post("/api/snapshot/comment/add",{snapshotID:b._id,comment:c})},vote:function(b){return a.post("/api/snapshot/vote",{snapshot:b})},setStorage:function(a){return c["metaCom-"]=a},getStorage:function(){return c["metaCom-"]}}}]).factory("AdminTeamService",["$http","$q",function(a,b){return{getMembers:function(){var c=b.defer();return a.post("/api/admin/teams").success(function(a){c.resolve(a)}),c.promise},getMember:function(c){var d=b.defer();return a.post("/api/admin/team",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addMember:function(c){var d=b.defer();return a.post("/api/admin/team/add",{member:c}).success(function(a){d.resolve(a)}),d.promise},editMember:function(c){var d=b.defer();return a.post("/api/admin/team/edit",{member:c}).success(function(a){d.resolve(a)}),d.promise},deleteMember:function(c){var d=b.defer();return a.post("/api/admin/team/remove",{member:c}).success(function(a){d.resolve(a)}),d.promise},updateOrder:function(b){a.post("/api/admin/team/order",{members:b})}}}]).factory("ProfileService",["$http","$q",function(a,b){return{getUserProfile:function(c){var d=b.defer();return a.post("/api/profile/"+c,{}).success(function(a){d.resolve(a)}),d.promise},getProfile:function(c){var d=b.defer();return a.post("/profile/"+c,{}).success(function(a){d.resolve(a)}),d.promise},getActivity:function(c,d,e,f){var g=b.defer(),e=e||1,f=f||20;return a.post("/profile/"+c+"/activity",{length:d,page:e,perpage:f}).success(function(a){g.resolve(a)}),g.promise},getArticles:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/articles",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getDecks:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/decks",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getDecksLoggedIn:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/api/profile/"+c+"/decks",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getGuides:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/guides",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getGuidesLoggedIn:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/api/profile/"+c+"/guides",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},updateProfile:function(b){return a.post("/api/profile/edit",b)},changeEmail:function(c){var d=b.defer(),c=c||!1;return a.post("/api/profile/changeEmail",{code:c}).success(function(a){d.resolve(a)}),d.promise},updateEmail:function(c){var d=b.defer(),c=c||!1;return a.post("/api/profile/updateEmail",{code:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("TokenInterceptor",["$q","$window",function(a,b){return{request:function(a){return a.headers=a.headers||{},"POST"==a.method&&b.sessionStorage.token&&(a.headers.Authorization="Bearer "+b.sessionStorage.token),a},response:function(b){return b||a.when(b)}}}]).factory("AdminCardService",["$http","$q",function(a,b){return{getCards:function(){var c=b.defer();return a.post("/api/admin/cards",{}).success(function(a){c.resolve(a)}),c.promise},getDeckableCards:function(){var c=b.defer();return a.post("/api/admin/cards/deckable",{}).success(function(a){c.resolve(a)}),c.promise},getCard:function(c){var d=b.defer();return a.post("/api/admin/card",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addCard:function(b){return a.post("/api/admin/card/add",b)},deleteCard:function(c){var d=b.defer();return a.post("/api/admin/card/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},editCard:function(b){return a.post("/api/admin/card/edit",b)}}}]).factory("AlertService",function(){var a={},b={},c=!1;return{getSuccess:function(){return a},setSuccess:function(b){a=b,c=!0},getError:function(){return b},setError:function(a){b=a,c=!0},reset:function(){a={},b={},c=!1},hasAlert:function(){return c}}}).factory("AdminArticleService",["$http","$q",function(a,b){return{articleTypes:function(){return[{name:"Tempo Storm",value:"ts"},{name:"Hearthstone",value:"hs"},{name:"Heroes of the Storm",value:"hots"}]},getAllArticles:function(){var c=b.defer();return a.post("/api/admin/articles/all",{}).success(function(a){c.resolve(a)}),c.promise},getArticles:function(c,d,e){var c=c||1,d=d||50,e=e||"",f=b.defer();return a.post("/api/admin/articles",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getArticle:function(c){var d=b.defer();return a.post("/api/admin/article",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addArticle:function(b){return a.post("/api/admin/article/add",b)},editArticle:function(b){return a.post("/api/admin/article/edit",b)},deleteArticle:function(c){var d=b.defer();return a.post("/api/admin/article/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getNames:function(b){return a.post("/api/admin/article/names",b)}}}]).factory("AdminDeckService",["$http","$q",function(a,b){return{getAllDecks:function(){var c=b.defer();return a.post("/api/admin/decks/all",{}).success(function(a){c.resolve(a)}),c.promise},getDecks:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/decks",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getDeck:function(c){var d=b.defer();return a.post("/api/admin/deck",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addDeck:function(b){return a.post("/api/admin/deck/add",b)},editDeck:function(b){return a.post("/api/admin/deck/edit",b)},deleteDeck:function(c){var d=b.defer();return a.post("/api/admin/deck/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminHeroService",["$http","$q",function(a,b){return{getHeroes:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/heroes",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getAllHeroes:function(){var c=b.defer();return a.post("/api/admin/heroes/all",{}).success(function(a){c.resolve(a)}),c.promise},getHero:function(c){var d=b.defer();return a.post("/api/admin/hero",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addHero:function(b){return a.post("/api/admin/hero/add",b)},editHero:function(b){return a.post("/api/admin/hero/edit",b)},deleteHero:function(c){var d=b.defer();return a.post("/api/admin/hero/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminMapService",["$http","$q",function(a,b){return{getMaps:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/maps",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getAllMaps:function(){var c=b.defer();return a.post("/api/admin/maps/all",{}).success(function(a){c.resolve(a)}),c.promise},getMap:function(c){var d=b.defer();return a.post("/api/admin/map",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addMap:function(b){return a.post("/api/admin/map/add",b)},editMap:function(b){return a.post("/api/admin/map/edit",b)},deleteMap:function(c){var d=b.defer();return a.post("/api/admin/map/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminHOTSGuideService",["$http","$q",function(a,b){return{getAllGuides:function(){var c=b.defer();return a.post("/api/admin/guides/all",{}).success(function(a){c.resolve(a)}),c.promise},getGuides:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/guides",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getGuide:function(c){var d=b.defer();return a.post("/api/admin/guide",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addGuide:function(b){return a.post("/api/admin/guide/add",b)},editGuide:function(b){return a.post("/api/admin/guide/edit",b)},deleteGuide:function(c){var d=b.defer();return a.post("/api/admin/guide/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminUserService",["$http","$q",function(a,b){return{getProviders:function(){var c=b.defer();return a.post("/api/admin/users/providers",{}).success(function(a){c.resolve(a)}),c.promise},getUsers:function(c,d,e){var c=c||1,d=d||50,e=e||"",f=b.defer();return a.post("/api/admin/users",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getUser:function(c){var d=b.defer();return a.post("/api/admin/user",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addUser:function(b){return a.post("/api/admin/user/add",b)},editUser:function(b){return a.post("/api/admin/user/edit",b)},deleteUser:function(c){var d=b.defer();return a.post("/api/admin/user/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("PollService",["$http","$q","$localStorage",function(a,b,c){return{getPolls:function(c){var d=b.defer();return a.post("/polls",{view:c}).success(function(a){d.resolve(a)}),d.promise},postVote:function(b,c){return a.post("/polls/vote",{poll:b,votes:c})},setStorage:function(a,b){return c["tspoll-"+a]=b},getStorage:function(a){return c["tspoll-"+a]}}}]).factory("AdminPollService",["$http","$q",function(a,b){return{getPolls:function(c,d,e){var c=c||1,d=d||50,e=e||"",f=b.defer();return a.post("/api/admin/polls",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getPoll:function(c){var d=b.defer();return a.post("/api/admin/poll",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addPoll:function(b){return a.post("/api/admin/poll/add",b)},editPoll:function(b){return a.post("/api/admin/poll/edit",b)},deletePoll:function(c){var d=b.defer();return a.post("/api/admin/poll/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminBannerService",["$http","$q",function(a,b){return{getBanners:function(c,d,e){var f=b.defer();return a.post("/api/admin/banners",{}).success(function(a){f.resolve(a)}),f.promise},getBanner:function(c){var d=b.defer();return a.post("/api/admin/banner",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addBanner:function(b){return a.post("api/admin/banner/add",b)},editBanner:function(b){return a.post("api/admin/banner/edit",b)},deleteBanner:function(c){var d=b.defer();return a.post("/api/admin/banner/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},updateOrder:function(c){b.defer();a.post("/api/admin/banners/order",{banners:c})}}}]).factory("AdminForumService",["$http","$q",function(a,b){return{getCategories:function(){var c=b.defer();return a.post("/api/admin/forum/categories",{}).success(function(a){c.resolve(a)}),c.promise},getCategory:function(c){var d=b.defer();return a.post("/api/admin/forum/category",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addCategory:function(b){return a.post("/api/admin/forum/category/add",b)},editCategory:function(b){return a.post("/api/admin/forum/category/edit",b)},deleteCategory:function(c){var d=b.defer();return a.post("/api/admin/forum/category/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getThreads:function(){var c=b.defer();return a.post("/api/admin/forum/threads",{}).success(function(a){c.resolve(a)}),c.promise},getThread:function(c){var d=b.defer();return a.post("/api/admin/forum/thread",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addThread:function(b){return a.post("/api/admin/forum/thread/add",b)},editThread:function(b){return a.post("/api/admin/forum/thread/edit",b)},deleteThread:function(c,d){var e=b.defer();return a.post("/api/admin/forum/thread/delete",{_id:c,category:d}).success(function(a){e.resolve(a)}),e.promise}}}]).factory("AdminVodService",["$http","$q",function(a,b){return{getVods:function(){var c=b.defer();return a.post("/api/admin/vods").success(function(a){c.resolve(a)}),c.promise},getVod:function(c){var d=b.defer();return a.post("/api/admin/vod",{_id:c}).success(function(a){d.resolve(a)}),d.promise},vodAdd:function(c){var d=b.defer();return a.post("/api/admin/vod/add",{vod:c}).success(function(a){d.resolve(a)}),d.promise},vodEdit:function(c){var d=b.defer();return a.post("/api/admin/vod/edit",{vod:c}).success(function(a){d.resolve(a)}),d.promise},vodRemove:function(c){var d=b.defer();return a.post("/api/admin/vod/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).service("Pagination",function(){var a={};return a["new"]=function(a){a=a||50;var b={page:1,perpage:a};return b.results=function(){return 0},b.pages=function(){return Math.ceil(b.results()/b.perpage)},b.pagesArray=function(){for(var a=[],c=b.pages(),d=1;c>=d;d++)a.push(d);return a},b.pageStart=function(){return b.page*b.perpage-b.perpage},b.showStart=function(){return b.results()?b.pageStart()+1:0},b.showEnd=function(){var a=b.page*b.perpage;return a>b.results()?b.results():a},b.isPage=function(a){return b.page===a},b.setPage=function(a){b.page=a},b},a}).factory("AjaxPagination",[function(){var a={};return a["new"]=function(a,b,c){var d={page:1,perpage:a||10,total:b||0,loading:!1,callback:function(a){this.loading=!1,this.total=a}};return d.isLoading=function(){return d.loading},d.getPage=function(){return d.page},d.getPerpage=function(){return d.perpage},d.getTotal=function(){return d.total},d.setPage=function(a){return d.isLoading()?!1:(d.page=a,d.loading=!0,c(d.page,d.perpage).then(function(a){return d.callback(a)}))},d.pagesArray=function(){var a=[],b=1,c=d.totalPages();this.totalPages()>5&&(d.getPage()<3?(b=1,c=b+4):d.getPage()>d.totalPages()-2?(c=d.totalPages(),b=c-4):(b=d.getPage()-2,c=d.getPage()+2));for(var e=b;c>=e;e++)a.push(e);return a},d.isPage=function(a){return a===d.getPage()},d.totalPages=function(a){return d.getTotal()>0?Math.ceil(d.getTotal()/d.getPerpage()):0},d.from=function(){return d.getPage()*d.getPerpage()-d.getPerpage()+1;
},d.to=function(){return d.getPage()*d.getPerpage()>d.getTotal()?d.getTotal():d.getPage()*d.getPerpage()},d},a}]).factory("Util",["$http",function(a){return{toSelect:function(a){a=a||[];for(var b=[],c=0;c<a.length;c++)b.push({name:a[c],value:a[c]});return b},slugify:function(a){return a?a.toLowerCase().replace(/-+/g,"").replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):""},numberWithCommas:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},getObjectID:function(){return a.post("/api/admin/id",{})}}}]).factory("Base64",function(){for(var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+-",b=a.split(""),c={},d=0;d<b.length;d++)c[b[d]]=d;return{fromInt:function(a){for(var c="";;)if(c=b[63&a]+c,a>>>=6,0===a)break;return c},toInt:function(a){for(var b=0,d=a.split(""),e=0;e<d.length;e++)b=(b<<6)+c[d[e]];return b}}}).factory("Hearthstone",function(){var a={};return a.types=["Minion","Spell","Weapon"],a.rarities=["Basic","Common","Rare","Epic","Legendary"],a.races=["","Beast","Demon","Dragon","Murloc","Pirate","Totem","Mech"],a.classes=["Neutral","Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"],a.heroNames={Mage:["Jaina","Medivh"],Shaman:["Thrall"],Warrior:["Garrosh","Magni"],Rogue:["Valeera"],Paladin:["Uther"],Priest:["Anduin"],Warlock:["Guldan"],Hunter:["Rexxar","Alleria"],Druid:["Malfurion"]},a.mechanics=["Battlecry","Charge","Choose One","Combo","Deathrattle","Divine Shield","Enrage","Freeze","Inspire","Jousting","Overload","Secret","Silence","Spell Damage","Stealth","Summon","Taunt","Windfury"],a.deckTypes=["None","Aggro","Control","Midrange","Combo","Theory Craft"],a.expansions=["Basic","Naxxramas","Goblins Vs. Gnomes","Blackrock Mountain","The Grand Tournament"],a}).factory("HOTS",function(){var a={};return a.roles=["Warrior","Assassin","Support","Specialist"],a.types=["Melee","Ranged"],a.universes=["Warcraft","Starcraft","Diablo","Blizzard"],a.abilityTypes=["Combat Trait","Ability","Heroic Ability","Heroic Skill","Mount"],a.manaTypes=["Mana","Brew","Energy","Fury"],a.tiers=[1,4,7,10,13,16,20],a.heroRows=[9,8,9,8,7],a.mapRows=[5,4],a.genStats=function(){for(var a,b=[],c=0;30>c;c++)a={level:c+1,health:"",healthRegen:"",mana:"",manaRegen:"",attackSpeed:"",range:"",damage:""},b.push(a);return b},a}).factory("DeckBuilder",["$sce","$http","$q",function(a,b,c){var d={};return d["new"]=function(b,c){c=c||{};var d=new Date;d.setMonth(d.getMonth()+1);var e={_id:c._id||null,name:c.name||"",description:c.description||"",deckType:c.deckType||"None",chapters:c.chapters||[],type:c.type||1,basic:c.basic||!1,matches:c.matches||[],cards:c.cards||[],heroName:c.heroName||"",playerClass:b,mulligans:c.mulligans||[{klass:"Mage",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Shaman",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Warrior",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Rogue",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Paladin",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Priest",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Warlock",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Hunter",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Druid",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}}],video:c.video||"",premium:c.premium||{isPremium:!1,expiryDate:d},featured:c.featured||!1,"public":c["public"]||"true"};return e.validVideo=function(){return!0},e.isStrong=function(a){return a.isStrong},e.isWeak=function(a){return a.isWeak},e.toggleStrong=function(a){a.isStrong=!a.isStrong},e.toggleWeak=function(a){a.isWeak=!a.isWeak},e.getStrong=function(a){for(var b=e.against.strong,c=0;c<b.length;c++)if(b[c].klass===a)return b[c];return!1},e.getWeak=function(a){for(var b=e.against.weak,c=0;c<b.length;c++)if(b[c].klass===a)return b[c];return!1},e.inMulligan=function(a,b,c){for(var d=b?a.withCoin.cards:a.withoutCoin.cards,e=0;e<d.length;e++)if(d[e]._id===c._id)return!0;return!1},e.toggleMulligan=function(a,b,c){for(var d=b?a.withCoin.cards:a.withoutCoin.cards,e=!1,f=-1,g=0;g<d.length;g++)if(d[g]._id===c._id){e=!0,f=g;break}e?d.splice(f,1):d.length<6&&d.push(c)},e.getMulligan=function(a){for(var b=e.mulligans,c=0;c<b.length;c++)if(b[c].klass===a)return b[c];return!1},e.getContent=function(){return a.trustAsHtml(e.content)},e.isAddable=function(a){for(var b=!1,c=-1,d="Legendary"===a.rarity?!0:!1,f=0;f<e.cards.length;f++)if(e.cards[f]._id===a._id){b=!0,c=f;break}return b?!d&&(1===e.cards[c].qty||e.arena):!0},e.addCard=function(a){for(var b=!1,c=-1,d="Legendary"===a.rarity?!0:!1,f=0;f<e.cards.length;f++)if(e.cards[f]._id===a._id){b=!0,c=f;break}b?d||1!==e.cards[c].qty&&!e.arena||(e.cards[c].qty=e.cards[c].qty+1):(e.cards.push({_id:a._id,cost:a.cost,name:a.name,cardType:a.cardType,dust:a.dust,photos:{small:a.photos.small,medium:a.photos.medium,large:a.photos.large},legendary:d,qty:1}),e.sortDeck())},e.sortDeck=function(){function a(a){return function(b,d){if("cardType"==a){if(c[b[a]]<c[d[a]])return-1;if(c[b[a]]>c[d[a]])return 1}else{if(b[a]<d[a])return-1;if(b[a]>d[a])return 1}return 0}}function b(){var b=arguments;return function(c,d){for(var e=0,f=0;0===f&&e<b.length;)f=a(b[e])(c,d),e++;return f}}var c={Weapon:0,Spell:1,Minion:2};e.cards.sort(b("cost","cardType","name"))},e.removeCardFromDeck=function(a){for(var b=0;b<e.cards.length;b++)if(a._id==e.cards[b]._id)if(e.cards[b].qty>1)e.cards[b].qty=e.cards[b].qty-1;else{var c=e.cards.indexOf(e.cards[b]);e.cards.splice(c,1)}},e.removeCard=function(a){if(a.qty>1)a.qty=a.qty-1;else{var b=e.cards.indexOf(a);e.cards.splice(b,1)}},e.manaCurve=function(a){for(var b,c=0,d=0;7>=d;d++)b=e.manaCount(d),b>c&&(c=b);return 0===c?0:Math.ceil(e.manaCount(a)/c*100)},e.manaCount=function(a){for(var b=0,c=0;c<e.cards.length;c++)(e.cards[c].cost===a||7===a&&e.cards[c].cost>=7)&&(b+=e.cards[c].qty);return b},e.getSize=function(){for(var a=0,b=0;7>=b;b++)a+=e.manaCount(b);return a},e.getDust=function(){for(var a=0,b=0;b<e.cards.length;b++)a+=e.cards[b].qty*e.cards[b].dust;return a},e.validDeck=function(){if(30!==e.getSize())return!1;if(!e.arena)for(var a=0;a<e.cards.length;a++)if(e.cards[a].qty>2)return!1;return!0},e.moveChapterUp=function(a){var b=e.chapters.indexOf(a),c=b-1;return 0>c?!1:(e.chapters.splice(b,1),void e.chapters.splice(c,0,a))},e.moveChapterDown=function(a){var b=e.chapters.indexOf(a),c=b+1;return 0>c?!1:(e.chapters.splice(b,1),void e.chapters.splice(c,0,a))},e.addChapter=function(){e.chapters.push({title:"",content:""})},e.removeChapter=function(a){e.chapters.splice(a,1)},e.newMatch=function(a){var b={deckName:"",klass:"",match:0};b.klass=a,e.matches.push(b)},e.removeMatch=function(a){e.matches.splice(a,1)},e},d.loadCards=function(a,d,e,f,g,h){var i=c.defer();return b.post("/deckbuilder",{page:a,perpage:d,search:e,mechanics:f,mana:g,playerClass:h}).success(function(a){i.resolve(a)}),i.promise},d.saveDeck=function(a){return b.post("/api/deck/add",{name:a.name,deckType:a.deckType,description:a.description,chapters:a.chapters,matches:a.matches,type:a.type,basic:a.basic,cards:a.cards,heroName:a.heroName,playerClass:a.playerClass,mulligans:a.mulligans,video:a.video,premium:a.premium,featured:a.featured,"public":a["public"]})},d.updateDeck=function(a){return b.post("/api/deck/update",{_id:a._id,name:a.name,deckType:a.deckType,description:a.description,chapters:a.chapters,matches:a.matches,type:a.type,basic:a.basic,cards:a.cards,heroName:a.heroName,playerClass:a.playerClass,mulligans:a.mulligans,video:a.video,premium:a.premium,featured:a.featured,"public":a["public"]})},d}]).factory("GuideBuilder",["$sce","$http","$q",function(a,b,c){var d={};return d["new"]=function(b,c){c=c||{};var d=new Date;d.setMonth(d.getMonth()+1);var e={_id:c._id||null,name:c.name||"",slug:c.slug||"",guideType:b,description:c.description||"",content:c.content||[],heroes:c.heroes||[],maps:c.maps||[],synergy:c.synergy||[],against:c.against||{strong:[],weak:[]},video:c.video||"",premium:c.premium||{isPremium:!1,expiryDate:d},featured:c.featured||!1,"public":c["public"]?c["public"].toString():"true"};return"map"===b&&e.maps.length>1&&(e.maps=[e.maps[0]]),e.validVideo=function(){return!0},e.getContent=function(b){return a.trustAsHtml(b)},e.moveContentUp=function(a){var b=e.content.indexOf(a),c=b-1;return 0>c?!1:(e.content.splice(b,1),void e.content.splice(c,0,a))},e.moveContentDown=function(a){var b=e.content.indexOf(a),c=b+1;return c>e.content.length-1?!1:(e.content.splice(b,1),void e.content.splice(c,0,a))},e.toggleHero=function(a){if(e.hasHero(a)){for(var b=0;b<e.heroes.length;b++)if(e.heroes[b].hero._id===a._id)return e.heroes.splice(b,1),!0}else{if(5===e.heroes.length)return!1;var c={};c.hero=a,c.talents={tier1:null,tier4:null,tier7:null,tier10:null,tier13:null,tier16:null,tier20:null},e.heroes.push(c)}},e.hasHero=function(a){if(!a)return!1;for(var b=0;b<e.heroes.length;b++)if(e.heroes[b].hero._id===a._id)return!0;return!1},e.hasAnyHero=function(){return e.heroes.length},e.tiers=function(){return[1,4,7,10,13,16,20]},e.talentsByTier=function(a,b){for(var c=[],d=0;d<a.talents.length;d++)a.talents[d].tier===b&&c.push(a.talents[d]);return c},e.toggleTalent=function(a,b){e.hasTalent(a,b)?a.talents["tier"+b.tier]=null:a.talents["tier"+b.tier]=b._id},e.hasAnyTalent=function(a,b){return null!==a.talents["tier"+b.tier]},e.allTalentsDone=function(){for(var a=0;a<e.heroes.length;a++)if(null===e.heroes[a].talents.tier1||null===e.heroes[a].talents.tier4||null===e.heroes[a].talents.tier7||null===e.heroes[a].talents.tier10||null===e.heroes[a].talents.tier13||null===e.heroes[a].talents.tier16||null===e.heroes[a].talents.tier20)return!1;return!0},e.hasTalent=function(a,b){return a.talents["tier"+b.tier]==b._id},e.toggleSynergy=function(a){if(e.hasSynergy(a)){for(var b=0;b<e.synergy.length;b++)if(e.synergy[b]===a._id)return e.synergy.splice(b,1),!0}else e.synergy.push(a._id)},e.hasSynergy=function(a){for(var b=0;b<e.synergy.length;b++)if(e.synergy[b]===a._id)return!0;return!1},e.toggleStrong=function(a){if(e.hasStrong(a)){for(var b=0;b<e.against.strong.length;b++)if(e.against.strong[b]===a._id)return e.against.strong.splice(b,1),!0}else e.against.strong.push(a._id)},e.hasStrong=function(a){for(var b=0;b<e.against.strong.length;b++)if(e.against.strong[b]===a._id)return!0;return!1},e.toggleWeak=function(a){if(e.hasWeak(a)){for(var b=0;b<e.against.weak.length;b++)if(e.against.weak[b]===a._id)return e.against.weak.splice(b,1),!0}else e.against.weak.push(a._id)},e.hasWeak=function(a){for(var b=0;b<e.against.weak.length;b++)if(e.against.weak[b]===a._id)return!0;return!1},e.hasAnyChapter=function(){return e.content.length},e.hasAnyMap=function(){return e.maps.length},e.setMap=function(a){e.maps=[a._id]},e.toggleMap=function(a){if(e.hasMap(a)){for(var b=0;b<e.maps.length;b++)if(e.maps[b]===a._id)return e.maps.splice(b,1),!0}else e.maps.push(a._id)},e.hasMap=function(a){for(var b=0;b<e.maps.length;b++)if(e.maps[b]===a._id)return!0;return!1},e.addContent=function(){e.content.push({title:"NEW CHAPTER",body:""})},e.deleteContent=function(a){var b=e.content.indexOf(a);-1!==b&&e.content.splice(b,1)},e},d.saveGuide=function(a){return b.post("/api/guide/add",a)},d.updateGuide=function(a){return b.post("/api/guide/update",a)},d}]).factory("DeckService",["$http","$q",function(a,b){return{getDecksCommunity:function(c,d,e,f){c=c||!1,d=d||1,e=e||24,f=f||!1;var g=b.defer();return a.post("/decks/community",{klass:c,page:d,perpage:e,search:f}).success(function(a){g.resolve(a)}),g.promise},getDecksFeatured:function(c,d,e,f){c=c||!1,d=d||1,e=e||24,f=f||!1;var g=b.defer();return a.post("/decks/featured",{klass:c,page:d,perpage:e,search:f}).success(function(a){g.resolve(a)}),g.promise},getDecks:function(c,d,e,f,g,h){c=c||"all",d=d||1,e=e||24,f=f||"",g=g||"all",h=h||"high";var i=b.defer();return a.post("/decks",{klass:c,page:d,perpage:e,search:f,age:g,order:h}).success(function(a){i.resolve(a)}),i.promise},getDeck:function(c){var d=b.defer();return a.post("/deck",{slug:c}).success(function(a){d.resolve(a)}),d.promise},deckEdit:function(c){var d=b.defer();return a.post("/api/deck",{slug:c}).success(function(a){d.resolve(a)}),d.promise},deckDelete:function(b){return a.post("/api/deck/delete",{_id:b})},addComment:function(b,c){return a.post("/api/deck/comment/add",{deckID:b._id,comment:c})}}}]).factory("HOTSGuideService",["$http","$q",function(a,b){return{getGuidesCommunity:function(c,d,e,f,g){c=c||!1,d=d||0,e=e||10,f=f||!1,g=g||!1;var h=b.defer();return a.post("/hots/guides/community",{filters:c,offset:d,perpage:e,search:f,daysLimit:g}).success(function(a){h.resolve(a)}),h.promise},getGuidesFeatured:function(c,d,e,f){c=c||!1,d=d||0,e=e||10,f=f||!1;var g=b.defer();return a.post("/hots/guides/featured",{filters:c,offset:d,perpage:e,search:f}).success(function(a){g.resolve(a)}),g.promise},getGuides:function(c,d,e,f,g){c=c||"all",d=d||!1,e=e||1,f=f||24,g=g||"";var h=b.defer();return a.post("/hots/guides",{guideType:c,filters:d,page:e,perpage:f,search:g}).success(function(a){h.resolve(a)}),h.promise},getGuide:function(c){var d=b.defer();return a.post("/hots/guide",{slug:c}).success(function(a){d.resolve(a)}),d.promise},getMaps:function(){var c=b.defer();return a.post("/hots/maps",{}).success(function(a){c.resolve(a)}),c.promise},guideEdit:function(c){var d=b.defer();return a.post("/api/hots/guide",{slug:c}).success(function(a){d.resolve(a)}),d.promise},addGuide:function(b){return a.post("/api/hots/guide/add",b)},editGuide:function(b){return a.post("/api/hots/guide/update",b)},guideDelete:function(b){return a.post("/api/hots/guide/delete",{_id:b})},addComment:function(b,c){return a.post("/api/hots/guide/comment/add",{guideID:b._id,comment:c})}}}]).factory("HeroService",["$http","$q",function(a,b){return{getHeroesList:function(){var c=b.defer();return a.post("/hots/heroes/list",{}).success(function(a){c.resolve(a)}),c.promise},getHeroes:function(){var c=b.defer();return a.post("/hots/heroes",{}).success(function(a){c.resolve(a)}),c.promise},getHero:function(c){var d=b.defer();return a.post("/hots/hero",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getHeroByClass:function(c){var d=b.defer();return a.post("/hots/hero/class",{hero:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("VoteService",["$http","$q",function(a,b){return{voteArticle:function(c){var d=b.defer();return a.post("/api/article/vote",{_id:c._id}).success(function(a){d.resolve(a)}),d.promise},voteSnapshot:function(c,d){var e=b.defer();return a.post("/api/snapshot/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise},voteDeck:function(c,d){var e=b.defer();return a.post("/api/deck/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise},voteGuide:function(c,d){var e=b.defer();return a.post("/api/hots/guide/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise},voteComment:function(c,d){var e=b.defer();return a.post("/api/comment/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise}}}]).factory("ForumService",["$http","$q",function(a,b){return{getCategories:function(){var c=b.defer();return a.post("/forum",{}).success(function(a){c.resolve(a)}),c.promise},getThread:function(c){var d=b.defer();return a.post("/forum/thread",{thread:c}).success(function(a){d.resolve(a)}),d.promise},getPost:function(c,d){var e=b.defer();return a.post("/forum/post",{thread:c,post:d}).success(function(a){e.resolve(a)}),e.promise},addPost:function(b,c){return a.post("/api/forum/post/add",{thread:b,post:c})},addComment:function(b,c){return a.post("/api/forum/post/comment/add",{post:b,comment:c})}}}]).factory("ImgurService",["$http","$q",function(a,b){return{upload:function(c){var d=b.defer(),e=new FormData;return e.append("file",c),a.post("/upload",e).success(function(a){d.resolve(a)}),d.promise}}}]).factory("BannerService",["$http","$q",function(a,b){return{getBanners:function(c){var d=b.defer(),c=c||"ts";return a.post("/banners",{bannerType:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("TwitchService",["$http","$q",function(a,b){return{getStreams:function(){var c=b.defer();return a.post("/twitchFeed",{limit:50}).success(function(a){c.resolve(a)}),c.promise}}}]).factory("TwitterService",["$http","$q",function(a,b){return{getFeed:function(){var c=b.defer();return a.post("/twitterFeed",{limit:6}).success(function(a){c.resolve(a)}),c.promise}}}]).factory("ContactService",["$http","$q",function(a,b){return{sendContact:function(b){return a.post("/api/contact/send",{contact:b})}}}]).factory("TeamService",["$http","$q",function(a,b){return{getMembers:function(c){var d=b.defer();return a.post("/team",{gm:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("VodService",["$http","$q",function(a,b){return{getLatestVod:function(){var c=b.defer();return a.post("/vod").success(function(a){c.resolve(a)}),c.promise}}}]).factory("markitupSettings",[function(){var a,b;return b=[],a={},a.create=function(a){return{afterInsert:a,previewParserPath:"",markupSet:b}},a}]);