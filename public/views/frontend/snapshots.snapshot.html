<div class="bg-override container-fluid">
    
    <div class="container wrapper-none heading">
        <div class="snapTitle">
            <h1>THE META SNAPSHOT: #{{snapshot.snapNum}}</h1>
            <h3>{{snapshot.title}}</h3>

            
            
        </div>
        <div class="snapshot-votes pull-right clearfix"> 
                
                <span class="snapVoteWrap">
                    <div class="vote-count vote-large m-l-sm pull-right">
                        {{snapshot.votesCount}}
                    </div>
                    <a ng-if="app.user.isLogged() && !hasVoted" class="btn-vote-up vote-large" ng-click="voteSnapshot()"><p><i class="fa fa-thumbs-up"></i></p></a>
                </span>
            </div>
        <img class="sideBorders img-responsive head-img" src="../../img/meta-snapshot/generic-meta.jpg" />
    </div>
    <div class="container meta-container sideBorders">
        <div class="m-t-md">
            
            <div class="row no-pad clearfix">

                <div class="col-xs-12 col-lg-push-8 col-lg-4 rightSide clearfix m-b-md">
                    <div class="sideTier" ng-repeat="tier in snapshot.tiers">
                        <button ng-click="show[tier.tier] = !show[tier.tier]" class="btn-block sideTier" role="button" data-toggle="collapse" href="#collapseSideTier{{tier.tier}}" aria-expanded="false" aria-controls="collapseSideTier{{tier.tier}}">
                            <div class="sideTierHead">
                                <div class="inner">
                                    <h3 class="pull-left m-b-none">Tier {{tier.tier}}</h3>

                                    <i class="fa" ng-class="{ 'fa-plus' : !show[tier.tier], 'fa-minus' : show[tier.tier] }"></i>
                                </div>
                            </div>
                        </button>
                        <div class="sideTierBody collapse" id="collapseSideTier{{tier.tier}}">
                            <div class="sideTierDeck deck-portrait-{{deck.deck.playerClass}}-sm" ng-repeat="deck in tier.decks">
                                <a href="#{{deck.rank.current}}" ng-click="findDeck(tier.tier, deck.rank.current)">
                                    <div class="sideTierDeckRank pull-left clearfix">
                                        <h4>{{deck.rank.current}}</h4>
                                    </div>
                                    <div class="sideTierDeckName pull-left clearfix">
                                        <h4 class="ell">{{deck.deck.name}}</h4>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-xs-12 col-lg-pull-4 col-lg-8 leftSide m-b-md">
                    <div class="content intro m-b-md">
                        <div class="inner wrapper-md">
                            <div class="clearfix">
                                <h2>
                                    INTRODUCTION
                                </h2>
                                <hr class="hr pull-left m-b-md m-t-xs">
                            </div>
                            <p>{{snapshot.content.intro}}</p>
                        </div>
                    </div>

                    <div class="content thoughts">
                        <div class="inner wrapper-md">
                            <div class="clearfix">
                                <h2>
                                    THOUGHTS AND OBSERVATIONS
                                </h2>
                                <hr class="hr pull-left m-b-md m-t-xs">
                            </div>
                            <p>{{snapshot.content.thoughts}}</p>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <div class="row no-pad m-b-md">
            <div class="col-lg-12 trends-wrapper">
                    
                
            <trend-chart snapshot="snapshot" />
                    
<!--
                    <svg class="trends">
                        <svg class="trend-view" height="350" width="95%" x="2.5%" y="75" style="overflow: hidden">
                            <svg id="animateChart" class="trend-wrapper" height="100%" width="100%" ng-attr-y="{{getView()+5}}">
                                <svg ng-repeat="tier in sortedDecks" width="100%" height="100%" ng-attr-y="{{-(350*$index)}}">
                                    <svg ng-repeat="deck in tier" width="100%" ng-attr-height="{{100/tier.length}}%" ng-attr-y="{{(100/tier.length)*$index}}%">
                                        
                                        {{log(sortedDecks)}}
                                        <circle ng-repeat="plot in deck.rank.last track by $index" class="dot-{{deck.deck.playerClass}}" ng-attr-cy="{{(100/tier.length)}}%" ng-attr-cx="{{100*($index+1)}}" r="5" stroke-width="3" fill="none"></circle>
                                        <line x1="2.5%" y1="5" x2="100%"  y2="5" style="stroke:rgba(255,255,255,.5)"/>
                                        <text height="15" x="10" y="10" fill="white">{{($index+1)}}</text>
                                        <circle ng-repeat="deck in trends[$parent.$index] track by $index" ng-attr-cx="{{7.92*($index+1)}}%" cy="5" r="5" class="dot-{{deck.deck.playerClass}}" stroke-width="3" fill="none"></circle>
                                    </svg>
                                </svg>
                            </svg>
                            
                            <svg>
                                <line x1="0" y1="0%"   x2="100%"  y2="0%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="10%"  x2="100%"  y2="10%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="20%"  x2="100%"  y2="20%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="30%"  x2="100%"  y2="30%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="40%"  x2="100%"  y2="40%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="50%"  x2="100%"  y2="50%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="60%"  x2="100%"  y2="60%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="70%"  x2="100%"  y2="70%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="80%"  x2="100%"  y2="80%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="90%"  x2="100%"  y2="90%" style="stroke:rgba(255,0,0,.3)"/>
                                <line x1="0" y1="100%" x2="100%"  y2="100%" />
                                <line x1="1.1%" y1="100%" x2="1.1%" y2="0" />
                            </svg>
                            
                        </svg>
                        
                        
                            
                            
                        <svg y="100">
                            <g ng-repeat="tier in snapshot.tiers" ng-click="setView(tier.tier-1)" cursor="pointer"><text height="30" x="30" ng-attr-y="{{30*$index}}" fill="red">{{tier.tier}}</text></g>
                        </svg>
                    </svg>
-->
                </div>
            </div>
            
            
            <!-- TIERS -->
            <div class="tiers m-b-md">
                <div id="tier{{tier.tier}}" ng-repeat="tier in snapshot.tiers" class="tier clearfix">
                    <button class="btn btn-block btn-tier-collapse" role="button" data-toggle="collapse" href="#collapseTier{{tier.tier}}" aria-expanded="false" aria-controls="collapseTier{{tier.tier}}">
                        <div class="tier-heading clearfix">
                            <h2 class="pull-left">TIER {{tier.tier}}</h2>
                        </div>
                    </button>

                    <div class="tier-body collapse" id="collapseTier{{tier.tier}}">
                        <div id="deck{{deck.rank.current}}" ng-repeat="deck in tier.decks | orderBy : 'rank.current'" class="tier-deck tier-deck-{{deck.deck.playerClass}}">
                            <div class="tier-deck-heading deck-portrait-{{deck.deck.playerClass}}-sm clearfix" role="button" data-toggle="collapse" href="#collapseDeck-{{deck.rank.current}}" aria-expanded="false" aria-controls="collapseDeck-{{deck.rank.current}}">
                                <h4>{{deck.deck.name}}</h4>
                                <button class="deck-button" ng-click="goToDeck($event, deck.deck.slug)">VIEW<span class="hidden-xs"> DECK</span></button>
                            </div>
                            <div class="tier-deck-body collapse" id="collapseDeck-{{deck.rank.current}}">
                                <div class="tier-deck-body-inner">
                                    <div class="row tier-deck-body-inner-inner m-l-none m-r-none">

                                        <div class="col-xs-12 col-md-push-4 col-md-8 col-lg-push-3 col-lg-9 m-b-md">
                                            <div class="deck-content">
                                                <h2>EXPLANATION</h2>
                                                <p>{{deck.explanation}}</p>

                                                <hr class="m-b-lg">

                                                <h2>WEEKLY NOTES</h2>
                                                <p>{{deck.weeklyNotes}}</p>
                                            </div>
                                            <span ng-if="tier.tier < 3">
                                            <hr class="m-b-lg">
                                                <h2 class="m-b-lg">MATCH-UPS<span ng-if="matchupName[deck.deck._id]"> - {{matchupName[deck.deck._id]}}</span></h2>
                                                <div class="match-graph m-t-md m-b-md">
                                                    <svg class="graph-wrapper" height="100%" width="100%">
                                                        <text x="1.5%" y="0%" fill="white">100</text>
                                                        <text x="2.5%" y="10%" fill="white">90</text>
                                                        <text x="2.5%" y="20%" fill="white">80</text>
                                                        <text x="2.5%" y="30%" fill="white">70</text>
                                                        <text x="2.5%" y="40%" fill="white">60</text>
                                                        <text x="2.5%" y="50%" fill="white">50</text>
                                                        <text x="2.5%" y="60%" fill="white">40</text>
                                                        <text x="2.5%" y="70%" fill="white">30</text>
                                                        <text x="2.5%" y="80%" fill="white">20</text>
                                                        <text x="2.5%" y="90%" fill="white">10</text>
                                                        <text x="3.5%" y="100%" fill="white">0</text>


                                                        <svg class="pull-right" height="100%" width="95%" x="5%">
                                                            <line x1="0" y1="0%"   x2="100%"  y2="0%" />
                                                            <line x1="0" y1="10%"  x2="100%"  y2="10%" />
                                                            <line x1="0" y1="20%"  x2="100%"  y2="20%" />
                                                            <line x1="0" y1="30%"  x2="100%"  y2="30%" />
                                                            <line x1="0" y1="40%"  x2="100%"  y2="40%" />
                                                            <line x1="0" y1="50%"  x2="100%"  y2="50%" style="stroke:rgba(255,0,0,.3)"/>
                                                            <line x1="0" y1="60%"  x2="100%"  y2="60%" />
                                                            <line x1="0" y1="70%"  x2="100%"  y2="70%" />
                                                            <line x1="0" y1="80%"  x2="100%"  y2="80%" />
                                                            <line x1="0" y1="90%"  x2="100%"  y2="90%" />
                                                            <line x1="0" y1="100%" x2="100%"  y2="100%" />
                                                            <line x1="1.1%" y1="100%" x2="1.1%" y2="0" />

                                                            <svg height="100%" width="98%" x="1.5%">
                                                                <svg class="bar-wrap" ng-repeat="match in filtered = (getMatches(deck.deck._id) | orderBy: 'playerClass')" ng-mouseover="setMouseOver(deck.deck._id, match.against, match.name)" ng-mouseleave="setMouseOver(deck.deck._id, false)" ng-class="{ 'no-mouse' : getMouseOver(deck.deck._id) != false && getMouseOver(deck.deck._id) != match.against }">
                                                                    <rect class="bar bar-{{match.playerClass}}" ng-attr-width="{{(100/filtered.length)-.8}}%" ng-attr-height="{{100-match.chance}}%" ng-attr-x="{{(100/filtered.length)*$index}}%" ng-attr-y="{{match.chance}}%">
                                                                    <text x="0" y="0" width="150" height="40" fill="red">{{match.name}}</text>
                                                                </svg>
<!--                                                                    <title>{{match.name}}</title>-->
                                                                </rect>
                                                            </svg>
                                                        </svg>
                                                    </svg>
                                                </div>
                                            </span>
                                        </div>
                                        
                                        <div class="col-xs-12 col-md-pull-8 col-md-4 col-lg-pull-9 col-lg-3 m-b-md">
                                            <div class="deck-portrait deck-portrait-{{deck.deck.playerClass}} hidden-xs hidden-sm"></div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-6 col-md-12 col-lg-12">
                                                    <h3 class="m-b-lg">RANKING</h3>
                                                    <div class="deck-rank m-b-lg">
                                                <div class="{{(deck.rank.current <= deck.rank.last[0]) ? 'green-back' : 'red-back'}}">
                                                    <div>
                                                        CURRENT
                                                    </div>
                                                    {{deck.rank.current}}
                                                </div>
                                                <div class="{{(deck.rank.last[0] >= deck.rank.current) ? 'green-back' : 'red-back'}}">
                                                    <div>
                                                        LAST WEEK
                                                    </div>
                                                    {{deck.rank.last[0]}}
                                                </div>
                                                <div class="{{(deck.rank.last[0] - deck.rank.current) >= 0 ? 'green-back' : 'red-back'}}">
                                                    <div>
                                                        CHANGE
                                                    </div>
                                                    {{deck.rank.last[0] - deck.rank.current}}
                                                </div>
                                            </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-6 col-md-12 col-lg-12">
                                                    <div class="deck-techs" ng-if="deck.tech.length">
                                                        <h3 class="m-b-lg">TECH DECISION</h3>
                                                        <div class="tech" ng-repeat="tech in deck.tech">
                                                            <div class="tech-heading">
                                                                <span ng-if="tech.title">
                                                                    VERSUS {{tech.title}}
                                                                </span>
                                                                <span ng-if="!tech.title">
                                                                    GENERAL
                                                                </span>
                                                            </div>
                                                            <div class="tech-card" ng-repeat="card in tech.cards">
                                                                <div class="tech-card-body" ng-class="{ 'multi' : card.both }" style="background-image: url('https://s3-us-west-2.amazonaws.com/ts-node2/cards/{{card.card.photos.small}}')">
                                                                    <div class="pull-left toss" ng-if="!card.toss"><i class="fa fa-plus"></i></div>
                                                                    <div class="pull-left keep" ng-if="card.toss"><i class="fa fa-minus"></i></div>
                                                                    {{card.card.name}}
                                                                </div>
                                                                <div ng-if="card.both" class="both-token">
                                                                    2
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /TIERS -->
            
            <!-- AUTHORS -->
            <div class="row m-l-none m-r-none m-b-md">
                <div class="meta-author col-lg-12" ng-repeat="author in snapshot.authors" >
                    <button type="button" data-toggle="collapse" data-target="#{{author.user._id}}" aria-expanded="false" aria-controls="{{author.user._id}}">
                        <div class="pull-left">
                            <div class="author-img-wrapper pull-left">
                                <img ng-if="author.klass.length === 1" class="author-class-icon m-l-sm" ng-src="../../img/meta-snapshot/class-icons/{{author.klass[0]}}.png" />
                                <span ng-if="author.klass.length > 1">
                                    <img class="author-class-icon" ng-repeat="ico in author.klass" src="../../img/meta-snapshot/class-icons/{{ico}}.png" style="left: {{((author.klass.length-1)*23)-(23*$index)}}px;" />
                                </span>
                            </div>
                            <div class="author-text-wrapper">
                                <h2 class="m-b-xs" ng-class=" { 'm-t-sm' : author.klass.length > 0 } ">{{author.username}}</h2>
                                <span ng-if="author.klass.length === 1">
                                    <h3>{{author.klass[0]}} EXPERT</h3>
                                </span>
                                <h3 ng-if="author.klass.length > 1">
                                    <span ng-repeat="klass in author.klass">
                                        <span ng-if="$index > 0">AND</span> {{klass}}
                                    </span>
                                    EXPERT
                                </h3>
                            </div>
                        </div>
                        <span class="soc-btns pull-right m-r-lg">
                            <a ng-if="author.user.social.twitch != ''" class="btn twitch-btn soc-btn" href="http://{{author.user.social.twitch}}" target="_blank"><i class="fa fa-twitch"></i></a>
                            <a ng-if="author.user.social.twitch === ''" class="btn twitch-btn soc-btn disable" target="_blank" disabled><i class="fa fa-twitch"></i></a>
                            <a ng-if="author.user.social.twitter != ''" class="btn twitter-btn soc-btn" href="https://twitter.com/{{author.user.social.twitter}}" target="_blank"><i class="fa fa-twitter"></i></a>
                            <a ng-if="author.user.social.twitter === ''" class="btn twitter-btn soc-btn disable" target="_blank" disabled><i class="fa fa-twitter"></i></a>
                        </span>
                    </button>
                    
                    <div class="author-collapse collapse" id="{{author.user._id}}">
                        <p> {{author.description}} </p>
                    </div>
                </div>
            </div>
            <!-- /AUTHORS -->
            
            
            <!-- comments -->
            <div class="row">
                <div class="snapshot-section col-lg-12">
                    <div class="snapshot-section-title clearfix">
                        <a href="#" ng-click="show.comments = !show.comments"><h3 class="pull-left">COMMENTS</h3></a>
                        <div class="m-l-md m-r-md pull-right">
                            <a href="#" ng-click="show.comments = !show.comments">
                                <i class="fa" ng-class="{ 'fa-angle-down': !show.comments, 'fa-angle-up': show.comments }"></i>
                            </a>
                        </div>
                    </div>
                    <div class="snapshot-section-content" ng-show="show.comments">
                        <div class="snapshot-comments">
                            <div class="comments">
                                <p class="no-comments" ng-if="!snapshot.comments || !snapshot.comments.length">There are currently no comments on this Meta Snapshot.</p>
                                <div class="comment" ng-repeat="comment in snapshot.comments">
                                    <div class="avatar">
                                        <a href="./user/{{comment.author.username}}"><img gravatar-src-once="comment.author.email" alt="" /></a>
                                    </div>
                                    <div class="panel">
                                        <div class="panel-heading pos-rl clearfix">
                                            <span class="arrow left"></span>
                                            <a href="./user/{{comment.author.username}}">@{{comment.author.username}}</a>
                                            <div class="pull-right">
                                                <div class="comment-votes m-l-sm pull-right clearfix">
                                                    <div class="vote-count vote-small m-l-xs pull-right"><span><em ng-show="comment.votesCount > 0">+</em>{{comment.votesCount}}</span></div>
                                                    <div class="vote-count-btns vote-small pull-left">
                                                        <a href="#" class="btn-vote-up vote-small" ng-class="{active: comment.voted === 1}" ng-click="voteComment(1, comment)"><i class="fa fa-plus-square"></i></a>
                                                        <a href="#" class="btn-vote-down vote-small" ng-class="{active: comment.voted === -1}" ng-click="voteComment(-1, comment)"><i class="fa fa-minus-square"></i></a>
                                                    </div>
                                                </div>
                                                <div class="comment-ago hidden-xs">
                                                    <span class="fa fa-clock-o"></span>
                                                    <span am-time-ago="comment.createdDate"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel-body">{{comment.comment}}</div>
                                    </div>
                                </div>
                                <div class="comment-add">
                                    <div class="avatar">
                                        <a href="./user/{{app.user.getUsername()}}" ng-if="app.user.isLogged()"><img gravatar-src="app.user.getUserEmail()" alt="" /></a>
                                        <a href="#" ng-if="!app.user.isLogged()"><img ng-src="{{app.cdn}}img/profile.jpg" alt="" /></a>
                                    </div>
                                    <form class="form-horizontal" name="commentForm" novalidate>
                                        <div class="input-group">
                                            <input type="text" class="form-control input-dark" ng-model="comment.comment" placeholder="ADD A COMMENT" required>
                                            <span class="input-group-btn">
                                                <button type="submit" class="btn btn-default input-dark" ng-disabled="commentForm.$invalid" ng-click="commentPost()">POST</button>
                                            </span>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- / commments -->

            
        </div>

    </div>
</div>