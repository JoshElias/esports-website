"use strict";angular.module("app.animations",["ngAnimate"]).animation(".slide-animation",function(){return{addClass:function(a,b,c){var d=a.scope();if("active"==b){a.addClass("active");var e=a.parent().width();"right"!==d.banner.direction&&(e=-e),a.css({left:e}),a.find(".banner-panel").css({left:e}),TweenMax.to(a,1,{left:0,ease:Power2.easeInOut},c),TweenMax.to(a.find(".banner-panel"),1.2,{left:"0px",ease:Back.easeOut})}else c()},beforeRemoveClass:function(a,b,c){var d=a.scope();if("active"==b){var e=a.parent().width();"right"===d.banner.direction&&(e=-e),TweenMax.to(a,1,{left:e,ease:Power2.easeInOut},c),TweenMax.to(a.find(".banner-panel"),1.2,{left:e,ease:Back.easeOut})}else c()}}});var app=angular.module("app",["angularFileUpload","summernote","angular-bootbox","angularMoment","angularPayments","dndLists","ngAnimate","ngCookies","ngStorage","ngSanitize","ngProgress","ui.router","ui.load","ui.jq","ui.validate","ui.date","ui.gravatar","app.controllers","app.services","app.filters","app.directives","app.animations"]).run(["$rootScope","$state","$stateParams","$window","$http","$q","AuthenticationService","UserService","$location","ngProgress","MetaService","$cookies","$localStorage",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.$state=b,a.$stateParams=c,a.metaservice=k,a.$on("$stateChangeStart",function(a,c,e,f,h){c.redirectTo&&(a.preventDefault(),b.go(c.redirectTo,e)),c.access&&c.access.noauth&&d.sessionStorage.token&&g.isLogged()&&(a.preventDefault(),b.transitionTo("app.home")),c.access&&c.access.auth&&!d.sessionStorage.token&&!g.isLogged()&&(a.preventDefault(),b.transitionTo("app.login")),c.access&&c.access.admin&&!g.isAdmin(),d.scrollTo(0,0)}),a.$on("$stateChangeSuccess",function(b,c,e,f,g){a.metaservice.setStatusCode(200),d.ga("send","pageview",i.path()),c.seo&&a.metaservice.set(c.seo.title,c.seo.description,c.seo.keywords),c.og||a.metaservice.setOg("https://tempoStorm.com"+c.url)}),a.$on("$stateChangeError",function(a,c,d,e,f){b.transitionTo("app.404")}),a.$on("$routeChangeError",function(a,b,c,d){console.log(3),"invalid_user"==d&&console.log(c)})}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$controllerProvider","$compileProvider","$filterProvider","$provide","$httpProvider","$bootboxProvider",function(a,b,c,d,e,f,g,h,i){app.controller=d.register,app.directive=e.directive,app.filter=f.register,app.factory=g.factory,app.service=g.service,app.constant=g.constant,app.value=g.value,i.setDefaults({locale:"en"}),a.html5Mode(!0),h.interceptors.push("TokenInterceptor");var j=!1,k=j?"https://s3-us-west-2.amazonaws.com/ts-node2":"";c.otherwise("404"),b.state("app",{"abstract":!0,url:"/",views:{root:{templateUrl:k+"views/frontend/index.html"}},resolve:{User:["$window","$cookies","$state","$q","AuthenticationService","SubscriptionService","UserService",function(a,b,c,d,e,f,g){if(b.token&&(a.sessionStorage.token=b.token),a.sessionStorage.token&&!e.isLogged()){var h=d.defer();return g.verify().success(function(b){e.setLogged(!0),e.setAdmin(b.isAdmin),e.setProvider(b.isProvider),f.setSubscribed(b.subscription.isSubscribed),f.setTsPlan(b.subscription.plan),f.setExpiry(b.subscription.expiry),a.sessionStorage.userID=b.userID,a.sessionStorage.username=b.username,a.sessionStorage.email=b.email,h.resolve()}).error(function(c){delete a.sessionStorage.userID,delete a.sessionStorage.username,delete a.sessionStorage.token,delete a.sessionStorage.email,delete b.token,d.reject()}),h.promise}}]}}).state("app.404",{url:"404",views:{content:{templateUrl:k+"views/frontend/404.html",controller:"404Ctrl"}},seo:{title:"404"}}).state("app.home",{url:"",views:{content:{templateUrl:k+"views/frontend/home.html",controller:"HomeCtrl",resolve:{dataArticles:["ArticleService",function(a){var b="all",c=1,d=3;return a.getArticles("ts",b,c,d)}],dataBanners:["BannerService",function(a){return a.getBanners("ts")}]}}},seo:{title:"Home",description:"TempoStorm home page.",keywords:""}}).state("app.articles",{"abstract":!0,url:"articles",views:{content:{templateUrl:k+"views/frontend/articles.html"}}}).state("app.articles.list",{url:"?s&p&t&f",views:{articles:{templateUrl:k+"views/frontend/articles.list.html",controller:"ArticlesCtrl",resolve:{data:["$stateParams","ArticleService",function(a,b){var c=a.t||"all",d=a.f||"all",e=a.p||1,f=10,g=a.s||"";return b.getArticles(c,d,e,f,g)}]}}},seo:{title:"Articles",description:"TempoStorm articles to bring you the latest news.",keywords:""},og:!0}).state("app.articles.article",{url:"/:slug",views:{articles:{templateUrl:k+"views/frontend/articles.article.html",controller:"ArticleCtrl",resolve:{data:["$stateParams","$q","ArticleService",function(a,b,c){var d=a.slug;return c.getArticle(d).then(function(a){return a.success===!0?a:b.reject("Unable to find article")})}]}}}}).state("app.hs",{"abstract":!0,url:"hearthstone",views:{content:{templateUrl:"views/frontend/hs.html"}}}).state("app.decks",{url:"decks?p&s&k&a&o",redirectTo:"app.hs.decks.list"}).state("app.decks.deck",{url:"/:slug",redirectTo:"app.hs.decks.deck"}).state("app.deckBuilder",{url:"deck-builder",redirectTo:"app.hs.deckBuilder.class"}).state("app.hs.home",{url:"",views:{hs:{templateUrl:k+"views/frontend/hs.home.html",controller:"HearthstoneHomeCtrl",resolve:{dataArticles:["ArticleService",function(a){var b="all",c=1,d=9;return a.getArticles("hs",b,c,d)}],dataDecks:["DeckService",function(a){var b="all",c=1,d=10;return a.getDecksCommunity(b,c,d)}],dataDecksFeatured:["DeckService",function(a){var b="all",c=1,d=10;return a.getDecksFeatured(b,c,d)}],dataBanners:["BannerService",function(a){return a.getBanners("hs")}]}}},seo:{title:"Hearthstone",description:"TempoStorm Hearthstone featured and community decks.",keywords:""},og:!0}).state("app.hs.decks",{"abstract":!0,url:"/decks",views:{hs:{templateUrl:k+"views/frontend/hs.decks.html"}}}).state("app.hs.decks.list",{url:"?p&s&k&a&o",views:{decks:{templateUrl:k+"views/frontend/hs.decks.list.html",controller:"DecksCtrl",resolve:{data:["$stateParams","DeckService",function(a,b){var c=a.k||"all",d=a.p||1,e=24,f=a.s||"",g=a.a||"",h=a.o||"";return b.getDecks(c,d,e,f,g,h)}]}}},seo:{title:"Decks",description:"Hearthstone decks created by the community and TempoStorm content providers.",keywords:""}}).state("app.hs.decks.deck",{url:"/:slug",views:{decks:{templateUrl:k+"views/frontend/hs.decks.deck.html",controller:"DeckCtrl",resolve:{data:["$stateParams","DeckService",function(a,b){var c=a.slug;return b.getDeck(c).then(function(a){return a.success===!0?a:$q.reject("unable to find deck")})}]}}}}).state("app.hs.deckBuilder",{"abstract":!0,url:"/deck-builder",views:{hs:{templateUrl:k+"views/frontend/hs.deck-builder.html"}}}).state("app.hs.deckBuilder.class",{url:"",views:{deckBuilder:{templateUrl:k+"views/frontend/hs.deck-builder.class.html"}},seo:{title:"Deck Builder",description:"Deck building tool for Hearthstone.",keywords:""}}).state("app.hs.deckBuilder.build",{url:"/:playerClass",views:{deckBuilder:{templateUrl:k+"views/frontend/hs.deck-builder.build.html",controller:"DeckBuilderCtrl",resolve:{data:["$stateParams","DeckBuilder",function(a,b){var c=a.playerClass;return b.loadCards(c)}]}}}}).state("app.hs.deckBuilder.edit",{url:"/edit/:slug",views:{deckBuilder:{templateUrl:k+"views/frontend/hs.deck-builder.edit.html",controller:"DeckEditCtrl",resolve:{data:["$stateParams","DeckService",function(a,b){var c=a.slug;return b.deckEdit(c)}]}}},seo:{title:"Deck Edit",description:"Editing tool for hearthstone decks.",keywords:""}}).state("app.hots",{"abstract":!0,url:"heroes-of-the-storm",views:{content:{templateUrl:k+"views/frontend/hots.html"}}}).state("app.hots.home",{url:"",views:{hots:{templateUrl:k+"views/frontend/hots.home.html",controller:"HOTSHomeCtrl",resolve:{dataArticles:["ArticleService",function(a){var b="all",c=1,d=9;return a.getArticles("hots",b,c,d)}],dataGuidesCommunity:["HOTSGuideService",function(a){return a.getGuidesCommunity()}],dataGuidesFeatured:["HOTSGuideService",function(a){return a.getGuidesFeatured()}],dataBanners:["BannerService",function(a){return a.getBanners("hots")}]}}},seo:{title:"Heroes of the Storm",description:"TempoStorm Heroes of the Storm home.",keywords:""}}).state("app.hots.guides",{"abstract":!0,url:"/guides",views:{hots:{templateUrl:k+"views/frontend/hots.guides.html"}}}).state("app.hots.guides.list",{url:"?p&s&t&h&m&a&o",views:{guides:{templateUrl:k+"views/frontend/hots.guides.list.html",controller:"HOTSGuidesListCtrl",resolve:{data:["$stateParams","HOTSGuideService",function(a,b){var c=a.t||"all",d=a.h||"all",e=a.m||"all",f=a.p||1,g=24,h=a.s||"",i=a.a||"",j=a.o||"";return b.getGuides(c,d,e,f,g,h,i,j)}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guides",description:"Guides for Heroes of the Storm.",keywords:""}}).state("app.hots.guides.guide",{url:"/:slug",views:{guides:{templateUrl:k+"views/frontend/hots.guides.guide.html",controller:"HOTSGuideCtrl",resolve:{data:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.getGuide(c).then(function(a){return a.success===!0?a:$q.reject("Unable to find guide")})}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},og:!0}).state("app.hots.guideBuilder",{"abstract":!0,url:"/guide-builder",views:{hots:{templateUrl:k+"views/frontend/hots.guideBuilder.html"}}}).state("app.hots.guideBuilder.step1",{url:"",views:{guideBuilder:{templateUrl:k+"views/frontend/hots.guideBuilder.step1.html"}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""}}).state("app.hots.guideBuilder.hero",{url:"/hero",views:{guideBuilder:{templateUrl:k+"views/frontend/hots.guideBuilder.hero.html",controller:"HOTSGuideBuilderHeroCtrl",resolve:{dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""}}).state("app.hots.guideBuilder.map",{url:"/map",views:{guideBuilder:{templateUrl:k+"views/frontend/hots.guideBuilder.map.html",controller:"HOTSGuideBuilderMapCtrl",resolve:{dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""}}).state("app.hots.guideBuilder.edit",{"abstract":!0,url:"/edit/:slug",views:{guideBuilder:{templateUrl:k+"views/frontend/hots.guideBuilder.edit.html"}},access:{auth:!0}}).state("app.hots.guideBuilder.edit.step1",{url:"",views:{edit:{templateUrl:k+"views/frontend/hots.guideBuilder.edit.step1.html",controller:"HOTSGuideBuilderEditStep1Ctrl",resolve:{dataGuide:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.guideEdit(c)}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""},access:{auth:!0}}).state("app.hots.guideBuilder.edit.hero",{url:"/hero",views:{edit:{templateUrl:k+"views/frontend/hots.guideBuilder.edit.hero.html",controller:"HOTSGuideBuilderEditHeroCtrl",resolve:{dataGuide:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.guideEdit(c)}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""},access:{auth:!0}}).state("app.hots.guideBuilder.edit.map",{url:"/map",views:{edit:{templateUrl:k+"views/frontend/hots.guideBuilder.edit.map.html",controller:"HOTSGuideBuilderEditMapCtrl",resolve:{dataGuide:["$stateParams","HOTSGuideService",function(a,b){var c=a.slug;return b.guideEdit(c)}],dataHeroes:["HeroService",function(a){return a.getHeroes()}],dataMaps:["HOTSGuideService",function(a){return a.getMaps()}]}}},seo:{title:"Guide Builder",description:"Heroes of the Storm guide builder.",keywords:""},access:{auth:!0}}).state("app.hots.talentCalculator",{"abstract":!0,url:"/talent-calculator",views:{hots:{templateUrl:k+"views/frontend/hots.talentCalculator.html",controller:"HOTSTalentCalculatorCtrl",resolve:{dataHeroesList:["HeroService",function(a){return a.getHeroesList()}]}}}}).state("app.hots.talentCalculator.redirect",{url:"",resolve:{dataHeroesList:["HeroService","$q",function(a,b){return a.getHeroesList().then(function(a){return a.success===!0?a:b.reject("unable to find hero")})}],redirect:["$q","$state","dataHeroesList",function(a,b,c){return b.go("app.hots.talentCalculator.hero",{hero:c.heroes[0].className}),a.reject()}]},seo:{title:"Talent Calculator",description:"Talent Calculator for Heroes of the Storm",keywords:""}}).state("app.hots.talentCalculator.hero",{url:"/:hero",views:{calc:{templateUrl:k+"views/frontend/hots.talentCalculator.hero.html",controller:"HOTSTalentCalculatorHeroCtrl",resolve:{dataHero:["$stateParams","$q","HeroService",function(a,b,c){var d=a.hero;return c.getHeroByClass(d).then(function(a){return a.success===!0?a:b.reject("unable to find hero")})}]}}},seo:{title:"Talent Calculator",description:"Talent Calculator for Heroes of the Storm",keywords:""}}).state("app.forum",{"abstract":!0,url:"forum",views:{content:{templateUrl:k+"views/frontend/forum.html"}}}).state("app.forum.home",{url:"",views:{forum:{templateUrl:k+"views/frontend/forum.home.html",controller:"ForumCategoryCtrl",resolve:{data:["ForumService","$q",function(a,b){return a.getCategories().then(function(a){return a.success===!0?a:b.reject("unable to find catagory")})}]}}},seo:{title:"Forum",description:"",keywords:""}}).state("app.forum.threads",{url:"/:thread",views:{forum:{templateUrl:k+"views/frontend/forum.threads.html",controller:"ForumThreadCtrl",resolve:{data:["$stateParams","ForumService","$q",function(a,b,c){var d=a.thread;return b.getThread(d).then(function(a){return a.success===!0?a:c.reject("unable to find thread")})}]}}},og:!0}).state("app.forum.add",{url:"/:thread/add",views:{forum:{templateUrl:k+"views/frontend/forum.add.html",controller:"ForumAddCtrl",resolve:{data:["$stateParams","ForumService",function(a,b){var c=a.thread;return b.getThread(c)}]}}}}).state("app.forum.post",{url:"/:thread/:post",views:{forum:{templateUrl:k+"views/frontend/forum.post.html",controller:"ForumPostCtrl",resolve:{data:["$stateParams","ForumService","$q",function(a,b,c){var d=a.thread,e=a.post;return b.getPost(d,e).then(function(a){return a.success===!0?a:c.reject("unable to find post")})}]}}},og:!0}).state("app.team",{"abstract":!0,url:"team",views:{content:{templateUrl:k+"views/frontend/team.html"}}}).state("app.team.hearthstone",{url:"/team/hearthstone",views:{team:{templateUrl:k+"views/frontend/team.hearthstone.html"}},seo:{title:"Hearthstone",description:"TempoStorm Hearthstone team.",keywords:""}}).state("app.team.heroes",{url:"/team/hots",views:{team:{templateUrl:k+"views/frontend/team.hots.html"}},seo:{title:"Heroes of the Storm",description:"TempoStorm Heroes of the Storm team.",keywords:""}}).state("app.team.csgo",{url:"/team/csgo",views:{team:{templateUrl:k+"views/frontend/team.csgo.html"}},seo:{title:"CS:GO",description:"TempoStorm Counter Strike: Global Offensive team.",keywords:""}}).state("app.team.fifa",{url:"/fifa",views:{team:{templateUrl:k+"views/frontend/team.fifa.html"}},seo:{title:"FIFA",description:"TempoStorm FIFA team.",keywords:""}}).state("app.team.fgc",{url:"/fgc",views:{team:{templateUrl:k+"views/frontend/team.fgc.html"}},seo:{title:"FGC",description:"TempoStorm FGC team.",keywords:""}}).state("app.polls",{url:"vote",views:{content:{templateUrl:k+"views/frontend/polls.html",controller:"PollsCtrl",resolve:{dataPollsMain:["PollService",function(a){return a.getPolls("main")}],dataPollsSide:["PollService",function(a){return a.getPolls("side")}]}}},seo:{title:"Vote",description:"Vote on TempoStorm",keywords:""}}).state("app.sponsors",{url:"sponsors",views:{content:{templateUrl:k+"views/frontend/sponsors.html"}},seo:{title:"Sponsors",description:"TempoStorm sponsor page.",keywords:""}}).state("app.premium",{url:"premium",views:{content:{templateUrl:k+"views/frontend/premium.html",controller:"PremiumCtrl"}},seo:{title:"Get Premium",description:"Get Premium with TempoStorm",keywords:""}}).state("app.terms",{url:"terms",views:{content:{templateUrl:k+"views/frontend/terms.html"}},seo:{title:"Terms and Conditions",description:"TempoStorm Terms and Conditions",keywords:""}}).state("app.privacy",{url:"privacy",views:{content:{templateUrl:k+"views/frontend/privacy.html"}},seo:{title:"Privacy Policy",description:"TempoStorm Privacy Policy",keywords:""}}).state("app.login",{url:"login",views:{content:{templateUrl:k+"views/frontend/login.html",controller:"UserCtrl"}},access:{noauth:!0},seo:{title:"Login",description:"Login to TempoStorm",keywords:""}}).state("app.signup",{url:"signup",views:{content:{templateUrl:k+"views/frontend/signup.html",controller:"UserCtrl"}},access:{noauth:!0},seo:{title:"Sign up",description:"Sign up for TempoStorm.",keywords:""}}).state("app.verify",{url:"verify?email&code",views:{content:{templateUrl:k+"views/frontend/verify.html",controller:"UserVerifyCtrl"}},access:{noauth:!0},seo:{title:"Verify your Email",description:"",keywords:""}}).state("app.forgotPassword",{url:"forgot-password",views:{content:{templateUrl:k+"views/frontend/forgot-password.html",controller:"UserCtrl"}},access:{noauth:!0},seo:{title:"Forgot your Password?",description:"Recover your Password.",keywords:""}}).state("app.resetPassword",{url:"forgot-password/reset?email&code",views:{content:{templateUrl:k+"views/frontend/reset-password.html",controller:"UserResetPasswordCtrl"}},access:{noauth:!0},seo:{title:"Reset your Password",description:"",keywords:""}}).state("app.profile",{"abstract":!0,url:"user/:username",views:{content:{templateUrl:k+"views/frontend/profile.html",controller:"ProfileCtrl",resolve:{dataProfile:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getProfile(c).then(function(a){return a.success===!0?a:$q.reject("Unable to find profile")})}]}}}}).state("app.profile.activity",{url:"",views:{profile:{templateUrl:k+"views/frontend/profile.activity.html",controller:"ProfileActivityCtrl",resolve:{dataActivity:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getActivity(c)}]}}}}).state("app.profile.articles",{url:"/articles",views:{profile:{templateUrl:k+"views/frontend/profile.articles.html",controller:"ProfileArticlesCtrl",resolve:{dataArticles:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getArticles(c)}]}}}}).state("app.profile.decks",{url:"/decks",views:{profile:{templateUrl:k+"views/frontend/profile.decks.html",controller:"ProfileDecksCtrl",resolve:{dataDecks:["User","$stateParams","ProfileService","AuthenticationService",function(a,b,c,d){var e=b.username;return console.log(d.isLogged()),d.isLogged()?c.getDecksLoggedIn(e):c.getDecks(e)}]}}}}).state("app.profile.guides",{url:"/guides",views:{profile:{templateUrl:k+"views/frontend/profile.guides.html",controller:"ProfileGuidesCtrl",resolve:{dataGuides:["$stateParams","ProfileService","AuthenticationService","User",function(a,b,c,d){var e=a.username;return c.isLogged()?b.getGuidesLoggedIn(e):b.getGuides(e)}]}}}}).state("app.profile.posts",{url:"/posts",views:{profile:{templateUrl:k+"views/frontend/profile.posts.html",controller:"ProfilePostsCtrl",resolve:{dataPosts:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getProfile(c)}]}}}}).state("app.profile.edit",{url:"/edit",views:{profile:{templateUrl:k+"views/frontend/profile.edit.html",controller:"ProfileEditCtrl",resolve:{dataProfileEdit:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getUserProfile(c)}]}}},access:{auth:!0}}).state("app.profile.changeEmail",{url:"/email-change-confirm?code",views:{profile:{templateUrl:k+"views/frontend/blank.html",controller:"ProfileEmailChangeCtrl",resolve:{data:["$stateParams","ProfileService",function(a,b){var c=a.code||!1;return b.changeEmail(c)}]}}},access:{auth:!0},seo:{title:"Change my Email",description:"",keywords:""}}).state("app.profile.updateEmail",{url:"/email-verify?code",views:{profile:{templateUrl:k+"views/frontend/blank.html",controller:"ProfileEmailConfirmCtrl",resolve:{data:["$stateParams","ProfileService",function(a,b){var c=a.code||!1;return b.updateEmail(c)}]}}},access:{auth:!0}}).state("app.profile.subscription",{url:"/subscription?plan",views:{profile:{templateUrl:k+"views/frontend/profile.subscription.html",controller:"ProfileSubscriptionCtrl",resolve:{dataProfileEdit:["$stateParams","ProfileService",function(a,b){var c=a.username;return b.getUserProfile(c)}]}}},access:{auth:!0},seo:{title:"My Subscription",description:"",keywords:""}}).state("app.admin",{"abstract":!0,url:"admin",views:{content:{templateUrl:k+"views/admin/index.html",resolve:{admin:["User",function(a){return!0}]}}},access:{auth:!0,admin:!0}}).state("app.admin.dashboard",{url:"",views:{admin:{templateUrl:k+"views/admin/dashboard.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles",{"abstract":!0,url:"/articles",views:{admin:{templateUrl:k+"views/admin/articles.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles.list",{url:"",views:{articles:{templateUrl:k+"views/admin/articles.list.html",controller:"AdminArticleListCtrl",resolve:{data:["AdminArticleService",function(a){var b=1,c=50,d="";return a.getArticles(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles.add",{url:"/add",views:{articles:{templateUrl:k+"views/admin/articles.add.html",controller:"AdminArticleAddCtrl",resolve:{dataDecks:["AdminDeckService",function(a){return a.getDecks(1,10,"")}],dataGuides:["AdminHOTSGuideService",function(a){return a.getGuides(1,10,"")}],dataArticles:["AdminArticleService",function(a){return a.getArticles(1,10,"")}],dataProviders:["AdminUserService",function(a){return a.getProviders()}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.articles.edit",{url:"/edit/:articleID",views:{articles:{templateUrl:k+"views/admin/articles.edit.html",controller:"AdminArticleEditCtrl",resolve:{data:["$stateParams","AdminArticleService",function(a,b){var c=a.articleID;return b.getArticle(c)}],dataDecks:["AdminDeckService",function(a){var b=1,c=10,d="";return a.getDecks(b,c,d)}],dataGuides:["AdminHOTSGuideService",function(a){return a.getAllGuides()}],dataArticles:["AdminArticleService",function(a){return a.getAllArticles()}],dataProviders:["AdminUserService",function(a){return a.getProviders()}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone",{"abstract":!0,url:"/hs",views:{admin:{templateUrl:k+"views/admin/hearthstone.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks",{"abstract":!0,url:"/decks",views:{hearthstone:{templateUrl:k+"views/admin/decks.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.list",{url:"",views:{decks:{templateUrl:k+"views/admin/decks.list.html",controller:"AdminDeckListCtrl",resolve:{data:["AdminDeckService",function(a){var b=1,c=50,d="";return a.getDecks(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.add",{url:"/add",views:{decks:{templateUrl:k+"views/admin/decks.add.class.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.addBuild",{url:"/add/:playerClass",views:{decks:{templateUrl:k+"views/admin/decks.add.build.html",controller:"AdminDeckAddCtrl",resolve:{data:["$stateParams","DeckBuilder",function(a,b){var c=a.playerClass;return b.loadCards(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.decks.edit",{url:"/edit/:deckID",views:{decks:{templateUrl:k+"views/admin/decks.edit.html",controller:"AdminDeckEditCtrl",resolve:{data:["$stateParams","AdminDeckService",function(a,b){var c=a.deckID;return b.getDeck(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.cards",{"abstract":!0,url:"/cards",views:{hearthstone:{templateUrl:k+"views/admin/cards.html"}},access:{auth:!0,admin:!0}}).state("app.admin.hearthstone.cards.list",{url:"",views:{cards:{templateUrl:k+"views/admin/cards.list.html",controller:"AdminCardListCtrl",resolve:{data:["AdminCardService",function(a){return a.getCards()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.cards.add",{url:"/add",views:{cards:{templateUrl:k+"views/admin/cards.add.html",controller:"AdminCardAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hearthstone.cards.edit",{url:"/edit/:cardID",views:{cards:{templateUrl:k+"views/admin/cards.edit.html",controller:"AdminCardEditCtrl",resolve:{data:["$stateParams","AdminCardService",function(a,b){var c=a.cardID;return b.getCard(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots",{"abstract":!0,url:"/hots",views:{admin:{templateUrl:k+"views/admin/hots.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.heroes",{"abstract":!0,url:"/heroes",views:{hots:{templateUrl:k+"views/admin/hots.heroes.html"}},access:{auth:!0,admin:!0}}).state("app.admin.hots.heroes.list",{url:"",views:{heroes:{templateUrl:k+"views/admin/hots.heroes.list.html",controller:"AdminHeroListCtrl",resolve:{data:["AdminHeroService",function(a){var b=1,c=50,d="";return a.getHeroes(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.heroes.add",{url:"/add",views:{heroes:{templateUrl:k+"views/admin/hots.heroes.add.html",controller:"AdminHeroAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.heroes.edit",{url:"/edit/:heroID",views:{heroes:{templateUrl:k+"views/admin/hots.heroes.edit.html",controller:"AdminHeroEditCtrl",resolve:{data:["$stateParams","AdminHeroService",function(a,b){var c=a.heroID;return b.getHero(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps",{"abstract":!0,url:"/maps",views:{hots:{templateUrl:k+"views/admin/hots.maps.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps.list",{url:"",views:{maps:{templateUrl:k+"views/admin/hots.maps.list.html",controller:"AdminMapsListCtrl",resolve:{data:["AdminMapService",function(a){var b=1,c=50,d="";return a.getMaps(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps.add",{url:"/add",views:{maps:{templateUrl:k+"views/admin/hots.maps.add.html",controller:"AdminMapAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.maps.edit",{url:"/edit/:mapID",views:{maps:{templateUrl:k+"views/admin/hots.maps.edit.html",controller:"AdminMapEditCtrl",resolve:{data:["$stateParams","AdminMapService",function(a,b){var c=a.mapID;return b.getMap(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides",{"abstract":!0,url:"/guides",views:{hots:{templateUrl:k+"views/admin/hots.guides.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.list",{url:"",views:{guides:{templateUrl:k+"views/admin/hots.guides.list.html",controller:"AdminHOTSGuideListCtrl",resolve:{data:["AdminHOTSGuideService",function(a){var b=1,c=50,d="";return a.getGuides(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add",{"abstract":!0,url:"/add",views:{guides:{templateUrl:k+"views/admin/hots.guides.add.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add.step1",{url:"",views:{add:{templateUrl:k+"views/admin/hots.guides.add.step1.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add.hero",{url:"/hero",views:{add:{templateUrl:k+"views/admin/hots.guides.add.hero.html",controller:"AdminHOTSGuideAddHeroCtrl",resolve:{dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.add.map",{url:"/map",views:{add:{templateUrl:k+"views/admin/hots.guides.add.map.html",controller:"AdminHOTSGuideAddMapCtrl",resolve:{dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit",{"abstract":!0,url:"/edit",views:{guides:{templateUrl:k+"views/admin/hots.guides.edit.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit.step1",{url:"/:guideID",views:{edit:{templateUrl:k+"views/admin/hots.guides.edit.step1.html",controller:"AdminHOTSGuideEditStep1Ctrl",resolve:{dataGuide:["$stateParams","AdminHOTSGuideService",function(a,b){var c=a.guideID;return b.getGuide(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit.hero",{url:"/:guideID/hero",views:{edit:{templateUrl:k+"views/admin/hots.guides.edit.hero.html",controller:"AdminHOTSGuideEditHeroCtrl",resolve:{dataGuide:["$stateParams","AdminHOTSGuideService",function(a,b){var c=a.guideID;return b.getGuide(c)}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.hots.guides.edit.map",{url:"/:guideID/map",views:{edit:{templateUrl:k+"views/admin/hots.guides.edit.map.html",controller:"AdminHOTSGuideEditMapCtrl",resolve:{dataGuide:["$stateParams","AdminHOTSGuideService",function(a,b){var c=a.guideID;return b.getGuide(c)}],dataHeroes:["AdminHeroService",function(a){return a.getAllHeroes()}],dataMaps:["AdminMapService",function(a){return a.getAllMaps()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum",{"abstract":!0,url:"/forum",views:{admin:{templateUrl:k+"views/admin/forum.html"}},access:{auth:!0,admin:!0}}).state("app.admin.forum.structure",{"abstract":!0,url:"/structure",views:{forum:{templateUrl:k+"views/admin/forum.structure.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.list",{url:"",views:{categories:{templateUrl:k+"views/admin/forum.structure.list.html",controller:"AdminForumStructureListCtrl",resolve:{data:["AdminForumService",function(a){return a.getCategories()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.categoryAdd",{url:"/category/add",views:{categories:{templateUrl:k+"views/admin/forum.categories.add.html",controller:"AdminForumCategoryAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.categoryEdit",{url:"/category/edit/:categoryID",views:{categories:{templateUrl:k+"views/admin/forum.categories.edit.html",controller:"AdminForumCategoryEditCtrl",resolve:{data:["$stateParams","AdminForumService",function(a,b){
var c=a.categoryID;return b.getCategory(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.threadAdd",{url:"/thread/add",views:{categories:{templateUrl:k+"views/admin/forum.threads.add.html",controller:"AdminForumThreadAddCtrl",resolve:{data:["AdminForumService",function(a){return a.getCategories()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.structure.threadEdit",{url:"/thread/edit/:threadID",views:{categories:{templateUrl:k+"views/admin/forum.threads.edit.html",controller:"AdminForumThreadEditCtrl",resolve:{dataCategories:["AdminForumService",function(a){return a.getCategories()}],dataThread:["$stateParams","AdminForumService",function(a,b){var c=a.threadID;return b.getThread(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.forum.management",{url:"/management",views:{admin:{templateUrl:k+"views/admin/forum.management.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users",{"abstract":!0,url:"/users",views:{admin:{templateUrl:k+"views/admin/users.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users.list",{url:"",views:{users:{templateUrl:k+"views/admin/users.list.html",controller:"AdminUserListCtrl",resolve:{data:["AdminUserService",function(a){var b=1,c=50,d="";return a.getUsers(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users.add",{url:"/add",views:{users:{templateUrl:k+"views/admin/users.add.html",controller:"AdminUserAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.users.edit",{url:"/edit/:userID",views:{users:{templateUrl:k+"views/admin/users.edit.html",controller:"AdminUserEditCtrl",resolve:{data:["$stateParams","AdminUserService",function(a,b){var c=a.userID;return b.getUser(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners",{"abstract":!0,url:"/banners",views:{admin:{templateUrl:k+"views/admin/banners.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners.list",{url:"",views:{banners:{templateUrl:k+"views/admin/banners.list.html",controller:"AdminBannerListCtrl",resolve:{data:["AdminBannerService",function(a){return a.getBanners()}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners.add",{url:"/add",views:{banners:{templateUrl:k+"views/admin/banners.add.html",controller:"AdminBannerAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.banners.edit",{url:"/edit/:bannerID",views:{banners:{templateUrl:k+"views/admin/banners.edit.html",controller:"AdminBannerEditCtrl",resolve:{data:["$stateParams","AdminBannerService",function(a,b){var c=a.bannerID;return b.getBanner(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls",{"abstract":!0,url:"/polls",views:{admin:{templateUrl:k+"views/admin/polls.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls.list",{url:"",views:{polls:{templateUrl:k+"views/admin/polls.list.html",controller:"AdminPollListCtrl",resolve:{data:["AdminPollService",function(a){var b=1,c=50,d="";return a.getPolls(b,c,d)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls.add",{url:"/add",views:{polls:{templateUrl:k+"views/admin/polls.add.html",controller:"AdminPollAddCtrl"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.polls.edit",{url:"/edit/:pollID",views:{polls:{templateUrl:k+"views/admin/polls.edit.html",controller:"AdminPollEditCtrl",resolve:{data:["$stateParams","AdminPollService",function(a,b){var c=a.pollID;return b.getPoll(c)}]}}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.subscriptions",{url:"/subscriptions",views:{admin:{templateUrl:k+"views/admin/subscriptions.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.admin.streams",{url:"/streams",views:{admin:{templateUrl:k+"views/admin/streams.html"}},access:{auth:!0,admin:!0},seo:{title:"Admin",description:"",keywords:""}}).state("app.contact",{url:"contact",views:{content:{templateUrl:k+"views/frontend/contact.html",controller:"ContactCtrl"}},seo:{title:"Contact Us",description:"Contact Page",keywords:""}})}]);angular.module("ui.gravatar").config(["gravatarServiceProvider",function(a){a.defaults={size:200,"default":"https://s3-us-west-2.amazonaws.com/ts-node2/img/profile.jpg"},a.secure=!0}]),angular.module("app.controllers",["ngCookies"]).controller("AppCtrl",["$scope","$localStorage","$cookies","$window","$location","SubscriptionService","AuthenticationService","UserService",function(a,b,c,d,e,f,g,h){function i(a){var b=a.navigator.userAgent||a.navigator.vendor||a.opera;return/iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/.test(b)}var j=!!navigator.userAgent.match(/MSIE/i);j&&angular.element(d.document.body).addClass("ie"),i(d)&&angular.element(d.document.body).addClass("smart"),a.app={name:"TempoStorm",version:"0.0.1",copyright:(new Date).getFullYear(),cdn:"https://s3-us-west-2.amazonaws.com/ts-node2",settings:{token:c.token||null,deck:null,show:{deck:null,article:null,decks:null}},user:{getUserEmail:function(){return d.sessionStorage.email||!1},getUserID:function(){return d.sessionStorage.userID},getUsername:function(){return d.sessionStorage.username},isSubscribed:function(){return f.isSubscribed()},getSubscription:function(){return f.getSubscription()},isAdmin:g.isAdmin,isProvider:g.isProvider,isLogged:g.isLogged,logout:function(){return g.isLogged()&&(g.setLogged(!1),g.setAdmin(!1),g.setProvider(!1),f.setSubscribed(!1),f.setTsPlan(!1),f.setExpiry(!1),delete d.sessionStorage.userID,delete d.sessionStorage.username,delete d.sessionStorage.token,delete d.sessionStorage.email,a.app.settings.token=null,delete c.token),e.path("/login")}}},angular.isDefined(b.settings)?(a.app.settings=b.settings,a.app.settings.show||(a.app.settings.show={deck:null,article:null,decks:null}),a.app.settings.show.deck||(a.app.settings.show.deck=null),a.app.settings.show.article||(a.app.settings.show.article=null),a.app.settings.show.decks||(a.app.settings.show.decks=null)):b.settings=a.app.settings,a.$watch("app.settings",function(){b.settings=a.app.settings},!0)}]).controller("404Ctrl",["$scope","MetaService",function(a,b){b.setStatusCode(404)}]).controller("UserCtrl",["$scope","$location","$window","$state","UserService","AuthenticationService","AlertService","SubscriptionService",function(a,b,c,d,e,f,g,h){g.hasAlert()&&(a.success=g.getSuccess(),g.reset()),a.login=function(d,g){void 0!==d&&void 0!==g&&e.login(d,g).success(function(d){f.setLogged(!0),f.setAdmin(d.isAdmin),f.setProvider(d.isProvider),h.setSubscribed(d.subscription.isSubscribed),h.setTsPlan(d.subscription.plan),h.setExpiry(d.subscription.expiry),c.sessionStorage.userID=d.userID,c.sessionStorage.username=d.username,c.sessionStorage.email=d.email,a.app.settings.token=c.sessionStorage.token=d.token,b.path("/")}).error(function(b,c){a.showError=!0})},a.signup=function(b,c,f,g){void 0!==b&&void 0!==c&&void 0!==f&&void 0!==g&&e.signup(b,c,f,g).success(function(c){return c.success?d.transitionTo("app.verify",{email:b}):(a.errors=c.errors,void(a.showError=!0))})},a.forgotPassword=function(){e.forgotPassword(a.forgot.email).success(function(b){b.success?(a.showSuccess=!0,a.forgot.email=""):(a.errors=b.errors,a.showError=!0)})}}]).controller("UserVerifyCtrl",["$scope","$location","$window","$state","$stateParams","UserService","AuthenticationService","SubscriptionService",function(a,b,c,d,e,f,g,h){a.verify={email:e.email||"",code:e.code||""},a.verifyEmail=function(){f.verifyEmail(a.verify.email,a.verify.code).success(function(b){b.success?(g.setLogged(!0),g.setAdmin(b.isAdmin),g.setProvider(b.isProvider),h.setSubscribed(b.subscription.isSubscribed),h.setTsPlan(b.subscription.plan),h.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,d.transitionTo("app.home",{})):(a.errors=b.errors,a.showError=!0)})},void 0!==a.verify.email&&a.verify.email.length&&void 0!==a.verify.code&&a.verify.code.length&&a.verifyEmail()}]).controller("UserResetPasswordCtrl",["$scope","$state","$stateParams","UserService","AlertService",function(a,b,c,d,e){a.reset={email:c.email||"",code:c.code||"",password:"",cpassword:""},a.resetPassword=function(){d.resetPassword(a.reset.email,a.reset.code,a.reset.password,a.reset.cpassword).success(function(c){c.success?(e.setSuccess({show:!0,msg:"Your password has been reset successfully."}),b.transitionTo("app.login",{})):(a.errors=c.errors,a.showError=!0)})}}]).controller("HomeCtrl",["$scope","$sce","dataBanners","dataArticles","TwitchService","TwitterService",function(a,b,c,d,e,f){a.articles=d.articles,a.streamWheel=!1,a.twitWheel=!1,a.streams=void 0,a.tweets=void 0,e.getStreams().then(function(b){for(var c=0;c<b.data.length;c++){var d=b.data[c].logoUrl,e=d.substr(4),f="https"+e;b.data[c].logoUrl=f}a.streamWheel=!0,a.streams=b.data}),f.getFeed().then(function(b){a.twitWheel=!0,a.tweets=b.data}),a.getContent=function(a){return b.trustAsHtml(a)},a.banner={current:0,direction:"left",slides:c.banners,setCurrent:function(a){this.direction="right",this.current=a},next:function(){this.direction="right",this.current=this.current<this.slides.length-1?++this.current:0},prev:function(){this.direction="left",this.current=this.current>0?--this.current:this.slides.length-1}}}]).controller("HearthstoneHomeCtrl",["$scope","dataBanners","dataArticles","dataDecks","dataDecksFeatured","ArticleService","DeckService",function(a,b,c,d,e,f,g){a.articles=c.articles,a.decks=d.decks,a.decksFeatured=e.decks,a.loading={articles:!1,community:!1,featured:!1},a.banner={current:0,direction:"left",slides:b.banners,setCurrent:function(a){this.direction="right",this.current=a},next:function(){this.direction="right",this.current=this.current<this.slides.length-1?++this.current:0},prev:function(){this.direction="left",this.current=this.current>0?--this.current:this.slides.length-1}},a.klass="all",a.setKlass=function(b){a.klass=b,a.loading={articles:!0,community:!0,featured:!0},f.getArticles("hs",b,1,9).then(function(b){a.articles=b.articles,a.loading.articles=!1}),g.getDecksCommunity(b,1,10).then(function(b){a.decks=b.decks,a.loading.community=!1}),g.getDecksFeatured(b,1,10).then(function(b){a.decksFeatured=b.decks,a.loading.featured=!1})}}]).controller("PremiumCtrl",["$scope","$state","$window","$compile","bootbox","UserService","AuthenticationService","SubscriptionService",function(a,b,c,d,e,f,g,h){var i,j;a.getPremium=function(c){a.app.user.isLogged()?a.app.user.isSubscribed()||b.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:c}):(i=e.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),i.modal("show"),j=function(){a.getPremium(c)})},a.login=function(b,d){void 0!==b&&void 0!==d&&f.login(b,d).success(function(b){g.setLogged(!0),g.setAdmin(b.isAdmin),g.setProvider(b.isProvider),h.setSubscribed(b.subscription.isSubscribed),h.setTsPlan(b.subscription.plan),h.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,i.modal("hide"),j()}).error(function(){a.showError=!0})}}]).controller("ProfileCtrl",["$scope","dataProfile","MetaService",function(a,b,c){function d(){return a.app.user.getUsername()==a.user.username?"My Profile":"@"+a.user.username+" - Profile"}a.user=b.user,a.metaservice=c,a.metaservice.set(d()),a.socialExists=function(){return a.user.social?a.user.social.twitter&&a.user.social.twitter.length||a.user.social.facebook&&a.user.social.facebook.length||a.user.social.twitch&&a.user.social.twitch.length||a.user.social.instagram&&a.user.social.instagram.length||a.user.social.youtube&&a.user.social.youtube.length:!1}}]).controller("ProfileEditCtrl",["$scope","$state","ProfileService","AlertService","dataProfileEdit",function(a,b,c,d,e){a.profile=e.user,d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.editProfile=function(){c.updateProfile(a.profile).success(function(c){if(c.success){var e="Your profile has been updated successfully.";a.profile.changeEmail&&(e+=" Email address changes must be verified by email before they will take effect."),d.setSuccess({show:!0,msg:e}),b.go(b.current,{username:a.profile.username},{reload:!0})}else console.log(c.error)})}}]).controller("ProfileEmailChangeCtrl",["$scope","$state","$stateParams","AlertService","data",function(a,b,c,d,e){return e.success&&d.setSuccess({show:!0,msg:"An email has been sent to the new address. Please confirm your new email before changes take effect."}),b.transitionTo("app.profile.edit",{username:c.username})}]).controller("ProfileEmailConfirmCtrl",["$scope","$state","$stateParams","AlertService","data",function(a,b,c,d,e){return e.success&&d.setSuccess({show:!0,msg:"Your email address has been updated successfully."}),b.transitionTo("app.profile.edit",{username:c.username})}]).controller("ProfileSubscriptionCtrl",["$scope","$stateParams","SubscriptionService","dataProfileEdit",function(a,b,c,d){if(a.loading=!1,a.profile=d.user,a.error="",a.success="",a.profile.subscription.isSubscribed)a.plan=d.user.subscription.plan||"tempostorm_semi";else{var e;switch(b.plan){case"monthly":e="tempostorm_monthly";break;case"quarterly":e="tempostorm_quarterly";break;case"semi":default:e="tempostorm_semi"}a.plan=e}a.isLoading=function(){return a.loading},a.setLoading=function(b){a.loading=b},a.setSuccess=function(b){a.error="",a.success=b},a.setError=function(b){a.success="",a.error=b},a.setErrorCode=function(b){a.error="An error has occured. Code: "+b+": "+a.getError(b)},a.getError=function(a){switch(a){case 400:return"Missing a required parameter.";case 401:return"No valid API key provided.";case 402:return"Parameters were valid but request failed. Check your information and please try again.";case 404:return"The requested item doesn't exist!";case 500:return"Something went wrong on Stripe's end."}},a.getExpiryDate=function(){var b=a.profile.subscription.expiryDate;if(!b)return!1;var c=(new Date).getTime(),d=new Date(b).getTime();return d>c?d:!1},a.isSubscribed=function(){return a.profile.subscription.isSubscribed},a.subscribe=function(b,d){a.setLoading(!0),d.error?(a.setErrorCode(b),a.setLoading(!1)):c.setPlan(a.plan,d.id).success(function(b){b.success?(c.setSubscribed(!0),c.setTsPlan(b.plan),a.profile.subscription.isSubscribed=!0,a.profile.subscription.plan=b.plan,a.number="",a.cvc="",a.expiry="",a.error="",a.setSuccess("We have successfully processed your payment. Thank you for subscribing with TempoStorm.com!")):(a.setError("An unknown error has occured."),a.setLoading(!1))})},a.updateCard=function(b,d){d.error?console.log(d):c.setCard(d.id).success(function(b){b.success?(a.profile.subscription.last4=b.subscription.last4,a.cardPlaceholder="xxxx xxxx xxxx "+b.subscription.last4,a.number="",a.cvc="",a.expiry=""):console.log("error")})},a.updatePlan=function(){c.setPlan(a.plan).success(function(b){b.success&&(c.setTsPlan(b.plan),a.profile.subscription.plan=b.plan,a.plan=b.plan)})},a.cancel=function(){c.cancel().success(function(b){b.success&&(c.setSubscribed(!1),c.setExpiry(b.subscription.expiryDate),a.profile.subscription.isSubscribed=!1,a.profile.subscription.expiryDate=b.subscription.expiryDate)})}}]).controller("ProfileActivityCtrl",["$scope","$sce","dataActivity",function(a,b,c){a.activities=c.activities,a.activities.forEach(function(a){a.getActivity=function(){return b.trustAsHtml(a.activity)}})}]).controller("ProfileArticlesCtrl",["$scope","dataArticles",function(a,b){a.articles=b.articles}]).controller("ProfileDecksCtrl",["$scope","bootbox","DeckService","dataDecks",function(a,b,c,d){a.decks=d.decks,a.deckDelete=function(d){var e=b.dialog({title:"Delete deck: "+d.name+"?",message:"Are you sure you want to delete the deck <strong>"+d.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.deckDelete(d._id).success(function(b){if(b.success){var c=a.decks.indexOf(d);-1!==c&&a.decks.splice(c,1),a.success={show:!0,msg:'Deck "'+d.name+'" deleted successfully.'}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("ProfileGuidesCtrl",["$scope","bootbox","HOTSGuideService","dataGuides",function(a,b,c,d){a.guides=d.guides,a.guideDelete=function(d){var e=b.dialog({title:"Delete guide: "+d.name+"?",message:"Are you sure you want to delete the guide <strong>"+d.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.guideDelete(d._id).success(function(b){if(b.success){var c=a.guides.indexOf(d);-1!==c&&a.guides.splice(c,1),a.success={show:!0,msg:'guide "'+d.name+'" deleted successfully.'}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("ProfilePostsCtrl",["$scope","dataPosts",function(a,b){a.posts=b.activity}]).controller("AdminCardAddCtrl",["$scope","$window","$stateParams","$upload","$compile","bootbox","Util","Hearthstone","AdminCardService",function(a,b,c,d,e,f,g,h,i){var j={id:"",name:"",cost:"",cardType:h.types[0],rarity:h.rarities[0],race:h.races[0],playerClass:h.classes[0],expansion:h.expansions[0],text:"",mechanics:[],flavor:"",artist:"",attack:"",health:"",durabiltiy:"",dust:"",photos:{small:"",medium:"",large:""},deckable:!0,active:!0};a.cardImg=a.deckImg=a.app.cdn+"/img/blank.png",a.card=angular.copy(j),a.cardTypes=g.toSelect(h.types),a.cardRarities=g.toSelect(h.rarities),a.cardRaces=g.toSelect(h.races),a.cardClasses=g.toSelect(h.classes),a.cardMechanics=g.toSelect(h.mechanics),a.cardExpansions=g.toSelect(h.expansions),a.cardActive=a.cardDeckable=[{name:"Yes",value:!0},{name:"No",value:!1}],a.cardUpload=function(b){if(!b.length)return!1;var c=f.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var g=0;g<b.length;g++){var h=b[g];a.upload=d.upload({url:"/api/admin/upload/card",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.card.photos.medium=b.medium,a.card.photos.large=b.large,a.cardImg=a.app.cdn+b.path+b.large,c.modal("hide")})}},a.deckUpload=function(b){if(!b.length)return!1;var c=f.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var g=0;g<b.length;g++){var h=b[g];a.upload=d.upload({url:"/api/admin/upload/deck",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.card.photos.small=b.small,a.deckImg="."+b.path+b.small,c.modal("hide")})}},a.addCard=function(){a.showError=!1,a.showSuccess=!1,i.addCard(a.card).success(function(c){c.success?(a.showError=!1,a.card=angular.copy(j),a.form.$setPristine(),a.showSuccess=!0):(a.errors=c.errors,a.showError=!0),b.scrollTo(0,0)})}}]).controller("AdminCardEditCtrl",["$location","$scope","$window","$state","$upload","$compile","bootbox","Util","Hearthstone","AdminCardService","AlertService","data",function(a,b,c,d,e,f,g,h,i,j,k,l){return l&&l.success?(b.card=l.card,b.cardTypes=h.toSelect(i.types),b.cardRarities=h.toSelect(i.rarities),b.cardRaces=h.toSelect(i.races),b.cardClasses=h.toSelect(i.classes),b.cardMechanics=h.toSelect(i.mechanics),b.cardExpansions=h.toSelect(i.expansions),b.cardActive=b.cardDeckable=[{name:"Yes",value:!0},{name:"No",value:!1}],b.cardImg=b.card.photos.large.length?b.app.cdn+"/cards/"+b.card.photos.large:b.app.cdn+"/img/blank.png",b.deckImg=b.card.photos.small.length?b.app.cdn+"/cards/"+b.card.photos.small:b.app.cdn+"/img/blank.png",b.cardUpload=function(a){if(!a.length)return!1;var c=g.dialog({message:f('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(b),closeButton:!1,animate:!1});b.uploading=0,c.modal("show");for(var d=0;d<a.length;d++){var h=a[d];b.upload=e.upload({url:"/api/admin/upload/card",method:"POST",file:h}).progress(function(a){b.uploading=parseInt(100*a.loaded/a.total)}).success(function(a,d,e,f){b.card.photos.medium=a.medium,b.card.photos.large=a.large,b.cardImg="."+a.path+a.large,c.modal("hide")})}},b.deckUpload=function(a){if(!a.length)return!1;var c=g.dialog({message:f('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(b),closeButton:!1,animate:!1});b.uploading=0,c.modal("show");for(var d=0;d<a.length;d++){var h=a[d];b.upload=e.upload({url:"/api/admin/upload/deck",method:"POST",file:h}).progress(function(a){b.uploading=parseInt(100*a.loaded/a.total)}).success(function(a,d,e,f){b.card.photos.small=a.small,b.deckImg="."+a.path+a.small,c.modal("hide")})}},void(b.editCard=function(){b.showError=!1,b.showSuccess=!1,j.editCard(b.card).success(function(a){a.success?(k.setSuccess({show:!0,msg:b.card.name+" has been updated successfully."}),d.go("app.admin.hearthstone.cards.list")):(b.errors=a.errors,b.showError=!0,c.scrollTo(0,0))})})):a.path("/admin/cards")}]).controller("AdminCardListCtrl",["$scope","bootbox","Util","Hearthstone","AdminCardService","AlertService","Pagination","data",function(a,b,c,d,e,f,g,h){f.hasAlert()&&(a.success=f.getSuccess(),f.reset()),a.cards=h.cards,a.expansions=[{name:"All Expansions",value:""}].concat(c.toSelect(d.expansions)),a.classes=[{name:"All Classes",value:""}].concat(c.toSelect(d.classes)),a.types=[{name:"All Types",value:""}].concat(c.toSelect(d.types)),a.rarities=[{name:"All Rarities",value:""}].concat(c.toSelect(d.rarities)),a.filterExpansion=a.filterClass=a.filterType=a.filterRarity="",a.pagination=g["new"](),a.pagination.results=function(){return a.filtered?a.filtered.length:a.cards.length},a.deleteCard=function(c){var d=b.dialog({title:"Delete card: "+c.name+"?",message:"Are you sure you want to delete the card <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){e.deleteCard(c._id).then(function(b){if(b.success){var d=a.cards.indexOf(c);-1!==d&&a.cards.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminArticleAddCtrl",["$scope","$state","$window","$upload","$compile","bootbox","Hearthstone","Util","AlertService","AdminArticleService","AdminDeckService","AdminHOTSGuideService","dataGuides","dataArticles","dataProviders","dataHeroes","dataDecks",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var s=new Date;s.setMonth(s.getMonth()+1);var t,u={author:a.app.user.getUserID(),title:"",slug:{url:"",linked:!0},description:"",content:"",photos:{large:"",medium:"",small:""},deck:void 0,guide:void 0,related:[],classTags:[],theme:"none",featured:!1,premium:{isPremium:!1,expiryDate:s},articleType:[],active:!0};a.search="",a.getDecks=function(){k.getDecks(1,10,r(a.search)).then(function(b){a.decks=b.decks})},a.getArticles=function(){j.getArticles(1,10,r(a.search)).then(function(b){a.articles=b.articles})},a.getGuides=function(){l.getGuides(1,10,r(a.search)).then(function(b){a.guides=b.guides})},a.addItemArticle=function(){t=f.dialog({message:e("<div article-item-add></div>")(a),closeButton:!0,animate:!0,onEscape:function(){a.search="",a.getDecks(),a.getGuides()}}),t.modal("show"),t.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.modifyItem=function(b){switch(a.article.articleType.toString()){case"hs":a.article.deck=b;break;case"hots":a.article.guide=b}a.search="",t.modal("hide")},a.addRelatedArticle=function(){t=f.dialog({message:e("<div article-related-add></div>")(a),closeButton:!1,animate:!0}),t.modal("show"),t.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.isRelated=function(b){for(var c=0;c<a.article.related.length;c++)if(b._id==a.article.related[c]._id)return!0;return!1},a.modifyRelated=function(b){return a.isRelated(b)?void a.removeRelatedArticle(b):void a.article.related.push(b)},a.removeRelatedArticle=function(b){for(var c=0;c<a.article.related.length;c++)b._id===a.article.related[c]._id&&a.article.related.splice(c,1)},a.closeBox=function(){t.modal("hide")},a.article=angular.copy(u),a.decks=q.decks,a.guides=[{_id:void 0,name:"No Guide"}].concat(m.guides),a.articles=n.articles,a.providers=o.users,a.setSlug=function(){return a.article.slug.linked?void(a.article.slug.url=h.slugify(a.article.title)):!1},a.toggleSlugLink=function(){a.article.slug.linked=!a.article.slug.linked,a.setSlug()},a.hasTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;return c&&!d||d&&!c},a.getTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;if(c&&!d)return["Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"];if(d&&!c){for(var e=[],f=0;f<p.heroes.length;f++)e.push(p.heroes[f].name);return e}},a.articleTypes=j.articleTypes(),a.articleFeatured=a.articlePremium=a.articleActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.articleTheme=[{name:"None",value:"none"},{name:"Overcast",value:"overcast"}],a.dateOptions={},a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.photoUpload=function(b){if(!b.length)return!1;var c=f.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var g=0;g<b.length;g++){var h=b[g];a.upload=d.upload({url:"/api/admin/upload/article",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.article.photos={large:b.large,medium:b.medium,small:b.small},a.cardImg=a.app.cdn+b.path+b.small,c.modal("hide")})}},a.getImage=function(){return a.imgPath="/articles/",a.article?a.article.photos&&""===a.article.photos.small?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.article.photos.small:"/img/blank.png"},a.addArticle=function(){a.showError=!1,j.addArticle(a.article).success(function(d){d.success?(i.setSuccess({show:!0,msg:a.article.title+" has been added successfully."}),b.go("app.admin.articles.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminArticleEditCtrl",["$scope","$state","$window","$upload","$compile","$filter","bootbox","Hearthstone","Util","AlertService","AdminArticleService","AdminDeckService","AdminHOTSGuideService","data","dataDecks","dataGuides","dataArticles","dataProviders","dataHeroes",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var u;a.article=n.article,a.decks=[{_id:void 0,name:"No deck"}].concat(o.decks),a.guides=[{_id:void 0,name:"No Guide"}].concat(p.guides),a.articles=q.articles,a.providers=r.users,a.search="",a.getDecks=function(){l.getDecks(1,10,t(a.search)).then(function(b){a.decks=b.decks})},a.getArticles=function(){k.getArticles(1,10,t(a.search)).then(function(b){a.articles=b.articles})},a.getGuides=function(){m.getGuides(1,10,t(a.search)).then(function(b){a.guides=b.guides})},a.addItemArticle=function(){u=g.dialog({message:e("<div article-item-add></div>")(a),closeButton:!0,animate:!0,onEscape:function(){a.search="",a.getDecks(),a.getGuides()}}),u.modal("show"),u.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.modifyItem=function(b){switch(a.article.articleType.toString()){case"hs":a.article.deck=b;break;case"hots":a.article.guide=b}a.search="",u.modal("hide")},a.addRelatedArticle=function(){u=g.dialog({message:e("<div article-related-add></div>")(a),closeButton:!1,animate:!0}),u.modal("show"),u.on("hidden.bs.modal",function(){a.search="",a.getArticles()})},a.isRelated=function(b){for(var c=0;c<a.article.related.length;c++)if(b._id==a.article.related[c]._id)return!0;return!1},a.modifyRelated=function(b){return a.isRelated(b)?void a.removeRelatedArticle(b):void a.article.related.push(b)},a.removeRelatedArticle=function(b){for(var c=0;c<a.article.related.length;c++)b._id===a.article.related[c]._id&&a.article.related.splice(c,1)},a.closeBox=function(){u.modal("hide")},a.setSlug=function(){return a.article.slug.linked?void(a.article.slug.url=i.slugify(a.article.title)):!1},a.toggleSlugLink=function(){a.article.slug.linked=!a.article.slug.linked,a.setSlug()},a.cardImg=a.article.photos.small&&a.article.photos.small.length?a.app.cdn+"/articles/"+a.article.photos.small:a.app.cdn+"/img/blank.png",a.hasTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;return c&&!d||d&&!c},a.getTags=function(){var b=a.article.articleType,c=-1!==b.indexOf("hs")?!0:!1,d=-1!==b.indexOf("hots")?!0:!1;if(c&&!d)return["Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"];if(d&&!c){for(var e=[],f=0;f<s.heroes.length;f++)e.push(s.heroes[f].name);return e}},a.articleTypes=k.articleTypes(),a.articleFeatured=a.articlePremium=a.articleActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.articleTheme=[{name:"None",value:"none"},{name:"Overcast",value:"overcast"}],a.article.premium.expiryDate=new Date(a.article.premium.expiryDate),a.dateOptions={},a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.photoUpload=function(b){if(!b.length)return!1;var c=g.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,
animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var h=b[f];a.upload=d.upload({url:"/api/admin/upload/article",method:"POST",file:h}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.article.photos={large:b.large,medium:b.medium,small:b.small},a.cardImg=a.app.cdn+b.path+b.small,c.modal("hide")})}},a.getImage=function(){return a.imgPath="/articles/",a.article?a.article.photos&&""===a.article.photos.small?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.article.photos.small:"/img/blank.png"},a.editArticle=function(){a.showError=!1,k.editArticle(a.article).success(function(d){d.success?(j.setSuccess({show:!0,msg:a.article.title+" has been updated successfully."}),b.go("app.admin.articles.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})},a.getNames=function(){k.getNames(a.article).success(function(a){if(a.success){for(var b="",c=0;c<a.names.length;c++)b=b+a.names[c]+"<br>";var d=g.dialog({message:b,animate:!1});d.modal("show")}else console.log(a)})}}]).controller("AdminArticleListCtrl",["$scope","AdminArticleService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.articles=e.articles,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getArticles=function(){b.getArticles(a.page,a.perpage,a.search).then(function(b){a.articles=b.articles,a.page=b.page,a.total=b.total})},a.searchArticles=function(){a.page=1,a.getArticles()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getArticles()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteArticle=function(c){var d=bootbox.dialog({title:"Delete article: "+c.title+"?",message:"Are you sure you want to delete the article <strong>"+c.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteArticle(c._id).then(function(b){if(b.success){var d=a.articles.indexOf(c);-1!==d&&a.articles.splice(d,1),a.success={show:!0,msg:c.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminDeckListCtrl",["$scope","AdminDeckService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.decks=e.decks,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getDecks=function(){b.getDecks(a.page,a.perpage,a.search).then(function(b){a.decks=b.decks,a.page=b.page,a.total=b.total})},a.searchDecks=function(){a.page=1,a.getDecks()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getDecks()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteDeck=function(c){var d=bootbox.dialog({title:"Delete deck: "+c.name+"?",message:"Are you sure you want to delete the deck <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteDeck(c._id).then(function(b){if(b.success){var d=a.decks.indexOf(c);-1!==d&&a.decks.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminDeckAddCtrl",["$state","$scope","$compile","$window","Pagination","Hearthstone","DeckBuilder","ImgurService","AlertService","AdminDeckService","data",function(a,b,c,d,e,f,g,h,i,j,k){return k&&k.success?(b.step=1,b.showManaCurve=!1,b.classes=angular.copy(f.classes).splice(1,9),b.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},b.prevStep=function(){b.step>1&&(b.step=b.step-1)},b.nextStep=function(){b.step<5&&(b.step=b.step+1)},b.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},b.className=k.className,b.cards=k.cards,b.cards.current=b.cards["class"],b.pagination=e["new"](6),b.pagination.perpage=10,b.pagination.results=function(){return b.filtered?b.filtered.length:b.cards.current.length},b.filters={search:"",mechanics:[],mana:"all"},b.mechanics=f.mechanics,b.inMechanics=function(a){return b.filters.mechanics.indexOf(a)>=0},b.toggleMechanic=function(a){var c=b.filters.mechanics.indexOf(a);-1===c?b.filters.mechanics.push(a):b.filters.mechanics.splice(c,1)},b.filters.byMechanics=function(){return function(a){if(!b.filters.mechanics.length)return!0;for(var c=0,d=0;d<a.mechanics.length;d++)b.inMechanics(a.mechanics[d])&&c++;return c===b.filters.mechanics.length}},b.filters.byMana=function(){return function(a){switch(b.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===b.filters.mana;case"7+":return a.cost>=7}}},b.getManaCost=function(){switch(b.filters.mana){case"all":return"All";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case"7+":return b.filters.mana}},b.deckTypes=f.deckTypes,b.deckPremium=[{name:"Yes",value:!0},{name:"No",value:!1}],b.deck=b.app.settings.deck&&null!==b.app.settings.deck&&k.className===b.app.settings.deck.playerClass?g["new"](k.className,b.app.settings.deck):g["new"](k.className),b.$watch("deck",function(){b.app.settings.deck={name:b.deck.name,deckType:b.deck.deckType,description:b.deck.description,contentEarly:b.deck.contentEarly,contentMid:b.deck.contentMid,contentLate:b.deck.contentLate,cards:b.deck.cards,playerClass:b.deck.playerClass,arena:b.deck.arena,mulligans:b.deck.mulligans,against:b.deck.against,video:b.deck.video,"public":b.deck["public"]}},!0),b.currentMulligan=b.deck.getMulligan(b.classes[0]),b.setMulligan=function(a){b.currentMulligan=a},b.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length},b.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isPremium=function(){for(var a=b.deck.premium.isPremium,c=0;c<b.premiumTypes.length;c++)if(b.premiumTypes[c].value===a)return b.premiumTypes[c].text},b.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isFeatured=function(){for(var a=b.deck.featured,c=0;c<b.featuredTypes.length;c++)if(b.featuredTypes[c].value===a)return b.featuredTypes[c].text},void(b.saveDeck=function(){j.addDeck(b.deck).success(function(c){c.success?(b.app.settings.deck=null,i.setSuccess({show:!0,msg:b.deck.name+" has been added successfully."}),a.go("app.admin.hearthstone.decks.list")):(b.errors=c.errors,b.showError=!0,d.scrollTo(0,0))})})):(a.transitionTo("app.admin.hearthstone.decks.add"),!1)}]).controller("AdminDeckEditCtrl",["$state","$scope","$compile","$window","Pagination","Hearthstone","DeckBuilder","ImgurService","AlertService","AdminDeckService","data",function(a,b,c,d,e,f,g,h,i,j,k){return k&&k.success?(b.step=1,b.showManaCurve=!1,b.classes=angular.copy(f.classes).splice(1,9),b.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},b.prevStep=function(){b.step>1&&(b.step=b.step-1)},b.nextStep=function(){b.step<5&&(b.step=b.step+1)},b.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},b.className=k.deck.playerClass,b.cards=k.cards,b.cards.current=b.cards["class"],b.pagination=e["new"](6),b.pagination.perpage=10,b.pagination.results=function(){return b.filtered?b.filtered.length:b.cards.current.length},b.filters={search:"",mechanics:[],mana:"all"},b.mechanics=f.mechanics,b.inMechanics=function(a){return b.filters.mechanics.indexOf(a)>=0},b.toggleMechanic=function(a){var c=b.filters.mechanics.indexOf(a);-1===c?b.filters.mechanics.push(a):b.filters.mechanics.splice(c,1)},b.filters.byMechanics=function(){return function(a){if(!b.filters.mechanics.length)return!0;for(var c=0,d=0;d<a.mechanics.length;d++)b.inMechanics(a.mechanics[d])&&c++;return c===b.filters.mechanics.length}},b.filters.byMana=function(){return function(a){switch(b.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===b.filters.mana;case"7+":return a.cost>=7}}},b.deckTypes=f.deckTypes,b.deck=g["new"](k.deck.playerClass,k.deck),b.currentMulligan=b.deck.getMulligan(b.classes[0]),b.setMulligan=function(a){b.currentMulligan=a},b.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length},b.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isPremium=function(){for(var a=b.deck.premium.isPremium,c=0;c<b.premiumTypes.length;c++)if(b.premiumTypes[c].value===a)return b.premiumTypes[c].text},b.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isFeatured=function(){for(var a=b.deck.featured,c=0;c<b.featuredTypes.length;c++)if(b.featuredTypes[c].value===a)return b.featuredTypes[c].text},void(b.updateDeck=function(){j.editDeck(b.deck).success(function(c){c.success?(i.setSuccess({show:!0,msg:b.deck.name+" has been updated successfully."}),a.go("app.admin.hearthstone.decks.list")):(b.errors=c.errors,b.showError=!0,d.scrollTo(0,0))})})):(a.transitionTo("app.admin.hearthstone.decks.list"),!1)}]).controller("AdminUserListCtrl",["$scope","bootbox","Pagination","AlertService","AdminUserService","data",function(a,b,c,d,e,f){d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.users=f.users,a.page=f.page,a.perpage=f.perpage,a.total=f.total,a.search=f.search,a.getUsers=function(){e.getUsers(a.page,a.perpage,a.search).then(function(b){a.users=b.users,a.page=b.page,a.total=b.total})},a.searchUsers=function(){a.page=1,a.getUsers()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getUsers()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteUser=function(c){var d=b.dialog({title:"Delete user: "+c.username+"?",message:"Are you sure you want to delete the user <strong>"+c.username+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){e.deleteUser(c._id).then(function(b){if(b.success){var d=a.users.indexOf(c);-1!==d&&a.users.splice(d,1),a.success={show:!0,msg:c.username+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminUserAddCtrl",["$scope","$state","$window","AdminUserService","AlertService",function(a,b,c,d,e){var f=new Date;f.setMonth(f.getMonth()+1);var g={email:"",username:"",password:"",cpassword:"",about:"",social:{twitter:"",facebook:"",twitch:"",instagram:"",youtube:""},subscription:{isSubscribed:!1,expiryDate:f},isProvider:!1,isAdmin:!1,active:!0};a.user=angular.copy(g),a.userSubscription=a.userProvider=a.userAdmin=a.userActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.dateOptions={},a.addUser=function(){d.addUser(a.user).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.user.username+" has been added successfully."}),b.go("app.admin.users.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminUserEditCtrl",["$scope","$state","$window","AdminUserService","AlertService","data",function(a,b,c,d,e,f){return f&&f.success?(a.user=f.user,a.userSubscription=a.userProvider=a.userAdmin=a.userActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.dateOptions={},void(a.editUser=function(){d.editUser(a.user).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.user.username+" has been updated successfully."}),b.go("app.admin.users.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})})):b.go("app.admin.users.list")}]).controller("AdminPollListCtrl",["$scope","$compile","bootbox","Pagination","AlertService","AdminPollService","data",function(a,b,c,d,e,f,g){e.hasAlert()&&(a.success=e.getSuccess(),e.reset()),a.polls=g.polls,a.page=g.page,a.perpage=g.perpage,a.total=g.total,a.search=g.search,a.getPolls=function(){f.getPolls(a.page,a.perpage,a.search).then(function(b){a.polls=b.polls,a.page=b.page,a.total=b.total})},a.searchPolls=function(){a.page=1,a.getPolls()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getPolls()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deletePoll=function(b){var d=c.dialog({title:"Delete poll: "+b.title+"?",message:"Are you sure you want to delete the poll <strong>"+b.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){f.deletePoll(b._id).then(function(c){if(c.success){var d=a.polls.indexOf(b);-1!==d&&a.polls.splice(d,1),a.success={show:!0,msg:b.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminPollAddCtrl",["$scope","$state","$window","$upload","$compile","AdminPollService","AlertService",function(a,b,c,d,e,f,g){var h,i={title:"",subTitle:"",description:"",type:"",active:!1,view:"",items:[]},j={name:"",orderNum:0,photos:{large:"",thumb:""}};a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.poll=angular.copy(i),a.item=angular.copy(j),a.currentItem=angular.copy(j),a.imgPath="/polls/",a.pollType=[{name:"Image",value:"img"},{name:"Text",value:"txt"}],a.pollView=[{name:"Main",value:"main"},{name:"Sidebar",value:"side"},{name:"Hide",value:"hide"}],a.pollActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],a.voteLimit=function(){for(var b=[],c=0;c<a.poll.items.length;c++)b.push(c+1);return b},a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=d.upload({url:"/api/admin/upload/polls",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.currentItem.photos={large:b.large,thumb:b.thumb},c.modal("hide")})}},a.itemEditWnd=function(b){a.currentItem=b,h=bootbox.dialog({title:"Edit Item",message:e("<div poll-item-edit-form></div>")(a)})},a.editItem=function(){h.modal("hide"),a.currentItem=!1},a.deleteItem=function(b){var c=a.poll.items.indexOf(b);a.poll.items.splice(c,1);for(var d=0;d<a.poll.items.length;d++)a.poll.items[d].orderNum=d+1},a.itemAddWnd=function(){a.currentItem=angular.copy(a.item),h=bootbox.dialog({title:"Add Item",message:e("<div poll-item-add-form></div>")(a)})},a.addItem=function(){a.currentItem.orderNum=a.poll.items.length+1,a.poll.items.push(a.currentItem),h.modal("hide"),a.currentItem=!1},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.getImage=function(){return a.currentItem.photos&&""===a.currentItem.photos.thumb?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.currentItem.photos.thumb},a.addPoll=function(){f.addPoll(a.poll).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.poll.title+" has been added successfully."}),b.go("app.admin.polls.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminPollEditCtrl",["$scope","$state","$window","$compile","$upload","AdminPollService","AlertService","data",function(a,b,c,d,e,f,g,h){var i,j={name:"",orderNum:0,photos:{large:"",thumb:""}};a.options={disableDragAndDrop:!0,height:300,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.poll=h.poll,a.item=angular.copy(j),a.currentItem=angular.copy(j),a.imgPath="/polls/",a.pollType=[{name:"Image",value:"img"},{name:"Text",value:"txt"}],a.pollView=[{name:"Main",value:"main"},{name:"Sidebar",value:"side"},{name:"Hide",value:"hide"}],a.pollActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],a.voteLimit=function(){for(var b=[],c=0;c<a.poll.items.length;c++)b.push(c+1);return b},a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:d('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=e.upload({url:"/api/admin/upload/polls",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.currentItem.photos={large:b.large,thumb:b.thumb},c.modal("hide")})}},a.itemEditWnd=function(b){a.currentItem=b,i=bootbox.dialog({title:"Edit Item",message:d("<div poll-item-edit-form></div>")(a)})},a.editItem=function(){i.modal("hide"),a.currentItem=!1},a.deleteItem=function(b){var c=a.poll.items.indexOf(b);a.poll.items.splice(c,1);for(var d=0;d<a.poll.items.length;d++)a.poll.items[d].orderNum=d+1},a.itemAddWnd=function(){a.currentItem=angular.copy(a.item),i=bootbox.dialog({title:"Add Item",message:d("<div poll-item-add-form></div>")(a)})},a.addItem=function(){a.currentItem.orderNum=a.poll.items.length+1,a.poll.items.push(a.currentItem),i.modal("hide"),a.currentItem=!1},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.getImage=function(){return a.currentItem?a.currentItem.photos&&""===a.currentItem.photos.thumb?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.currentItem.photos.thumb:"/img/blank.png"},a.editPoll=function(){a.showError=!1,f.editPoll(a.poll).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.poll.title+" has been updated successfully."}),b.go("app.admin.polls.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminBannerListCtrl",["$scope","$compile","bootbox","Pagination","AlertService","AdminBannerService","data",function(a,b,c,d,e,f,g){e.hasAlert()&&(a.success=e.getSuccess(),e.reset()),a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1;f.updateOrder(a)},a.tsBanners=g.tsBanners,a.hsBanners=g.hsBanners,a.hotsBanners=g.hotsBanners,a.page=g.page,a.perpage=g.perpage,a.total=g.total,a.search=g.search,a.getBanners=function(){f.getBanners(a.page,a.perpage,a.search).then(function(b){a.banners=b.banners,a.page=b.page,a.total=b.total})},a.deleteBanner=function(b,d){console.log(d._id);var e=c.dialog({title:"Delete banner: "+d.title+"?",message:"Are you sure you want to delete the banner <strong>"+d.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){f.deleteBanner(d._id).then(function(c){if(c.success){console.log(a.banners);var e=a[b],f=e.indexOf(d);-1!==f&&e.splice(f,1),a.success={show:!0,msg:d.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("AdminBannerAddCtrl",["$scope","$state","$window","$upload","$compile","AdminBannerService","AlertService",function(a,b,c,d,e,f,g){var h={title:"",description:"",bannerType:"ts",active:!1,photo:"",button:{hasButton:!1,buttonText:"",buttonLink:""}};a.descriptionMax=250,a.hasButton=!1,a.summerNoteIsFull=function(b){console.log(a.maxDescription-a.banner.description.length+" "+b)},a.options={disableDragAndDrop:!0,height:100,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},a.banner=angular.copy(h),a.imgPath="/banners/",a.bannerTypes=[{name:"TempoStorm",value:"ts"},{name:"Hearthstone",value:"hs"},{name:"Heroes of the Storm",value:"hots"}],a.bannerActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],a.photoUpload=function(b){if(!b.length)return!1;var c=bootbox.dialog({message:e('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(a),closeButton:!1,animate:!1});a.uploading=0,c.modal("show");for(var f=0;f<b.length;f++){var g=b[f];a.upload=d.upload({url:"/api/admin/upload/banners",method:"POST",file:g}).progress(function(b){a.uploading=parseInt(100*b.loaded/b.total)}).success(function(b,d,e,f){a.banner.photo=b.large,c.modal("hide")})}},a.getImage=function(){return a.imgPath="/banners/",""===a.banner.photo?a.app.cdn+"/img/blank.png":a.app.cdn+a.imgPath+a.banner.photo},a.addBanner=function(){f.addBanner(a.banner).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.banner.title+" has been added successfully."}),b.go("app.admin.banners.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminBannerEditCtrl",["$window","$scope","$state","$compile","$upload","AlertService","data","AdminBannerService","$q",function(a,b,c,d,e,f,g,h,i){b.banner=g.banner,b.bannerTypes=[{name:"TempoStorm",value:"ts"},{name:"Hearthstone",value:"hs"},{name:"Heroes of the Storm",value:"hots"}],b.bannerActive=[{name:"Yes",value:"true"},{name:"No",value:"false"}],b.descriptionMax=250,b.summerNoteIsFull=function(){console.log(b.banner.description.length)},b.options={disableDragAndDrop:!0,height:100,fontNames:["Open Sans Regular","Open Sans Bold"],defaultFontName:"Open Sans Regular",toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo","codeview"]]]},b.photoUpload=function(a){if(!a.length)return!1;var c=bootbox.dialog({message:d('<div class="progress progress-striped active" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="{{uploading}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploading}}%;"><span class="sr-only">{{uploading}}% Complete</span></div></div>')(b),closeButton:!1,animate:!1});b.uploading=0,c.modal("show");for(var f=0;f<a.length;f++){var g=a[f];b.upload=e.upload({url:"/api/admin/upload/banners",method:"POST",file:g}).progress(function(a){b.uploading=parseInt(100*a.loaded/a.total)}).success(function(a,d,e,f){b.banner.photo=a.large,c.modal("hide")})}},b.getImage=function(){return b.imgPath="/banners/",""===b.banner.photo?b.app.cdn+"/img/blank.png":b.app.cdn+b.imgPath+b.banner.photo},b.editBanner=function(){b.showError=!1,h.editBanner(b.banner).success(function(d){d.success?(f.setSuccess({show:!0,msg:b.banner.title+" has been updated successfully."}),c.go("app.admin.banners.list")):(b.errors=d.errors,b.showError=!0,a.scrollTo(0,0))})}}]).controller("DeckBuilderCtrl",["$state","$scope","$compile","$window","Pagination","Hearthstone","DeckBuilder","ImgurService","UserService","AuthenticationService","SubscriptionService","data",function(a,b,c,d,e,f,g,h,i,j,k,l){if(!l||!l.success)return a.transitionTo("app.hs.deckBuilder.class"),!1;b.step=1,b.showManaCurve=!1,b.classes=angular.copy(f.classes).splice(1,9),b.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},b.prevStep=function(){b.step>1&&(b.step=b.step-1)},b.nextStep=function(){b.step<5&&(b.step=b.step+1)},b.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},b.className=l.className,b.cards=l.cards,b.cards.current=b.cards["class"],b.pagination=e["new"](6),b.pagination.perpage=10,b.pagination.results=function(){return b.filtered?b.filtered.length:b.cards.current.length},b.filters={search:"",mechanics:[],mana:"all"},b.mechanics=f.mechanics,b.inMechanics=function(a){return b.filters.mechanics.indexOf(a)>=0},b.toggleMechanic=function(a){var c=b.filters.mechanics.indexOf(a);-1===c?b.filters.mechanics.push(a):b.filters.mechanics.splice(c,1)},b.filters.byMechanics=function(){return function(a){if(!b.filters.mechanics.length)return!0;for(var c=0,d=0;d<a.mechanics.length;d++)b.inMechanics(a.mechanics[d])&&c++;return c===b.filters.mechanics.length}},b.filters.byMana=function(){return function(a){switch(b.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===b.filters.mana;case"7+":return a.cost>=7}}},b.getManaCost=function(){switch(b.filters.mana){case"all":return"All";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case"7+":return b.filters.mana}},b.deckTypes=f.deckTypes,b.deck=b.app.settings.deck&&null!==b.app.settings.deck&&l.className===b.app.settings.deck.playerClass?g["new"](l.className,b.app.settings.deck):g["new"](l.className),b.$watch("deck",function(){b.app.settings.deck={name:b.deck.name,deckType:b.deck.deckType,description:b.deck.description,contentEarly:b.deck.contentEarly,contentMid:b.deck.contentMid,contentLate:b.deck.contentLate,cards:b.deck.cards,playerClass:b.deck.playerClass,arena:b.deck.arena,mulligans:b.deck.mulligans,against:b.deck.against,video:b.deck.video,"public":b.deck["public"]}},!0),b.currentMulligan=b.deck.getMulligan(b.classes[0]),b.setMulligan=function(a){b.currentMulligan=a},b.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length},b.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isPremium=function(){for(var a=b.deck.premium.isPremium,c=0;c<b.premiumTypes.length;c++)if(b.premiumTypes[c].value===a)return b.premiumTypes[c].text},b.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isFeatured=function(){for(var a=b.deck.featured,c=0;c<b.featuredTypes.length;c++)if(b.featuredTypes[c].value===a)return b.featuredTypes[c].text};var m;b.saveDeck=function(){b.app.user.isLogged()?g.saveDeck(b.deck).success(function(c){c.success?(b.app.settings.deck=null,a.transitionTo("app.hs.decks.deck",{slug:c.slug})):(b.errors=c.errors,b.showError=!0,d.scrollTo(0,0))}):(m=bootbox.dialog({title:"Login Required",message:c("<div login-form></div>")(b)}),m.modal("show"))},b.login=function(a,c){void 0!==a&&void 0!==c&&i.login(a,c).success(function(a){j.setLogged(!0),j.setAdmin(a.isAdmin),j.setProvider(a.isProvider),k.setSubscribed(a.subscription.isSubscribed),k.setTsPlan(a.subscription.plan),k.setExpiry(a.subscription.expiry),d.sessionStorage.userID=a.userID,d.sessionStorage.username=a.username,d.sessionStorage.email=a.email,b.app.settings.token=d.sessionStorage.token=a.token,m.modal("hide"),b.saveDeck()}).error(function(){b.showError=!0})}}]).controller("DeckEditCtrl",["$state","$scope","$compile","$window","Pagination","Hearthstone","DeckBuilder","ImgurService","UserService","AuthenticationService","data",function(a,b,c,d,e,f,g,h,i,j,k){return k&&k.success?(b.step=1,b.showManaCurve=!1,b.classes=angular.copy(f.classes).splice(1,9),b.stepDesc={1:"Select the cards for your deck.",2:"Select which cards to mulligan for.",3:"Provide a description for how to play your deck.",4:"Select how your deck preforms against other classes.",5:"Provide a synopsis and title for your deck."},b.prevStep=function(){b.step>1&&(b.step=b.step-1)},b.nextStep=function(){b.step<5&&(b.step=b.step+1)},b.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},b.className=k.deck.playerClass,b.cards=k.cards,b.cards.current=b.cards["class"],b.pagination=e["new"](6),b.pagination.perpage=10,b.pagination.results=function(){return b.filtered?b.filtered.length:b.cards.current.length},b.filters={search:"",mechanics:[],mana:"all"},b.mechanics=f.mechanics,b.inMechanics=function(a){return b.filters.mechanics.indexOf(a)>=0},b.toggleMechanic=function(a){var c=b.filters.mechanics.indexOf(a);-1===c?b.filters.mechanics.push(a):b.filters.mechanics.splice(c,1);
},b.filters.byMechanics=function(){return function(a){if(!b.filters.mechanics.length)return!0;for(var c=0,d=0;d<a.mechanics.length;d++)b.inMechanics(a.mechanics[d])&&c++;return c===b.filters.mechanics.length}},b.filters.byMana=function(){return function(a){switch(b.filters.mana){case"all":return!0;case 0:case 1:case 2:case 3:case 4:case 5:case 6:return a.cost===b.filters.mana;case"7+":return a.cost>=7}}},b.deckTypes=f.deckTypes,b.deck=g["new"](k.deck.playerClass,k.deck),b.currentMulligan=b.deck.getMulligan(b.classes[0]),b.setMulligan=function(a){b.currentMulligan=a},b.isMulliganSet=function(a){return a.withCoin.cards.length||a.withCoin.instructions.length||a.withoutCoin.cards.length||a.withoutCoin.instructions.length},b.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isPremium=function(){for(var a=b.deck.premium.isPremium,c=0;c<b.premiumTypes.length;c++)if(b.premiumTypes[c].value===a)return b.premiumTypes[c].text},b.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],b.isFeatured=function(){for(var a=b.deck.featured,c=0;c<b.featuredTypes.length;c++)if(b.featuredTypes[c].value===a)return b.featuredTypes[c].text},void(b.updateDeck=function(){g.updateDeck(b.deck).success(function(c){c.success?a.transitionTo("app.hs.decks.deck",{slug:c.slug}):(b.errors=c.errors,b.showError=!0,d.scrollTo(0,0))})})):(a.transitionTo("app.home"),!1)}]).controller("ArticlesCtrl",["$scope","$state","ArticleService","data","MetaService",function(a,b,c,d,e){a.articles=d.articles,a.total=d.total,a.articleType=d.articleType,a.filter=d.filter,a.page=parseInt(d.page),a.perpage=d.perpage,a.search=d.search,a.loading=!1,a.metaservice=e,a.metaservice.setOg("https://tempostorm.com/articles"),a.hasSearch=function(){return d.search?d.search.length:!1},a.setKlass=function(b){a.filter=b,a.page=1,a.getArticles()},a.getArticles=function(){var c={};a.search&&(c.s=a.search),1!==a.page&&(c.p=a.page),"all"!=a.articleType&&(c.t=a.articleType),"all"!=a.filter&&(c.f=a.filter),a.loading=!0,b.transitionTo("app.articles.list",c)},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getArticles()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):1}},(a.page<1||a.page>a.pagination.totalPages())&&a.pagination.setPage(1)}]).controller("ArticleCtrl",["$scope","$sce","data","$state","$compile","$window","bootbox","UserService","ArticleService","AuthenticationService","VoteService","SubscriptionService","MetaService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}b(a.article)}function o(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return g.alert("You can't vote for your own content."),!1;k.voteArticle(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else r=g.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),r.modal("show"),s=function(){o(b,c)}}function p(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.article.comments.forEach(b)}a.article=c.article,a.isPremium=function(){if(!a.article.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.article.premium.expiryDate).getTime();return c>b?!0:!1},a.metaservice=m,a.metaservice.set(a.article.title+" - Articles",a.article.description);var q="https://s3-us-west-2.amazonaws.com/ts-node2/articles/"+a.article.photos.small;a.metaservice.setOg("https://tempostorm.com/hearthstone/articles/"+c.article.slug.url,a.article.title,a.article.description,"article",q),a.getContent=function(){return b.trustAsHtml(a.article.content)},a.app.settings.show.article||(a.app.settings.show.article={related:!0,comments:!0}),a.show=a.app.settings.show.article,a.$watch("show",function(){a.app.settings.show.article=a.show},!0),a.getDust=function(){for(var b=0,c=0;c<a.article.deck.cards.length;c++)b+=a.article.deck.cards[c].qty*a.article.deck.cards[c].card.dust;return b},a.relatedActive=function(){var b=a.article.related;if(!b||!b.length)return!1;for(var c=0;c<b.length;c++)if(b[c].active)return!0;return!1},a.voteDown=function(a){o(-1,a)},a.voteUp=function(a){o(1,a)};var r,s;a.app.user.isLogged()&&n();var t={comment:""};a.comment=angular.copy(t),a.commentPost=function(){a.app.user.isLogged()?i.addComment(a.article,a.comment).success(function(b){b.success&&(a.article.comments.push(b.comment),a.comment.comment="")}):(r=g.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),r.modal("show"),s=function(){a.commentPost()})},a.app.user.isLogged()&&p(),a.voteComment=function(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return g.alert("You can't vote for your own content."),!1;k.voteComment(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else r=g.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),r.modal("show"),s=function(){a.voteComment(b,deck)}},a.getPremium=function(b){a.app.user.isLogged()?a.app.user.isSubscribed()||d.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:b}):(r=g.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),r.modal("show"),s=function(){a.getPremium(b)})},a.login=function(b,c){void 0!==b&&void 0!==c&&h.login(b,c).success(function(b){j.setLogged(!0),j.setAdmin(b.isAdmin),j.setProvider(b.isProvider),l.setSubscribed(b.subscription.isSubscribed),l.setTsPlan(b.subscription.plan),l.setExpiry(b.subscription.expiry),f.sessionStorage.userID=b.userID,f.sessionStorage.username=b.username,f.sessionStorage.email=b.email,a.app.settings.token=f.sessionStorage.token=b.token,r.modal("hide"),n(),p(),s()}).error(function(){a.showError=!0})}}]).controller("DecksCtrl",["$scope","$state","Hearthstone","DeckService","data",function(a,b,c,d,e){return e.success?(a.decks=e.decks,a.total=e.total,a.klass=e.klass,a.page=parseInt(e.page),a.perpage=e.perpage,a.search=e.search,a.age=e.age,a.order=e.order,a.hasSearch=function(){return e.search?e.search.length:!1},a.metaservice.setOg("https://tempostorm.com/decks"),a.app.settings.show.decks||(a.app.settings.show.decks={advanced:!1}),a.toggleAdvanced=function(){a.app.settings.show.decks.advanced=!a.app.settings.show.decks.advanced},a.showAdvanced=function(){return a.app.settings.show.decks.advanced},a.loading=!1,a.setKlass=function(b){a.klass=b,a.page=1,a.getDecks()},a.getFilter=function(b,c){for(var d=a.filters.all[b],e=0;e<d.length;e++)if(d[e].value==c)return d[e];return d[0]},a.filters={all:{age:[{name:"All Decks",value:"all"},{name:"7 Days",value:"7"},{name:"15 Days",value:"15"},{name:"30 Days",value:"30"},{name:"60 Days",value:"60"},{name:"90 Days",value:"90"}],order:[{name:"Highest Ranked",value:"high"},{name:"Lowest Ranked",value:"low"},{name:"Newest Decks",value:"new"},{name:"Oldest Decks",value:"old"}]}},a.filters.age=a.getFilter("age",a.age),a.filters.order=a.getFilter("order",a.order),a.getDecks=function(){var c={};a.search&&(c.s=a.search),1!==a.page&&(c.p=a.page),"all"!=a.klass&&(c.k=a.klass),"all"!==a.filters.age.value&&(c.a=a.filters.age.value),"high"!==a.filters.order.value&&(c.o=a.filters.order.value),a.loading=!0,b.transitionTo("app.hs.decks.list",c)},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getDecks()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):1}},void((a.page<1||a.page>a.pagination.totalPages())&&a.pagination.setPage(1))):b.transitionTo("app.hs.decks.list")}]).controller("DeckCtrl",["$scope","$state","$sce","$compile","$window","bootbox","Hearthstone","UserService","DeckService","AuthenticationService","VoteService","SubscriptionService","data","MetaService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}b(a.deck)}function p(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;k.voteDeck(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else s=f.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),s.modal("show"),t=function(){p(b,c)}}function q(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.deck.comments.forEach(b)}if(!m||!m.success)return b.go("app.hs.decks.list");a.deck=m.deck,a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){if(!a.deck.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.deck.premium.expiryDate).getTime();return c>b?!0:!1},a.metaservice=n,a.metaservice.set(a.deck.name+" - Decks",a.deck.description);var r="https://s3-us-west-2.amazonaws.com/ts-node2/img/decks/"+a.deck.playerClass+".png";a.metaservice.setOg("https://tempostorm.com/hearthstone/decks/"+a.deck.slug,a.deck.name,a.deck.description,"article",r.toLowerCase()),a.classes=angular.copy(g.classes).splice(1,9),a.app.settings.show.deck||(a.app.settings.show.deck={mana:!0,description:!0,mulligans:!0,video:!0,matchups:!0,gameplay:!0,stats:!0,comments:!0}),a.show=a.app.settings.show.deck,a.$watch("show",function(){a.app.settings.show.deck=a.show},!0),a.coin=!0,a.toggleCoin=function(){a.coin=!a.coin},a.currentMulligan=!1,a.getMulligan=function(b){for(var c=a.deck.mulligans,d=0;d<c.length;d++)if(c[d].klass===b)return c[d];return!1},a.setMulligan=function(b){a.currentMulligan=b},a.isMulliganSet=function(a){return a.withCoin.cards.length>0||a.withCoin.instructions.length>0||a.withoutCoin.cards.length>0||a.withoutCoin.instructions.length>0},a.anyMulliganSet=function(){for(var b=a.deck.mulligans,c=0;c<b.length;c++)if(a.isMulliganSet(b[c])===!0)return!0;return!1},a.mulliganHide=function(b){if(!a.anyMulliganSet())return!1;if(!a.currentMulligan)return!1;for(var c=a.coin?a.currentMulligan.withCoin.cards:a.currentMulligan.withoutCoin.cards,d=0;d<c.length;d++)if(c[d]._id===b.card._id)return!1;return!0},a.getMulliganInstructions=function(){if(!a.currentMulligan)return!1;var b=a.currentMulligan;return a.coin?b.withCoin.instructions:b.withoutCoin.instructions},a.getMulliganCards=function(){if(!a.currentMulligan)return!1;var b=a.currentMulligan;return a.coin?b.withCoin.cards:b.withoutCoin.cards},a.cardLeft=function(b){return 80/a.getMulliganCards().length*b},a.cardRight=function(){return 80*a.getMulliganCards().length/2},a.hasStrong=function(){for(var b=a.deck.against.strong,c=0;c<b.length;c++)if(b[c].isStrong)return!0;return!1},a.hasWeak=function(){for(var b=a.deck.against.weak,c=0;c<b.length;c++)if(b[c].isWeak)return!0;return!1},a.charts={colors:["rgba(151,187,205,1)","rgba(151,187,205,1)","rgba(151,187,205,1)","rgba(151,187,205,1)"]},a.labels=["Download Sales","In-Store Sales","Mail-Order Sales"],a.data=[300,500,100],a.getVideo=function(){return a.getContent('<iframe src="//www.youtube.com/embed/'+a.deck.video+'" frameborder="0" height="360" width="100%"></iframe>')},a.getContent=function(a){return c.trustAsHtml(a)},a.deck.getDust=function(){for(var b=0,c=0;c<a.deck.cards.length;c++)b+=a.deck.cards[c].qty*a.deck.cards[c].card.dust;return b},a.deck.manaCurve=function(b){for(var c,d=0,e=0;7>=e;e++)c=a.deck.manaCount(e),c>d&&(d=c);return 0===d?0:Math.ceil(a.deck.manaCount(b)/d*98)},a.deck.manaCount=function(b){for(var c=0,d=0;d<a.deck.cards.length;d++)(a.deck.cards[d].card.cost===b||7===b&&a.deck.cards[d].card.cost>=7)&&(c+=a.deck.cards[d].qty);return c},a.voteDown=function(a){p(-1,a)},a.voteUp=function(a){p(1,a)};var s,t;o();var u={comment:""};a.comment=angular.copy(u),a.commentPost=function(){a.app.user.isLogged()?i.addComment(a.deck,a.comment).success(function(b){b.success&&(a.deck.comments.push(b.comment),a.comment.comment="")}):(s=f.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),s.modal("show"),t=function(){a.commentPost()})},q(),a.voteComment=function(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;k.voteComment(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else s=f.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),s.modal("show"),t=function(){a.voteComment(b,deck)}},a.getPremium=function(c){a.app.user.isLogged()?a.app.user.isSubscribed()||b.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:c}):(s=f.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),s.modal("show"),t=function(){a.getPremium(c)})},a.login=function(b,c){void 0!==b&&void 0!==c&&h.login(b,c).success(function(b){j.setLogged(!0),j.setAdmin(b.isAdmin),j.setProvider(b.isProvider),l.setSubscribed(b.subscription.isSubscribed),l.setTsPlan(b.subscription.plan),l.setExpiry(b.subscription.expiry),e.sessionStorage.userID=b.userID,e.sessionStorage.username=b.username,e.sessionStorage.email=b.email,a.app.settings.token=e.sessionStorage.token=b.token,s.modal("hide"),o(),t()}).error(function(){a.showError=!0})}}]).controller("ForumCategoryCtrl",["$scope","data","MetaService",function(a,b,c){a.categories=b.categories,a.metaservice.setOg("https://tempostorm.com/forum")}]).controller("ForumThreadCtrl",["$scope","Pagination","data","MetaService",function(a,b,c,d){a.thread=c.thread,a.metaservice=d,a.metaservice.set(a.thread.title+" - Forum"),a.metaservice.setOg("https://tempostorm.com/forum/"+a.thread.slug.url,a.thread.title),a.pagination=b["new"](20),a.pagination.results=function(){return a.thread.posts.length}}]).controller("ForumAddCtrl",["$scope","$location","$window","$compile","bootbox","ForumService","UserService","AuthenticationService","SubscriptionService","data",function(a,b,c,d,e,f,g,h,i,j){a.thread=j.thread;var k={title:"",content:""};a.post=angular.copy(k),a.options={disableDragAndDrop:!0,height:300,toolbar:[["style",["bold","italic","underline","strikethrough","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]};var l,m;a.addPost=function(){a.app.user.isLogged()?f.addPost(a.thread,a.post).success(function(d){d.success?b.path("/forum/"+a.thread.slug.url):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):(l=e.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),l.modal("show"),m=function(){a.addPost()})},a.login=function(b,d){void 0!==b&&void 0!==d&&g.login(b,d).success(function(b){h.setLogged(!0),h.setAdmin(b.isAdmin),h.setProvider(b.isProvider),i.setSubscribed(b.subscription.isSubscribed),i.setTsPlan(b.subscription.plan),i.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,l.modal("hide"),m()}).error(function(){a.showError=!0})}}]).controller("ForumPostCtrl",["$scope","$sce","$compile","$window","bootbox","ForumService","UserService","AuthenticationService","VoteService","SubscriptionService","data","MetaService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.post.comments.forEach(b)}a.post=k.post,a.thread=k.thread,a.metaservice=l,a.metaservice.set(a.post.title+" - "+a.thread.title),a.metaservice.setOg("https://tempostorm.com/forum/"+a.thread.slug.url+"/"+a.post.slug.url,a.post.title,a.post.content);var n={comment:""};a.comment=angular.copy(n),a.post.getContent=function(){return b.trustAsHtml(a.post.content)};var o,p;a.commentPost=function(){a.app.user.isLogged()?f.addComment(a.post,a.comment).success(function(b){b.success&&(a.post.comments.push(b.comment),a.comment.comment="",m())}):(o=e.dialog({title:"Login Required",message:c("<div login-form></div>")(a)}),o.modal("show"),p=function(){a.commentPost()})},a.app.user.isLogged()&&m(),a.voteComment=function(b,d){if(a.app.user.isLogged()){if(d.author._id===a.app.user.getUserID())return e.alert("You can't vote for your own content."),!1;i.voteComment(b,d).then(function(a){a.success&&(d.voted=b,d.votesCount=a.votesCount)})}else o=e.dialog({title:"Login Required",message:c("<div login-form></div>")(a)}),o.modal("show"),p=function(){a.voteComment(b,d)}},a.login=function(b,c){void 0!==b&&void 0!==c&&g.login(b,c).success(function(b){h.setLogged(!0),h.setAdmin(b.isAdmin),h.setProvider(b.isProvider),j.setSubscribed(b.subscription.isSubscribed),j.setTsPlan(b.subscription.plan),j.setExpiry(b.subscription.expiry),d.sessionStorage.userID=b.userID,d.sessionStorage.username=b.username,d.sessionStorage.email=b.email,a.app.settings.token=d.sessionStorage.token=b.token,o.modal("hide"),p()}).error(function(){a.showError=!0})}}]).controller("AdminForumStructureListCtrl",["$scope","bootbox","AlertService","AdminForumService","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.categories=e.categories,a.deleteCategory=function(c){var e=b.dialog({title:"Delete category: "+c.title+"?",message:"Are you sure you want to delete the category <strong>"+c.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){d.deleteCategory(c._id).then(function(b){if(b.success){var d=a.categories.indexOf(c);-1!==d&&a.categories.splice(d,1),a.success={show:!0,msg:c.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")},a.deleteThread=function(c){var e=b.dialog({title:"Delete thread: "+c.title+"?",message:"Are you sure you want to delete the thread <strong>"+c.title+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){d.deleteThread(c._id,c.category).then(function(b){if(b.success){var d=a.threads.indexOf(c);-1!==d&&a.threads.splice(d,1),a.success={show:!0,msg:c.title+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){e.modal("hide")}}}});e.modal("show")}}]).controller("AdminForumCategoryAddCtrl",["$scope","$state","$window","AdminForumService","AlertService",function(a,b,c,d,e){var f={title:"",active:!0};a.category=angular.copy(f),a.categoryActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.addCategory=function(){a.showError=!1,d.addCategory(a.category).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.category.title+" has been added successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminForumCategoryEditCtrl",["$scope","$state","$window","AdminForumService","AlertService","data",function(a,b,c,d,e,f){a.category=f.category,a.categoryActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.editCategory=function(){a.showError=!1,d.editCategory(a.category).success(function(d){d.success?(e.setSuccess({show:!0,msg:a.category.title+" has been updated successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminForumThreadAddCtrl",["$scope","$state","$window","Util","AdminForumService","AlertService","data",function(a,b,c,d,e,f,g){var h={category:g.categories[0]._id||"",title:"",description:"",slug:{url:"",linked:!0},active:!0};a.thread=angular.copy(h),a.setSlug=function(){return a.thread.slug.linked?void(a.thread.slug.url=d.slugify(a.thread.title)):!1},a.toggleSlugLink=function(){a.thread.slug.linked=!a.thread.slug.linked,a.setSlug()},a.selectCategories=g.categories,a.threadActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.addThread=function(){a.showError=!1,e.addThread(a.thread).success(function(d){d.success?(f.setSuccess({show:!0,msg:a.thread.title+" has been added successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminForumThreadEditCtrl",["$scope","$state","$window","Util","AdminForumService","AlertService","dataCategories","dataThread",function(a,b,c,d,e,f,g,h){a.thread=h.thread,a.setSlug=function(){return a.thread.slug.linked?void(a.thread.slug.url=d.slugify(a.thread.title)):!1},a.toggleSlugLink=function(){a.thread.slug.linked=!a.thread.slug.linked,a.setSlug()},a.selectCategories=g.categories,a.threadActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.editThread=function(){a.showError=!1,e.editThread(a.thread).success(function(d){d.success?(f.setSuccess({show:!0,msg:a.thread.title+" has been updated successfully."}),b.go("app.admin.forum.categories.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("Twitch",["$scope",function(a){a.login=function(){window.location.replace("/auth/twitch")},a.signup=function(){window.location.replace("/auth/twitch")}}]).controller("Bnet",["$scope",function(a){a.login=function(){window.location.replace("/auth/bnet")}}]).controller("AdminHeroListCtrl",["$scope","AdminHeroService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.heroes=e.heroes,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getHeroes=function(){b.getHeroes(a.page,a.perpage,a.search).then(function(b){a.heroes=b.heroes,a.page=b.page,a.total=b.total})},a.searchHeroes=function(){a.page=1,a.getHeroes()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getHeroes()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteHero=function(c){var d=bootbox.dialog({title:"Delete hero: "+c.name+"?",message:"Are you sure you want to delete the hero <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteHero(c._id).then(function(b){if(b.success){var d=a.heroes.indexOf(c);-1!==d&&a.heroes.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminHeroAddCtrl",["$scope","$state","$window","$compile","bootbox","Util","HOTS","AlertService","AdminHeroService",function(a,b,c,d,e,f,g,h,i){var j={name:"",description:"",title:"",role:g.roles[0],heroType:g.types[0],universe:g.universes[0],manaType:g.manaTypes[0],abilities:[],talents:[],characters:[],price:{gold:""},className:"",active:!0},k={name:"",abilityType:g.abilityTypes[0],mana:"",cooldown:"",description:"",damage:"",healing:"",className:"",orderNum:1},l={name:"",tier:g.tiers[0],description:"",ability:null,className:"",orderNum:1},m={name:"",stats:{base:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0},gain:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0}}};a.hero=angular.copy(j),a.roles=g.roles,a.heroTypes=g.types,a.universes=g.universes,a.manaTypes=g.manaTypes,a.heroActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.abilityTypes=g.abilityTypes;var n;a.abilityAddWnd=function(){a.currentAbility=angular.copy(k),f.getObjectID().success(function(b){b.success&&(a.currentAbility._id=b.id,n=e.dialog({title:"Add Ability",message:d("<div ability-add-form></div>")(a)}))})},a.abilityEditWnd=function(b){a.currentAbility=b,n=e.dialog({title:"Edit Ability",message:d("<div ability-edit-form></div>")(a)})},a.addAbility=function(){a.currentAbility.orderNum=a.hero.abilities.length+1,a.hero.abilities.push(a.currentAbility),n.modal("hide"),a.currentAbility=!1,console.log(a.hero.abilities)},a.editAbility=function(b){n.modal("hide"),a.currentAbility=!1},a.deleteAbility=function(b){var c=a.hero.abilities.indexOf(b);a.hero.abilities.splice(c,1);for(var d=0;d<a.hero.abilities.length;d++)a.hero.abilities[d].orderNum=d+1;console.log(a.hero.abilities)},a.talentTiers=g.tiers,a.talentAddWnd=function(){a.currentTalent=angular.copy(l),a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Add Talent",message:d("<div talent-add-form></div>")(a)})},a.talentEditWnd=function(b){a.currentTalent=b,a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Edit Talent",message:d("<div talent-edit-form></div>")(a)})},a.addTalent=function(){a.currentTalent.orderNum=a.hero.talents.length+1,a.hero.talents.push(a.currentTalent),n.modal("hide"),a.currentTalent=!1,console.log(a.hero.talents)},a.editTalent=function(b){n.modal("hide"),a.currentAbility=!1},a.deleteTalent=function(b){var c=a.hero.talents.indexOf(b);a.hero.talents.splice(c,1);for(var d=0;d<a.hero.talents.length;d++)a.hero.talents[d].orderNum=d+1;console.log(a.hero.talents)},a.charAddWnd=function(){console.log("blah"),a.currentCharacter=angular.copy(m),n=e.dialog({title:"Add Character",message:d("<div char-add-form></div>")(a)})},a.charEditWnd=function(b){a.currentCharacter=b,n=e.dialog({title:"Edit Character",message:d("<div char-edit-form></div>")(a)})},a.addCharacter=function(){a.hero.characters.push(a.currentCharacter),n.modal("hide"),a.currentCharacter=!1},a.editCharacter=function(b){n.modal("hide"),a.currentCharacter=!1},a.deleteChar=function(b){var c=a.hero.characters.indexOf(b);a.hero.characters.splice(c,1)},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.addHero=function(){a.showError=!1,i.addHero(a.hero).success(function(d){d.success?(h.setSuccess({show:!0,msg:a.hero.name+" has been added successfully."}),b.go("app.admin.hots.heroes.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminHeroEditCtrl",["$scope","$state","$window","$compile","bootbox","Util","HOTS","AlertService","AdminHeroService","data",function(a,b,c,d,e,f,g,h,i,j){var k={name:"",abilityType:g.abilityTypes[0],mana:"",cooldown:"",description:"",damage:"",healing:"",className:"",orderNum:1},l={name:"",tier:g.tiers[0],description:"",ability:null,className:"",orderNum:1},m={name:"",stats:{base:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0},gain:{health:0,healthRegen:0,mana:0,manaRegen:0,attackSpeed:0,range:0,damage:0}}};a.hero=j.hero,a.roles=g.roles,a.heroTypes=g.types,a.universes=g.universes,a.manaTypes=g.manaTypes,a.heroActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.abilityTypes=g.abilityTypes;var n;a.abilityAddWnd=function(){a.currentAbility=angular.copy(k),f.getObjectID().success(function(b){b.success&&(a.currentAbility._id=b.id,n=e.dialog({title:"Add Ability",message:d("<div ability-add-form></div>")(a)}))})},a.abilityEditWnd=function(b){a.currentAbility=b,n=e.dialog({title:"Edit Ability",message:d("<div ability-edit-form></div>")(a)})},a.addAbility=function(){a.currentAbility.orderNum=a.hero.abilities.length+1,a.hero.abilities.push(a.currentAbility),n.modal("hide"),a.currentAbility=!1,console.log(a.hero.abilities)},a.editAbility=function(b){n.modal("hide"),a.currentAbility=!1},a.deleteAbility=function(b){var c=a.hero.abilities.indexOf(b);a.hero.abilities.splice(c,1);for(var d=0;d<a.hero.abilities.length;d++)a.hero.abilities[d].orderNum=d+1;console.log(a.hero.abilities)},a.talentTiers=g.tiers,a.talentAddWnd=function(){a.currentTalent=angular.copy(l),a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Add Talent",message:d("<div talent-add-form></div>")(a)})},a.talentEditWnd=function(b){a.currentTalent=b,a.talentAbilities=[{_id:void 0,name:"None"}].concat(a.hero.abilities),n=e.dialog({title:"Edit Talent",message:d("<div talent-edit-form></div>")(a)})},a.addTalent=function(){a.currentTalent.orderNum=a.hero.talents.length+1,a.hero.talents.push(a.currentTalent),n.modal("hide"),a.currentTalent=!1},a.editTalent=function(b){n.modal("hide"),a.currentTalent=!1},a.deleteTalent=function(b){var c=a.hero.talents.indexOf(b);a.hero.talents.splice(c,1);for(var d=0;d<a.hero.talents.length;d++)a.hero.talents[d].orderNum=d+1},a.charAddWnd=function(){a.currentCharacter=angular.copy(m),n=e.dialog({title:"Add Character",message:d("<div char-add-form></div>")(a)})},a.charEditWnd=function(b){a.currentCharacter=b,n=e.dialog({title:"Edit Character",message:d("<div char-edit-form></div>")(a)})},a.addCharacter=function(){a.hero.characters.push(a.currentCharacter),n.modal("hide"),a.currentCharacter=!1},a.editCharacter=function(b){n.modal("hide"),a.currentCharacter=!1},a.deleteChar=function(b){var c=a.hero.characters.indexOf(b);a.hero.characters.splice(c,1)},a.updateDND=function(a,b){a.splice(b,1);for(var c=0;c<a.length;c++)a[c].orderNum=c+1},a.editHero=function(){a.showError=!1,i.editHero(a.hero).success(function(d){d.success?(h.setSuccess({show:!0,msg:a.hero.name+" has been updated successfully."}),b.go("app.admin.hots.heroes.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminMapsListCtrl",["$scope","AdminMapService","AlertService","Pagination","data",function(a,b,c,d,e){c.hasAlert()&&(a.success=c.getSuccess(),c.reset()),a.maps=e.maps,a.page=e.page,a.perpage=e.perpage,a.total=e.total,a.search=e.search,a.getMaps=function(){b.getMaps(a.page,a.perpage,a.search).then(function(b){a.maps=b.maps,a.page=b.page,a.total=b.total})},a.searchMaps=function(){a.page=1,a.getMaps()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getMaps()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.deleteMap=function(c){var d=bootbox.dialog({title:"Delete map: "+c.name+"?",message:"Are you sure you want to delete the map <strong>"+c.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){b.deleteMap(c._id).then(function(b){if(b.success){var d=a.maps.indexOf(c);-1!==d&&a.maps.splice(d,1),a.success={show:!0,msg:c.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminMapAddCtrl",["$scope","$state","$window","$compile","bootbox","HOTS","AlertService","AdminMapService",function(a,b,c,d,e,f,g,h){var i={name:"",description:"",className:"",active:!0};a.map=angular.copy(i),a.mapActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.addMap=function(){a.showError=!1,h.addMap(a.map).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.map.name+" has been added successfully."}),
b.go("app.admin.hots.maps.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminMapEditCtrl",["$scope","$state","$window","$compile","bootbox","HOTS","AlertService","AdminMapService","data",function(a,b,c,d,e,f,g,h,i){a.map=i.map,a.mapActive=[{name:"Yes",value:!0},{name:"No",value:!1}],a.editMap=function(){a.showError=!1,h.editMap(a.map).success(function(d){d.success?(g.setSuccess({show:!0,msg:a.map.name+" has been updated successfully."}),b.go("app.admin.hots.maps.list")):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))})}}]).controller("AdminHOTSGuideListCtrl",["$scope","$state","AdminHOTSGuideService","AlertService","Pagination","data",function(a,b,c,d,e,f){d.hasAlert()&&(a.success=d.getSuccess(),d.reset()),a.guides=f.guides,a.page=f.page,a.perpage=f.perpage,a.total=f.total,a.search=f.search,a.getGuides=function(){c.getGuides(a.page,a.perpage,a.search).then(function(b){a.guides=b.guides,a.page=b.page,a.total=b.total})},a.searchGuides=function(){a.page=1,a.getGuides()},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getGuides()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):0},from:function(){return this.page()*this.perpage()-this.perpage()+1},to:function(){return this.page()*this.perpage()>this.results()?this.results():this.page()*this.perpage()}},a.editGuide=function(a){return"hero"===a.guideType?b.go("app.admin.hots.guides.edit.hero",{guideID:a._id}):b.go("app.admin.hots.guides.edit.map",{guideID:a._id})},a.deleteGuide=function(b){var d=bootbox.dialog({title:"Delete guide: "+b.name+"?",message:"Are you sure you want to delete the guide <strong>"+b.name+"</strong>?",buttons:{"delete":{label:"Delete",className:"btn-danger",callback:function(){c.deleteGuide(b._id).then(function(c){if(c.success){var d=a.guides.indexOf(b);-1!==d&&a.guides.splice(d,1),a.success={show:!0,msg:b.name+" deleted successfully."}}})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){d.modal("hide")}}}});d.modal("show")}}]).controller("AdminHOTSGuideAddHeroCtrl",["$scope","$state","AlertService","AdminHOTSGuideService","GuideBuilder","HOTS","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h){a.guide=a.app.settings.guide&&"hero"===a.app.settings.guide.guideType?e["new"]("hero",a.app.settings.guide):e["new"]("hero"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=g.heroes,a.maps=h.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.add.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.add.step1",{})};var i=f.heroRows;a.heroRows=[];for(var j=0,k=0;k<i.length;k++){for(var l=[],m=0;m<i[k];m++)l.push(g.heroes[j]?g.heroes[j]:{}),j++;a.heroRows.push(l)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"};var n=[4,3];a.mapRows=[];for(var j=0,k=0;k<n.length;k++){for(var o=[],m=0;m<n[k];m++)h.maps[j]&&o.push(h.maps[j]),j++;a.mapRows.push(o)}a.getTalents=function(b){return a.guide.sortTalents(b)},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void d.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,c.setSuccess({show:!0,msg:a.guide.name+" has been added successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=d.errors,a.showError=!0,$window.scrollTo(0,0))}):!1}}]).controller("AdminHOTSGuideAddMapCtrl",["$scope","$state","AlertService","AdminHOTSGuideService","GuideBuilder","dataHeroes","dataMaps",function(a,b,c,d,e,f,g){a.guide=a.app.settings.guide&&"map"===a.app.settings.guide.guideType?e["new"]("map",a.app.settings.guide):e["new"]("map"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=f.heroes,a.maps=g.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.add.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.add.step1",{})};var h=[4,3];a.mapRows=[];for(var i=0,j=0;j<h.length;j++){for(var k=[],l=0;l<h[j];l++)g.maps[i]&&k.push(g.maps[i]),i++;a.mapRows.push(k)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void d.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,c.setSuccess({show:!0,msg:a.guide.name+" has been added successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=d.errors,a.showError=!0,$window.scrollTo(0,0))}):!1}}]).controller("AdminHOTSGuideEditStep1Ctrl",["$scope","dataGuide",function(a,b){a.guide=b.guide}]).controller("AdminHOTSGuideEditHeroCtrl",["$scope","$state","$window","AlertService","GuideBuilder","AdminHOTSGuideService","HOTS","dataGuide","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h,i,j){a.guide=e["new"]("hero",h.guide),a.heroes=i.heroes,a.maps=j.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id})};var k=g.heroRows;a.heroRows=[];for(var l=0,m=0;m<k.length;m++){for(var n=[],o=0;o<k[m];o++)n.push(i.heroes[l]?i.heroes[l]:{}),l++;a.heroRows.push(n)}var p=[4,3];a.mapRows=[];for(var l=0,m=0;m<p.length;m++){for(var q=[],o=0;o<p[m];o++)j.maps[l]&&q.push(j.maps[l]),l++;a.mapRows.push(q)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"},a.getTalents=function(b){return a.guide.sortTalents(b)},a.hasTalent=function(b,c){return a.guide.hasTalent(b,c)?" active":""},a.hasAnyTalent=function(b,c){return a.guide.hasAnyTalent(b,c)?" tier-selected":""},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void f.editGuide(a.guide).success(function(e){e.success?(d.setSuccess({show:!0,msg:a.guide.name+" has been updated successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=e.errors,a.showError=!0,c.scrollTo(0,0))}):!1}}]).controller("AdminHOTSGuideEditMapCtrl",["$scope","$state","$window","AlertService","GuideBuilder","AdminHOTSGuideService","dataGuide","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h,i){a.guide=e["new"]("map",g.guide),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.admin.hots.guides.edit.step1",{guideID:a.guide._id})};var j=[4,3];a.mapRows=[];for(var k=0,l=0;l<j.length;l++){for(var m=[],n=0;n<j[l];n++)i.maps[k]&&m.push(i.maps[k]),k++;a.mapRows.push(m)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={disableDragAndDrop:!0,height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void f.editGuide(a.guide).success(function(e){e.success?(d.setSuccess({show:!0,msg:a.guide.name+" has been updated successfully."}),b.go("app.admin.hots.guides.list")):(a.errors=e.errors,a.showError=!0,c.scrollTo(0,0))}):!1}}]).controller("HOTSHomeCtrl",["$scope","dataBanners","dataArticles","dataGuidesCommunity","dataGuidesFeatured","ArticleService","HOTSGuideService",function(a,b,c,d,e,f,g){a.articles=c.articles,a.guidesCommunity=d.guides,a.guidesFeatured=e.guides,a.loading={articles:!1,community:!1,featured:!1},a.banner={current:0,direction:"left",slides:b.banners,setCurrent:function(a){this.direction="right",this.current=a},next:function(){this.direction="right",this.current=this.current<this.slides.length-1?++this.current:0},prev:function(){this.direction="left",this.current=this.current>0?--this.current:this.slides.length-1}},a.hero="all",a.setHero=function(b){a.hero=b,a.loading={articles:!0,community:!0,featured:!0},f.getArticles("hots",b,1,9).then(function(b){a.articles=b.articles,a.loading.articles=!1}),g.getGuidesCommunity(b,1,10).then(function(b){a.guidesCommunity=b.guides,a.loading.community=!1}),g.getGuidesFeatured(b,1,10).then(function(b){a.guidesFeatured=b.guides,a.loading.featured=!1})}}]).controller("HOTSGuidesListCtrl",["$scope","$state","data","dataHeroes","dataMaps",function(a,b,c,d,e){function f(a){for(var b=[],c=0;c<a.length;c++)b.push({name:a[c].name,value:a[c].className});return b}return c.success?(a.guides=c.guides,a.total=c.total,a.page=parseInt(c.page),a.perpage=c.perpage,a.search=c.search,a.age=c.age,a.order=c.order,a.hero=c.hero,a.guideType=c.guideType,a.map=c.map,a.hasSearch=function(){return c.search?c.search.length:!1},a.app.settings.show.guides||(a.app.settings.show.guides={advanced:!1}),a.toggleAdvanced=function(){a.app.settings.show.guides.advanced=!a.app.settings.show.guides.advanced},a.showAdvanced=function(){return a.app.settings.show.guides.advanced},a.loading=!1,a.getFilter=function(b,c){for(var d=a.filters.all[b],e=0;e<d.length;e++)if(d[e].value==c)return d[e];return d[0]},a.filters={all:{age:[{name:"All Guides",value:"all"},{name:"7 Days",value:"7"},{name:"15 Days",value:"15"},{name:"30 Days",value:"30"},{name:"60 Days",value:"60"},{name:"90 Days",value:"90"}],order:[{name:"Highest Ranked",value:"high"},{name:"Lowest Ranked",value:"low"},{name:"Newest Decks",value:"new"},{name:"Oldest Decks",value:"old"}],heroes:[{name:"All Heroes",value:"all"}].concat(f(d.heroes)),guideType:[{name:"All Guides",value:"all"},{name:"Hero",value:"hero"},{name:"Map",value:"map"}],maps:[{name:"All Maps",value:"all"}].concat(f(e.maps))}},a.filters.age=a.getFilter("age",a.age),a.filters.order=a.getFilter("order",a.order),a.filters.hero=a.getFilter("heroes",a.hero),a.filters.guideType=a.getFilter("guideType",a.guideType),a.filters.map=a.getFilter("maps",a.map),a.getGuides=function(){var c={};a.search&&(c.s=a.search),1!==a.page&&(c.p=a.page),"all"!=a.filters.guideType&&(c.t=a.filters.guideType.value),"all"!=a.filters.hero&&(c.h=a.filters.hero.value),"all"!=a.filters.map&&(c.m=a.filters.map.value),"all"!==a.filters.age.value&&(c.a=a.filters.age.value),"high"!==a.filters.order.value&&(c.o=a.filters.order.value),a.loading=!0,b.transitionTo("app.hots.guides.list",c)},a.pagination={page:function(){return a.page},perpage:function(){return a.perpage},results:function(){return a.total},setPage:function(b){a.page=b,a.getGuides()},pagesArray:function(){var a=[],b=1,c=this.totalPages();this.totalPages()>5&&(this.page()<3?(b=1,c=b+4):this.page()>this.totalPages()-2?(c=this.totalPages(),b=c-4):(b=this.page()-2,c=this.page()+2));for(var d=b;c>=d;d++)a.push(d);return a},isPage:function(a){return a===this.page()},totalPages:function(a){return this.results()>0?Math.ceil(this.results()/this.perpage()):1}},void((a.page<1||a.page>a.pagination.totalPages())&&a.pagination.setPage(1))):b.transitionTo("app.hots.guides.list")}]).controller("HOTSGuideCtrl",["$scope","$window","$state","$sce","$compile","bootbox","VoteService","HOTSGuideService","data","dataHeroes","dataMaps","UserService","AuthenticationService","SubscriptionService","MetaService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}b(a.guide)}function q(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;g.voteGuide(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else t=f.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),t.modal("show"),u=function(){q(b,c)}}function r(){function b(b){var c=b.votes.filter(function(b){return a.app.user.getUserID()===b.userID})[0];c&&(b.voted=c.direction)}a.guide.comments.forEach(b)}a.guide=i.guide,a.currentHero=a.guide.heroes.length?a.guide.heroes[0].hero:!1,a.heroes=j.heroes,a.maps=k.maps,a.metaservice=o,a.metaservice.set(a.guide.name+" - Guides",a.guide.description);var s="https://s3-us-west-2.amazonaws.com/ts-node2/img/hots/hots-logo.png";a.metaservice.setOg("https://tempostorm.com/heroes-of-the-storm/guides/"+i.guide.slug,a.guide.name,a.guide.description,"article",s),a.app.settings.show.guide||(a.app.settings.show.guide={talents:!0,description:!0,video:!0,matchups:!0,maps:!0,content:[],comments:!0}),a.show=a.app.settings.show.guide,a.$watch("show",function(){a.app.settings.show.guide=a.show},!0),a.setCurrentHero=function(b){a.currentHero=b},a.getCurrentHero=function(){for(var b=0;b<a.guide.heroes.length;b++)if(a.guide.heroes[b].hero._id===a.currentHero._id)return a.guide.heroes[b];return!1},a.justHeroes=function(){for(var b=[],c=0;c<a.guide.heroes.length;c++)b.push(a.guide.heroes[c].hero);return b},a.getTiers=function(){return[1,4,7,10,13,16,20]},a.getTalents=function(a,b){for(var c=[],d=0;d<a.hero.talents.length;d++)a.hero.talents[d].tier===b&&c.push(a.hero.talents[d]);return c},a.selectedTalent=function(a,b,c){return a.talents["tier"+b]==c._id},a.getTalent=function(a,b){for(var c=0;c<a.hero.talents.length;c++)if(a.talents["tier"+b]==a.hero.talents[c]._id)return a.hero.talents[c];return!1},a.hasSynergy=function(b){return-1!==a.guide.synergy.indexOf(b._id)},a.hasStrong=function(b){return-1!==a.guide.against.strong.indexOf(b._id)},a.hasWeak=function(b){return-1!==a.guide.against.weak.indexOf(b._id)},a.hasMap=function(b){for(var c=0;c<a.guide.maps.length;c++)if(a.guide.maps[c]._id===b._id)return!0;return!1},a.getVideo=function(){return a.getContent('<iframe src="//www.youtube.com/embed/'+a.guide.video+'" frameborder="0" height="360" width="100%"></iframe>')},a.getContent=function(a){return d.trustAsHtml(a)},a.voteDown=function(a){q(-1,a)},a.voteUp=function(a){q(1,a)};var t,u;p();var v={comment:""};a.comment=angular.copy(v),a.commentPost=function(){a.app.user.isLogged()?h.addComment(a.guide,a.comment).success(function(b){b.success&&(a.guide.comments.push(b.comment),a.comment.comment="")}):(t=f.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),t.modal("show"),u=function(){a.commentPost()})},r(),a.voteComment=function(b,c){if(a.app.user.isLogged()){if(c.author._id===a.app.user.getUserID())return f.alert("You can't vote for your own content."),!1;g.voteComment(b,c).then(function(a){a.success&&(c.voted=b,c.votesCount=a.votesCount)})}else t=f.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),t.modal("show"),u=function(){a.voteComment(b,deck)}},a.isPremium=function(){if(!a.guide.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.guide.premium.expiryDate).getTime();return c>b?!0:!1},a.getPremium=function(b){a.app.user.isLogged()?a.app.user.isSubscribed()||c.transitionTo("app.profile.subscription",{username:a.app.user.getUsername(),plan:b}):(t=f.dialog({title:"Login Required",message:e("<div login-form></div>")(a)}),t.modal("show"),u=function(){a.getPremium(b)})},a.login=function(c,d){void 0!==c&&void 0!==d&&l.login(c,d).success(function(c){m.setLogged(!0),m.setAdmin(c.isAdmin),m.setProvider(c.isProvider),n.setSubscribed(c.subscription.isSubscribed),n.setTsPlan(c.subscription.plan),n.setExpiry(c.subscription.expiry),b.sessionStorage.userID=c.userID,b.sessionStorage.username=c.username,b.sessionStorage.email=c.email,a.app.settings.token=b.sessionStorage.token=c.token,t.modal("hide"),p(),u()}).error(function(){a.showError=!0})}}]).controller("HOTSGuideBuilderHeroCtrl",["$scope","$state","$window","$compile","HOTSGuideService","GuideBuilder","HOTS","dataHeroes","dataMaps","UserService","AuthenticationService","SubscriptionService",function(a,b,c,d,e,f,g,h,i,j,k,l){var m;a.guide=a.app.settings.guide&&"hero"===a.app.settings.guide.guideType?f["new"]("hero",a.app.settings.guide):f["new"]("hero"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.step1",{})};var n=g.heroRows;a.heroRows=[];for(var o=0,p=0;p<n.length;p++){for(var q=[],r=0;r<n[p];r++)q.push(h.heroes[o]?h.heroes[o]:{}),o++;a.heroRows.push(q)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"};var s=[4,3];a.mapRows=[];for(var o=0,p=0;p<s.length;p++){for(var t=[],r=0;r<s[p];r++)i.maps[o]&&t.push(i.maps[o]),o++;a.mapRows.push(t)}a.getTalents=function(b){return a.guide.sortTalents(b)},a.hasTalent=function(b,c){return a.guide.hasTalent(b,c)?" active":""},a.hasAnyTalent=function(b,c){return a.guide.hasAnyTalent(b,c)?" tier-selected":""},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.isPremium=function(){if(!a.guide.premium.isPremium)return!1;var b=(new Date).getTime(),c=new Date(a.guide.premium.expiryDate).getTime();return c>b?!0:!1},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.login=function(b,d){void 0!==b&&void 0!==d&&j.login(b,d).success(function(b){k.setLogged(!0),k.setAdmin(b.isAdmin),k.setProvider(b.isProvider),l.setSubscribed(b.subscription.isSubscribed),l.setTsPlan(b.subscription.plan),l.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,m.modal("hide"),a.saveGuide}).error(function(){a.showError=!0})},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void(a.app.user.isLogged()?e.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,b.go("app.hots.guides.guide",{slug:d.slug})):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):(m=bootbox.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),m.modal("show"))):!1}}]).controller("HOTSGuideBuilderMapCtrl",["$scope","$state","$window","$compile","HOTSGuideService","GuideBuilder","dataHeroes","dataMaps","UserService","AuthenticationService","SubscriptionService",function(a,b,c,d,e,f,g,h,i,j,k){var l;a.guide=a.app.settings.guide&&"map"===a.app.settings.guide.guideType?f["new"]("map",a.app.settings.guide):f["new"]("map"),a.$watch("guide",function(){a.app.settings.guide=a.guide},!0),a.heroes=g.heroes,a.maps=h.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.step1",{}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.step1",{})};var m=[4,3];a.mapRows=[];for(var n=0,o=0;o<m.length;o++){for(var p=[],q=0;q<m[o];q++)h.maps[n]&&p.push(h.maps[n]),n++;a.mapRows.push(p)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.login=function(b,d){void 0!==b&&void 0!==d&&i.login(b,d).success(function(b){j.setLogged(!0),j.setAdmin(b.isAdmin),j.setProvider(b.isProvider),k.setSubscribed(b.subscription.isSubscribed),k.setTsPlan(b.subscription.plan),k.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,l.modal("hide"),a.saveGuide()}).error(function(){a.showError=!0})},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void(a.app.user.isLogged()?e.addGuide(a.guide).success(function(d){d.success?(a.app.settings.guide=null,b.go("app.hots.guides.guide",{slug:d.slug})):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):(l=bootbox.dialog({title:"Login Required",message:d("<div login-form></div>")(a)}),l.modal("show"))):!1}}]).controller("HOTSGuideBuilderEditStep1Ctrl",["$scope","dataGuide",function(a,b){a.guide=b.guide}]).controller("HOTSGuideBuilderEditHeroCtrl",["$scope","$state","$window","GuideBuilder","HOTSGuideService","HOTS","dataGuide","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h,i){a.guide=d["new"]("hero",g.guide),a.heroes=h.heroes,a.maps=i.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<7&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug})};var j=f.heroRows;a.heroRows=[];for(var k=0,l=0;l<j.length;l++){for(var m=[],n=0;n<j[l];n++)m.push(h.heroes[k]?h.heroes[k]:{}),k++;a.heroRows.push(m)}var o=[4,3];a.mapRows=[];for(var k=0,l=0;l<o.length;l++){for(var p=[],n=0;n<o[l];n++)i.maps[k]&&p.push(i.maps[k]),k++;a.mapRows.push(p)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.tooltipPosTalent=function(a){return 2===a?"left":"right"},a.getTalents=function(b){return a.guide.sortTalents(b)},a.hasTalent=function(b,c){return a.guide.hasTalent(b,c)?" active":""},a.hasAnyTalent=function(b,c){return a.guide.hasAnyTalent(b,c)?" tier-selected":""},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.login=function(b,d){void 0!==b&&void 0!==d&&UserService.login(b,d).success(function(b){AuthenticationService.setLogged(!0),AuthenticationService.setAdmin(b.isAdmin),AuthenticationService.setProvider(b.isProvider),SubscriptionService.setSubscribed(b.subscription.isSubscribed),SubscriptionService.setTsPlan(b.subscription.plan),SubscriptionService.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,box.modal("hide"),a.saveGuide()}).error(function(){a.showError=!0})},a.saveGuide=function(){return a.guide.hasAnyHero()&&a.guide.allTalentsDone()?void(a.app.user.isLogged()?e.editGuide(a.guide).success(function(d){d.success?b.go("app.hots.guides.guide",{slug:d.slug}):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):(box=bootbox.dialog({title:"Login Required",message:$compile("<div login-form></div>")(a)}),box.modal("show"))):!1}}]).controller("HOTSGuideBuilderEditMapCtrl",["$scope","$state","$window","GuideBuilder","HOTSGuideService","dataGuide","dataHeroes","dataMaps",function(a,b,c,d,e,f,g,h){a.guide=d["new"]("map",f.guide),a.heroes=g.heroes,a.maps=h.maps,a.step=2,a.prevStep=function(){return 2==a.step?b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug}):void(a.step>1&&(a.step=a.step-1))},a.nextStep=function(){a.step<5&&(a.step=a.step+1)},a.stepOne=function(){b.go("app.hots.guideBuilder.edit.step1",{slug:a.guide.slug})};var i=[4,3];a.mapRows=[];for(var j=0,k=0;k<i.length;k++){for(var l=[],m=0;m<i[k];m++)h.maps[j]&&l.push(h.maps[j]),j++;a.mapRows.push(l)}a.tooltipPos=function(a,b){return b+1>Math.ceil(a.length/2)?"left":"right"},a.options={height:100,toolbar:[["style",["style"]],["style",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["format",["hr"]],["misc",["undo","redo"]]]},a.premiumTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isPremium=function(){for(var b=a.guide.premium.isPremium,c=0;c<a.premiumTypes.length;c++)if(a.premiumTypes[c].value===b)return a.premiumTypes[c].text},a.featuredTypes=[{text:"No",value:!1},{text:"Yes",value:!0}],a.isFeatured=function(){for(var b=a.guide.featured,c=0;c<a.featuredTypes.length;c++)if(a.featuredTypes[c].value===b)return a.featuredTypes[c].text},a.login=function(b,d){void 0!==b&&void 0!==d&&UserService.login(b,d).success(function(b){AuthenticationService.setLogged(!0),AuthenticationService.setAdmin(b.isAdmin),AuthenticationService.setProvider(b.isProvider),SubscriptionService.setSubscribed(b.subscription.isSubscribed),SubscriptionService.setTsPlan(b.subscription.plan),SubscriptionService.setExpiry(b.subscription.expiry),c.sessionStorage.userID=b.userID,c.sessionStorage.username=b.username,c.sessionStorage.email=b.email,a.app.settings.token=c.sessionStorage.token=b.token,box.modal("hide"),a.saveGuide()}).error(function(){a.showError=!0})},a.saveGuide=function(){return a.guide.hasAnyMap()&&a.guide.hasAnyChapter()?void(a.app.user.isLogged()?e.editGuide(a.guide).success(function(d){d.success?b.go("app.hots.guides.guide",{slug:d.slug}):(a.errors=d.errors,a.showError=!0,c.scrollTo(0,0))}):(box=bootbox.dialog({title:"Login Required",message:$compile("<div login-form></div>")(a)}),box.modal("show"))):!1}}]).controller("HOTSTalentCalculatorCtrl",["$scope","dataHeroesList",function(a,b){a.heroes=b.heroes,a.currentHero=!1,a.setCurrentHero=function(b){a.currentHero=b},a.getCurrentHero=function(){return a.currentHero}}]).controller("HOTSTalentCalculatorHeroCtrl",["$scope","$state","$stateParams","$location","$window","HOTS","Base64","dataHero","MetaService",function(a,b,c,d,e,f,g,h,i){function j(b){b=b||d.hash();for(var c=g.toInt(b),e=(c+"").split(""),f=0;f<e.length;f++)e[f]=+e[f];k(e)?a.hash=e:a.hash=[1,1,1,1,1,1,1],l()}function k(b){if(7!==b.length)return!1;for(var c=1;7>=c;c++){var d=+b[c-1];if(1>d||d>a.talentsByTier(a.tiers[c-1]).length+1)return!1}return!0}function l(){var b=+a.hash.join(""),c=b>1111111?g.fromInt(b):"";d.hash(c)}function m(){var b=a.hash,c={};if(k(b)){for(var d=1;7>=d;d++){var e=+b[d-1];c["tier"+a.tiers[d-1]]=e>1?a.talentsByTier(a.tiers[d-1])[e-2]._id:null}return c}return angular.copy(p)}function n(b){for(var c=a.getCurrentHero(),d=0;d<c.talents.length;d++)if(c.talents[d]._id==b)return c.talents[d];return!1}function o(a){return a%1==0}if(!h.success)return b.go("app.hots.talentCalculator.hero",{hero:a.heroes[0].className});a.setCurrentHero(h.hero),a.currentCharacter=a.currentHero.characters[0],a.currentAbility=!1,a.level=1;var p={tier1:null,tier4:null,tier7:null,tier10:null,tier13:null,tier16:null,tier20:null};a.metaservice=i,a.metaservice.set(h.hero.name+" - Talent Calculator",h.hero.description);var q="https://s3-us-west-2.amazonaws.com/ts-node2/img/hots/hots-logo.png";a.metaservice.setOg(d.absUrl(),h.hero.name,h.hero.description,"article",q),a.getCurrentCharacter=function(){return a.currentCharacter},a.setCurrentCharacter=function(b){a.currentCharacter=b},a.getAbilities=function(){for(var b=a.getCurrentHero().abilities,c=[],d=0;d<b.length;d++)"Ability"==b[d].abilityType&&c.push(b[d]);return c},a.getHeroics=function(){for(var b=a.getCurrentHero().abilities,c=[],d=0;d<b.length;d++)"Heroic Ability"==b[d].abilityType&&c.push(b[d]);return c},a.getTrait=function(){for(var b=a.getCurrentHero().abilities,c=0;c<b.length;c++)if("Combat Trait"==b[c].abilityType)return b[c];return!1},a.getCurrentAbility=function(){return a.currentAbility},a.toggleAbility=function(b){a.getCurrentAbility()&&a.getCurrentAbility()===b?a.currentAbility=!1:a.currentAbility=b},a.tiers=f.tiers,a.talentsByTier=function(b){for(var c=a.currentHero,d=[],e=0;e<c.talents.length;e++)c.talents[e].tier===b&&d.push(c.talents[e]);return d},a.hasTalent=function(b){return a.currentTalents["tier"+b.tier]==b._id?" active":""},a.hasAnyTalent=function(b){return null!==a.currentTalents["tier"+b.tier]?" tier-selected":""},a.toggleTalent=function(b,c,d){a.hasTalent(b)?a.currentTalents["tier"+b.tier]=null:a.currentTalents["tier"+b.tier]=b._id,a.hash[c]=a.hasTalent(b)?d+2:1,k(a.hash)&&l();
},a.hash=[1,1,1,1,1,1,1],j(),a.currentTalents=m(),a.$watch(function(){return location.hash},function(b){var c=b.substr(1,b.length-1);j(c),a.currentTalents=m()}),a.getAbilityTalents=function(){var b,c=a.getCurrentAbility(),d=a.currentTalents,e=a.tiers,f=[];if(!c)return f;for(var g=0;g<e.length;g++)null!==d["tier"+e[g]]&&(b=n(d["tier"+e[g]]),b&&b.ability==c._id&&f.push(b));return f},a.url=function(){return d.absUrl()},a.getHealth=function(){var b=a.getCurrentCharacter(),c=a.level;return b.stats.base.health+(c*b.stats.gain.health-b.stats.gain.health)},a.getHealthRegen=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.healthRegen+(c*b.stats.gain.healthRegen-b.stats.gain.healthRegen);return o(d)?d:+d.toFixed(2)},a.getMana=function(){var b=a.getCurrentCharacter(),c=a.level;return b.stats.base.mana+(c*b.stats.gain.mana-b.stats.gain.mana)||"N/A"},a.getManaRegen=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.manaRegen+(c*b.stats.gain.manaRegen-b.stats.gain.manaRegen);return o(d)?d||"N/A":+d.toFixed(2)},a.getSpeed=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.attackSpeed+(c*b.stats.gain.attackSpeed-b.stats.gain.attackSpeed);return o(d)?d:+d.toFixed(2)},a.getRange=function(){var b=a.getCurrentCharacter(),c=a.level,d=b.stats.base.range+(c*b.stats.gain.range-b.stats.gain.range);return o(d)?d:+d.toFixed(2)},a.getDamage=function(){var b=a.getCurrentCharacter(),c=a.level;return b.stats.base.damage+(c*b.stats.gain.damage-b.stats.gain.damage)},a.getDPS=function(){var b=a.getSpeed()*a.getDamage();return o(b)?b:+b.toFixed(2)},a.copyUrl=function(){var a=document.querySelector(".tc-url");a.select();try{document.execCommand("copy")}catch(b){alert("Your browser does not support this feature.")}window.getSelection().removeAllRanges()},a.reset=function(){d.hash("")}}]).controller("PollsCtrl",["$scope","$sce","$cookies","$compile","bootbox","PollService","dataPollsMain","dataPollsSide",function(a,b,c,d,e,f,g,h){var i;a.pollsMain=g.polls,a.pollsSide=h.polls,a.toggleItem=function(b,c){if(b.votes||(b.votes=[]),a.hasVoted(b,c))b.votes.splice(b.votes.indexOf(c._id),1);else{if(b.votes.length>=b.voteLimit)return!1;b.votes.push(c._id)}},a.getContent=function(a){return b.trustAsHtml(a)},a.btnText=function(b,c){return a.hasVoted(b,c)?"Unpick":"Pick"},a.voteCurve=function(a,b){for(var a,c,d=a.votes,e=0,f=0;f<b.items.length;f++)c=b.items[f].votes,c>e&&(e=c);return 0===e?0:Math.ceil(d/e*100)},a.votePercentage=function(a,b){for(var c=a.votes,d=0,e=0;e<b.items.length;e++)d=parseInt(d+b.items[e].votes);return 0===d?0:Math.ceil(c/d*100)},a.hasVoted=function(a,b){return a.votes?-1!==a.votes.indexOf(b._id):!1},a.isDoneVoting=function(a){return f.getStorage(a)?f.getStorage(a):null},a.setDoneVoting=function(a,b){return f.setStorage(a._id,b)},a.getVotes=function(a){return a.votes},a.getLocalVotes=function(a,b){for(var c=f.getStorage(a._id).split(","),d=0;d<c.length;d++)if(b._id==c[d])return!0},a.bigImg=function(b,c){i=e.dialog({title:c,message:d('<a ng-click="closeBox()"><img class="img-responsive" ng-src="https://s3-us-west-2.amazonaws.com/ts-node2/polls/'+b+'" alt=""></a>')(a),backdrop:!0}),i.modal("show")},a.closeBox=function(){i.modal("hide")},a.submitVote=function(b){f.postVote(b,b.votes).success(function(c){if(c.success){var d=a.getVotes(b).join(",");a.setDoneVoting(b,d);for(var e=0;e!=b.items.length;e++)for(var f=0;f!=a.getVotes(b).length;f++)b.items[e]._id==a.getVotes(b)[f]&&b.items[e].votes++}else $data.errors=c.errors})}}]).controller("twitchCtrl",["$scope","dataTwitch",function(a,b){a.streams=b.stuff}]).controller("TeamCtrl",["$scope",function(a){}]),angular.module("app.directives",["ui.load"]).directive("uiModule",["MODULE_CONFIG","uiLoad","$compile",function(a,b,c){return{restrict:"A",compile:function(d,e){var f=d.contents().clone();return function(d,e,g){e.contents().remove(),b.load(a[g.uiModule]).then(function(){c(f)(d,function(a,b){e.append(a)})})}}}}]).directive("uiAdminNav",[function(){return{restrict:"AE",link:function(a,b,c){b.on("click","a",function(a){var b=$(this);b.parent().siblings(".active").toggleClass("active"),b.next().is("ul")&&b.parent().toggleClass("active")})}}}]).directive("hsCard",function(){return{restrict:"A",link:function(a,b,c){var d=c.tooltipPos&&"left"===c.tooltipPos?-344:60;b.wTooltip({delay:500,offsetX:d,offsetY:-40,content:'<img src="'+c.tooltipImg+'" alt="">',style:!1,className:"hs-card-tooltip"})}}}).directive("loginForm",function(){return{templateUrl:"views/frontend/login.form.html"}}).directive("datePicker",function(){return{replace:!0,templateUrl:"views/admin/date-picker.html",scope:{ngModel:"=",ngDisabled:"=",dateOptions:"="},link:function(a,b,c,d){var e=c.id||"datePicker",f=c.name||"datePicker",g=b.find("button"),h=c["class"]||"",i=b.find("input").attr("id",e).attr("name",f).addClass(h);g.on("click",function(){i.trigger(i.is(":focus")?"blur":"focus")})}}}).directive("ngRightClick",["$parse",function(a){return function(b,c,d){var e=a(d.ngRightClick);c.bind("contextmenu",function(a){b.$apply(function(){a.preventDefault(),e(b,{$event:a})})})}}]).directive("footer",function(){return{templateUrl:"views/frontend/footer.html"}}).directive("scroll",["$window",function(a){return function(b,c,d){angular.element(a).bind("scroll",function(){this.pageYOffset>=1?b.scrolled=!0:b.scrolled=!1,b.$apply()})}}]).directive("ngBackground",function(){return function(a,b,c){var d=c.ngBackground;b.css({"background-image":"url('"+d+"')","background-position":"center center","background-size":"cover"})}}).directive("ngTooltip",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){$(c).tooltip()})}}}]).directive("tsArticle",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){c.find("img").addClass("img-responsive").css("height","auto"),c.find("table").addClass("table-responsive").css("table-layout","auto")})}}}]).directive("pollItemAddForm",function(){return{templateUrl:"views/admin/polls.item.add.html"}}).directive("pollItemEditForm",function(){return{templateUrl:"views/admin/polls.item.edit.html"}}).directive("abilityAddForm",function(){return{templateUrl:"views/admin/hots.heroes.ability.add.html"}}).directive("abilityEditForm",function(){return{templateUrl:"views/admin/hots.heroes.ability.edit.html"}}).directive("talentAddForm",function(){return{templateUrl:"views/admin/hots.heroes.talent.add.html"}}).directive("talentEditForm",function(){return{templateUrl:"views/admin/hots.heroes.talent.edit.html"}}).directive("charAddForm",function(){return{templateUrl:"views/admin/hots.heroes.char.add.html"}}).directive("charEditForm",function(){return{templateUrl:"views/admin/hots.heroes.char.edit.html"}}).directive("talentModal",function(){return{templateUrl:"views/frontend/hots.talent.modal.html"}}).directive("heroModal",function(){return{templateUrl:"views/frontend/hots.hero.modal.html"}}).directive("mapModal",function(){return{templateUrl:"views/frontend/hots.map.modal.html"}}).directive("hotsTalent",["$compile",function(a){return{restrict:"A",scope:{hero:"=hero",talent:"=talent"},link:function(b,c,d){var e=d.tooltipPos&&"left"===d.tooltipPos?-560:111;c.wTooltip({delay:500,offsetX:e,offsetY:-70,content:a("<div talent-modal></div>")(b),style:!1,className:"hots-talent-tooltip"})}}}]).directive("hotsHero",["$compile",function(a){return{restrict:"A",link:function(b,c,d){var e=d.tooltipPos&&"left"===d.tooltipPos?-690:60;c.wTooltip({delay:500,offsetX:e,offsetY:-130,content:a("<div hero-modal></div>")(b),style:!1,className:"hots-hero-tooltip"})}}}]).directive("hotsMap",["$compile",function(a){return{restrict:"A",link:function(b,c,d){var e=d.tooltipPos&&"left"===d.tooltipPos?-560:60;c.wTooltip({delay:500,offsetX:e,offsetY:-130,content:a("<div map-modal></div>")(b),style:!1,className:"hots-map-tooltip"})}}}]).directive("activitySignup",function(){return{templateUrl:"views/frontend/activity/activity.signup.html"}}).directive("activityArticle",function(){return{templateUrl:"views/frontend/activity/activity.article.html"}}).directive("activityArticleComment",function(){return{templateUrl:"views/frontend/activity/activity.article.comment.html"}}).directive("activityDeck",function(){return{templateUrl:"views/frontend/activity/activity.deck.html"}}).directive("activityDeckComment",function(){return{templateUrl:"views/frontend/activity/activity.deck.comment.html"}}).directive("activityForumPost",function(){return{templateUrl:"views/frontend/activity/activity.forumPost.html"}}).directive("activityForumComment",function(){return{templateUrl:"views/frontend/activity/activity.forumPost.comment.html"}}).directive("activityGuide",function(){return{templateUrl:"views/frontend/activity/activity.guide.html"}}).directive("activityGuideComment",function(){return{templateUrl:"views/frontend/activity/activity.guide.comment.html"}}).directive("premiumPage",function(){return{templateUrl:"views/frontend/premiumDirective.html"}}).directive("articleItemAdd",function(){return{templateUrl:"views/admin/articles.item.add.html"}}).directive("articleRelatedAdd",function(){return{templateUrl:"views/admin/articles.related.add.html"}}).directive("hsBuilder",function(){return{templateUrl:"views/frontend/hs.deckBuilder.directive.html"}}).directive("hotsBuilder",function(){return{templateUrl:"views/frontend/hots.guideBuilder.directive.html"}}).directive("hotsTc",function(){return{templateUrl:"views/frontend/hots.tc.directive.html"}}).directive("adsSidebar",function(){return{restrict:"A",replace:!0,templateUrl:"views/frontend/adsense/ads.sidebar.html",controller:function(){(adsbygoogle=window.adsbygoogle||[]).push({})}}}).directive("a",function(){return{restrict:"E",link:function(a,b,c){(c.ngClick||""===c.href||"#"===c.href)&&b.on("click",function(a){a.preventDefault()})}}}).directive("talentIconLg",["$window",function(a){return{restrict:"A",link:function(b,c,d){b.isLarge=a.innerWidth>=1200?" large":"",angular.element(a).on("resize",function(){b.$apply(function(){b.isLarge=a.innerWidth>=1200?" large":""})})}}}]).directive("talentIconMd",["$window",function(a){return{restrict:"A",link:function(b,c,d){b.isLarge=a.innerWidth>=992?" large":"",angular.element(a).on("resize",function(){b.$apply(function(){b.isLarge=a.innerWidth>=992?" large":""})})}}}]).directive("adsSidebarHome",function(){return{restrict:"A",replace:!0,templateUrl:"views/frontend/adsense/ads.sidebar.home.html",controller:function(){(adsbygoogle=window.adsbygoogle||[]).push({})}}}).directive("adsBanner",function(){return{restrict:"A",replace:!0,templateUrl:"views/frontend/adsense/ads.banner.html",controller:function(){(adsbygoogle=window.adsbygoogle||[]).push({})}}}).directive("spinnerButton",[function(){return{restrict:"A",link:function(a,b,c){b.addClass("has-spinner"),b.append(' <span class="spinner"><i class="fa fa-refresh fa-spin"></i></span>'),a.$watch(c.spinnerButton,function(a){b.toggleClass("spinning",a)})}}}]),angular.module("app.filters",[]).filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}).filter("filterAll",["$filter",function(a){var b=a("filter");return function(a,c){Array.prototype.diff=function(a){var b=[];for(e in this)a.indexOf(this[e])>-1&&b.push(this[e]);return b},c=c||"",c=c.split("+");for(var d=[],e=0;e<c.length;e++)d=0===e?d.concat(b(a,c[e])):d.diff(b(a,c[e]));return d}}]),angular.module("app.services",[]).service("MetaService",function(){var a=void 0,b="",c="",d="",e="They",f="",g="",h="",i="";return{setStatusCode:function(b){a=b},setOg:function(a,g,h,i,j){c=a||"https://tempostorm.com",e=g||"TempoStorm",f=h||"TempoStorm Official Website.",b=i||"website",d=j||""},set:function(a,b,c){i=c,h=b,g=a},ogMetaType:function(){return b},ogMetaUrl:function(){return c},ogMetaImage:function(){return d&&""!=d?d.toLowerCase():"https://s3-us-west-2.amazonaws.com/ts-node2/img/100x100tsoglogo.png"},ogMetaTitle:function(){return e},ogMetaDescription:function(){return f.replace(/<\/?[^>]+(>|$)/g,"")},metaTitle:function(){return g+" - TempoStorm"},metaDescription:function(){return h},metaKeywords:function(){return i},getStatusCode:function(){return a}}}).factory("AuthenticationService",function(){var a=!1,b=!1,c=!1;return{isLogged:function(){return a},setLogged:function(b){a=b},isAdmin:function(){return b},setAdmin:function(a){b=a},isProvider:function(){return c},setProvider:function(a){c=a}}}).factory("SubscriptionService",["$http",function(a){var b=!1,c=!1,d=!1;return{isSubscribed:function(){var a=(new Date).getTime();return b?!0:d?d>a:!1},getSubscription:function(){return{isSubscribed:b,tsPlan:c,expiry:d}},setSubscribed:function(a){b=a},setTsPlan:function(a){c=a},setExpiry:function(a){d=a?new Date(a).getTime():a},setPlan:function(b,c){return c=c||!1,a.post("/api/subscription/setplan",{plan:b,cctoken:c})},setCard:function(b){return a.post("/api/subscription/setcard",{cctoken:b})},cancel:function(){return a.post("/api/subscription/cancel",{})}}}]).factory("UserService",["$http",function(a){return{login:function(b,c){return a.post("/login",{email:b,password:c})},signup:function(b,c,d,e){return a.post("/signup",{email:b,username:c,password:d,cpassword:e})},forgotPassword:function(b){return a.post("/forgot-password",{email:b})},resetPassword:function(b,c,d,e){return a.post("/forgot-password/reset",{email:b,code:c,password:d,cpassword:e})},verifyEmail:function(b,c){return a.post("/verify",{email:b,code:c})},verify:function(){return a.post("/api/verify",{})},twitch:function(){return a.post("/auth/twitch",{})},logout:function(){username="",profileImg=""}}}]).factory("ArticleService",["$http","$q",function(a,b){return{getArticles:function(c,d,e,f,g){var h=b.defer(),c=c||"all",d=d||"all",e=e||1,f=f||20,g=g||"";return a.post("/articles",{articleType:c,filter:d,page:e,perpage:f,search:g}).success(function(a){h.resolve(a)}),h.promise},getArticle:function(c){var d=b.defer();return a.post("/article",{slug:c}).success(function(a){d.resolve(a)}),d.promise},addComment:function(b,c){return a.post("/api/article/comment/add",{articleID:b._id,comment:c})}}}]).factory("ProfileService",["$http","$q",function(a,b){return{getUserProfile:function(c){var d=b.defer();return a.post("/api/profile/"+c,{}).success(function(a){d.resolve(a)}),d.promise},getProfile:function(c){var d=b.defer();return a.post("/profile/"+c,{}).success(function(a){d.resolve(a)}),d.promise},getActivity:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/activity",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getArticles:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/articles",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getDecks:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/decks",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getDecksLoggedIn:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/api/profile/"+c+"/decks",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getGuides:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/profile/"+c+"/guides",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getGuidesLoggedIn:function(c,d,e){var f=b.defer(),d=d||1,e=e||20;return a.post("/api/profile/"+c+"/guides",{page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},updateProfile:function(b){return a.post("/api/profile/edit",b)},changeEmail:function(c){var d=b.defer(),c=c||!1;return a.post("/api/profile/changeEmail",{code:c}).success(function(a){d.resolve(a)}),d.promise},updateEmail:function(c){var d=b.defer(),c=c||!1;return a.post("/api/profile/updateEmail",{code:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("TokenInterceptor",["$q","$window",function(a,b){return{request:function(a){return a.headers=a.headers||{},b.sessionStorage.token&&(a.headers.Authorization="Bearer "+b.sessionStorage.token),a},response:function(b){return b||a.when(b)}}}]).factory("AdminCardService",["$http","$q",function(a,b){return{getCards:function(){var c=b.defer();return a.post("/api/admin/cards",{}).success(function(a){c.resolve(a)}),c.promise},getCard:function(c){var d=b.defer();return a.post("/api/admin/card",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addCard:function(b){return a.post("/api/admin/card/add",b)},deleteCard:function(c){var d=b.defer();return a.post("/api/admin/card/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},editCard:function(b){return a.post("/api/admin/card/edit",b)}}}]).factory("AlertService",function(){var a={},b={},c=!1;return{getSuccess:function(){return a},setSuccess:function(b){a=b,c=!0},getError:function(){return b},setError:function(a){b=a,c=!0},reset:function(){a={},b={},c=!1},hasAlert:function(){return c}}}).factory("AdminArticleService",["$http","$q",function(a,b){return{articleTypes:function(){return[{name:"Tempo Storm",value:"ts"},{name:"Hearthstone",value:"hs"},{name:"Heroes of the Storm",value:"hots"}]},getAllArticles:function(){var c=b.defer();return a.post("/api/admin/articles/all",{}).success(function(a){c.resolve(a)}),c.promise},getArticles:function(c,d,e){var c=c||1,d=d||50,e=e||"",f=b.defer();return a.post("/api/admin/articles",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getArticle:function(c){var d=b.defer();return a.post("/api/admin/article",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addArticle:function(b){return a.post("/api/admin/article/add",b)},editArticle:function(b){return a.post("/api/admin/article/edit",b)},deleteArticle:function(c){var d=b.defer();return a.post("/api/admin/article/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getNames:function(b){return a.post("/api/admin/article/names",b)}}}]).factory("AdminDeckService",["$http","$q",function(a,b){return{getAllDecks:function(){var c=b.defer();return a.post("/api/admin/decks/all",{}).success(function(a){c.resolve(a)}),c.promise},getDecks:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/decks",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getDeck:function(c){var d=b.defer();return a.post("/api/admin/deck",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addDeck:function(b){return a.post("/api/admin/deck/add",b)},editDeck:function(b){return a.post("/api/admin/deck/edit",b)},deleteDeck:function(c){var d=b.defer();return a.post("/api/admin/deck/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminHeroService",["$http","$q",function(a,b){return{getHeroes:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/heroes",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getAllHeroes:function(){var c=b.defer();return a.post("/api/admin/heroes/all",{}).success(function(a){c.resolve(a)}),c.promise},getHero:function(c){var d=b.defer();return a.post("/api/admin/hero",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addHero:function(b){return a.post("/api/admin/hero/add",b)},editHero:function(b){return a.post("/api/admin/hero/edit",b)},deleteHero:function(c){var d=b.defer();return a.post("/api/admin/hero/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminMapService",["$http","$q",function(a,b){return{getMaps:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/maps",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getAllMaps:function(){var c=b.defer();return a.post("/api/admin/maps/all",{}).success(function(a){c.resolve(a)}),c.promise},getMap:function(c){var d=b.defer();return a.post("/api/admin/map",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addMap:function(b){return a.post("/api/admin/map/add",b)},editMap:function(b){return a.post("/api/admin/map/edit",b)},deleteMap:function(c){var d=b.defer();return a.post("/api/admin/map/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminHOTSGuideService",["$http","$q",function(a,b){return{getAllGuides:function(){var c=b.defer();return a.post("/api/admin/guides/all",{}).success(function(a){c.resolve(a)}),c.promise},getGuides:function(c,d,e){var f=b.defer(),c=c||1,d=d||50,e=e||"";return a.post("/api/admin/guides",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getGuide:function(c){var d=b.defer();return a.post("/api/admin/guide",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addGuide:function(b){return a.post("/api/admin/guide/add",b)},editGuide:function(b){return a.post("/api/admin/guide/edit",b)},deleteGuide:function(c){var d=b.defer();return a.post("/api/admin/guide/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminUserService",["$http","$q",function(a,b){return{getProviders:function(){var c=b.defer();return a.post("/api/admin/users/providers",{}).success(function(a){c.resolve(a)}),c.promise},getUsers:function(c,d,e){var c=c||1,d=d||50,e=e||"",f=b.defer();return a.post("/api/admin/users",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getUser:function(c){var d=b.defer();return a.post("/api/admin/user",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addUser:function(b){return a.post("/api/admin/user/add",b)},editUser:function(b){return a.post("/api/admin/user/edit",b)},deleteUser:function(c){var d=b.defer();return a.post("/api/admin/user/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("PollService",["$http","$q","$localStorage",function(a,b,c){return{getPolls:function(c){var d=b.defer();return a.post("/polls",{view:c}).success(function(a){d.resolve(a)}),d.promise},postVote:function(b,c){return a.post("/polls/vote",{poll:b,votes:c})},setStorage:function(a,b){return c["tspoll-"+a]=b},getStorage:function(a){return c["tspoll-"+a]}}}]).factory("AdminPollService",["$http","$q",function(a,b){return{getProviders:function(){var c=b.defer();return a.post("/api/admin/polls/providers",{}).success(function(a){c.resolve(a)}),c.promise},getPolls:function(c,d,e){var c=c||1,d=d||50,e=e||"",f=b.defer();return a.post("/api/admin/polls",{page:c,perpage:d,search:e}).success(function(a){f.resolve(a)}),f.promise},getPoll:function(c){var d=b.defer();return a.post("/api/admin/poll",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addPoll:function(b){return a.post("/api/admin/poll/add",b)},editPoll:function(b){return a.post("/api/admin/poll/edit",b)},deletePoll:function(c){var d=b.defer();return a.post("/api/admin/poll/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("AdminBannerService",["$http","$q",function(a,b){return{getBanners:function(c,d,e){var f=b.defer();return a.post("/api/admin/banners",{}).success(function(a){f.resolve(a)}),f.promise},getBanner:function(c){var d=b.defer();return a.post("/api/admin/banner",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addBanner:function(b){return a.post("api/admin/banner/add",b)},editBanner:function(b){return a.post("api/admin/banner/edit",b)},deleteBanner:function(c){var d=b.defer();return a.post("/api/admin/banner/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},updateOrder:function(c){b.defer();a.post("/api/admin/banners/order",{banners:c})}}}]).factory("AdminForumService",["$http","$q",function(a,b){return{getCategories:function(){var c=b.defer();return a.post("/api/admin/forum/categories",{}).success(function(a){c.resolve(a)}),c.promise},getCategory:function(c){var d=b.defer();return a.post("/api/admin/forum/category",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addCategory:function(b){return a.post("/api/admin/forum/category/add",b)},editCategory:function(b){return a.post("/api/admin/forum/category/edit",b)},deleteCategory:function(c){var d=b.defer();return a.post("/api/admin/forum/category/delete",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getThreads:function(){var c=b.defer();return a.post("/api/admin/forum/threads",{}).success(function(a){c.resolve(a)}),c.promise},getThread:function(c){var d=b.defer();return a.post("/api/admin/forum/thread",{_id:c}).success(function(a){d.resolve(a)}),d.promise},addThread:function(b){return a.post("/api/admin/forum/thread/add",b)},editThread:function(b){return a.post("/api/admin/forum/thread/edit",b)},deleteThread:function(c,d){var e=b.defer();return a.post("/api/admin/forum/thread/delete",{_id:c,category:d}).success(function(a){e.resolve(a)}),e.promise}}}]).service("Pagination",function(){var a={};return a["new"]=function(a){a=a||50;var b={page:1,perpage:a};return b.results=function(){return 0},b.pages=function(){return Math.ceil(b.results()/b.perpage)},b.pagesArray=function(){for(var a=[],c=b.pages(),d=1;c>=d;d++)a.push(d);return a},b.pageStart=function(){return b.page*b.perpage-b.perpage},b.showStart=function(){return b.results()?b.pageStart()+1:0},b.showEnd=function(){var a=b.page*b.perpage;return a>b.results()?b.results():a},b.isPage=function(a){return b.page===a},b.setPage=function(a){b.page=a},b},a}).factory("Util",["$http",function(a){return{toSelect:function(a){a=a||[];for(var b=[],c=0;c<a.length;c++)b.push({name:a[c],value:a[c]});return b},slugify:function(a){return a?a.toLowerCase().replace(/-+/g,"").replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):""},getObjectID:function(){return a.post("/api/admin/id",{})}}}]).factory("Base64",function(){for(var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+-",b=a.split(""),c={},d=0;d<b.length;d++)c[b[d]]=d;return{fromInt:function(a){for(var c="";;)if(c=b[63&a]+c,a>>>=6,0===a)break;return c},toInt:function(a){for(var b=0,d=a.split(""),e=0;e<d.length;e++)b=(b<<6)+c[d[e]];return b}}}).factory("Hearthstone",function(){var a={};return a.types=["Minion","Spell","Weapon"],a.rarities=["Basic","Common","Rare","Epic","Legendary"],a.races=["","Beast","Demon","Dragon","Murloc","Pirate","Totem","Mech"],a.classes=["Neutral","Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"],a.mechanics=["Battlecry","Charge","Choose One","Combo","Deathrattle","Divine Shield","Enrage","Freeze","Overload","Secret","Silence","Spell Damage","Stealth","Summon","Taunt","Windfury"],a.deckTypes=["None","Aggro","Control","Midrange","Combo","Theory Craft"],a.expansions=["Basic","Naxxramas","Goblins Vs. Gnomes","Blackrock Mountain"],a}).factory("HOTS",function(){var a={};return a.roles=["Warrior","Assassin","Support","Specialist"],a.types=["Melee","Ranged"],a.universes=["Warcraft","Starcraft","Diablo","Blizzard"],a.abilityTypes=["Combat Trait","Ability","Heroic Ability","Heroic Skill","Mount"],a.manaTypes=["Mana","Brew","Energy","Fury"],a.tiers=[1,4,7,10,13,16,20],a.heroRows=[7,8,9,8,5],a.genStats=function(){for(var a,b=[],c=0;30>c;c++)a={level:c+1,health:"",healthRegen:"",mana:"",manaRegen:"",attackSpeed:"",range:"",damage:""},b.push(a);return b},a}).factory("DeckBuilder",["$sce","$http","$q",function(a,b,c){var d={};return d["new"]=function(b,c){c=c||{};var d=new Date;d.setMonth(d.getMonth()+1);var e={_id:c._id||null,name:c.name||"",description:c.description||"",deckType:c.deckType||"None",contentEarly:c.contentEarly||"",contentMid:c.contentMid||"",contentLate:c.contentLate||"",cards:c.cards||[],playerClass:b,arena:c.arena||!1,mulligans:c.mulligans||[{klass:"Mage",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Shaman",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Warrior",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Rogue",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Paladin",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Priest",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Warlock",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Hunter",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}},{klass:"Druid",withCoin:{cards:[],instructions:""},withoutCoin:{cards:[],instructions:""}}],against:c.against||{strong:[{klass:"Mage",isStrong:!1},{klass:"Shaman",isStrong:!1},{klass:"Warrior",isStrong:!1},{klass:"Rogue",isStrong:!1},{klass:"Paladin",isStrong:!1},{klass:"Priest",isStrong:!1},{klass:"Warlock",isStrong:!1},{klass:"Hunter",isStrong:!1},{klass:"Druid",isStrong:!1}],weak:[{klass:"Mage",isWeak:!1},{klass:"Shaman",isWeak:!1},{klass:"Warrior",isWeak:!1},{klass:"Rogue",isWeak:!1},{klass:"Paladin",isWeak:!1},{klass:"Priest",isWeak:!1},{klass:"Warlock",isWeak:!1},{klass:"Hunter",isWeak:!1},{klass:"Druid",isWeak:!1}],instructions:""},video:c.video||"",premium:c.premium||{isPremium:!1,expiryDate:d},featured:c.featured||!1,"public":c["public"]||"true"};return e.validVideo=function(){var a=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return e.video.length?e.video.match(a):!0},e.isStrong=function(a){return a.isStrong},e.isWeak=function(a){return a.isWeak},e.toggleStrong=function(a){a.isStrong=!a.isStrong},e.toggleWeak=function(a){a.isWeak=!a.isWeak},e.getStrong=function(a){for(var b=e.against.strong,c=0;c<b.length;c++)if(b[c].klass===a)return b[c];return!1},e.getWeak=function(a){for(var b=e.against.weak,c=0;c<b.length;c++)if(b[c].klass===a)return b[c];return!1},e.inMulligan=function(a,b,c){for(var d=b?a.withCoin.cards:a.withoutCoin.cards,e=0;e<d.length;e++)if(d[e]._id===c._id)return!0;return!1},e.toggleMulligan=function(a,b,c){for(var d=b?a.withCoin.cards:a.withoutCoin.cards,e=!1,f=-1,g=0;g<d.length;g++)if(d[g]._id===c._id){e=!0,f=g;break}e?d.splice(f,1):d.length<6&&d.push(c)},e.getMulligan=function(a){for(var b=e.mulligans,c=0;c<b.length;c++)if(b[c].klass===a)return b[c];return!1},e.getContent=function(){return a.trustAsHtml(e.content)},e.isAddable=function(a){for(var b=!1,c=-1,d="Legendary"===a.rarity?!0:!1,f=0;f<e.cards.length;f++)if(e.cards[f]._id===a._id){b=!0,c=f;break}return b?!d&&(1===e.cards[c].qty||e.arena):!0},e.addCard=function(a){for(var b=!1,c=-1,d="Legendary"===a.rarity?!0:!1,f=0;f<e.cards.length;f++)if(e.cards[f]._id===a._id){b=!0,c=f;break}b?d||1!==e.cards[c].qty&&!e.arena||(e.cards[c].qty=e.cards[c].qty+1):(e.cards.push({_id:a._id,cost:a.cost,name:a.name,dust:a.dust,photos:{small:a.photos.small,large:a.photos.large},legendary:d,qty:1}),e.sortDeck())},e.sortDeck=function(){function a(a){return function(b,c){return b[a]<c[a]?-1:b[a]>c[a]?1:0}}function b(){var b=arguments;return function(c,d){for(var e=0,f=0;0===f&&e<b.length;)f=a(b[e])(c,d),e++;return f}}e.cards.sort(b("cost","name"))},e.removeCardFromDeck=function(a){for(var b=0;b<e.cards.length;b++)if(a._id==e.cards[b]._id)if(e.cards[b].qty>1)e.cards[b].qty=e.cards[b].qty-1;else{var c=e.cards.indexOf(e.cards[b]);e.cards.splice(c,1)}},e.removeCard=function(a){if(a.qty>1)a.qty=a.qty-1;else{var b=e.cards.indexOf(a);e.cards.splice(b,1)}},e.manaCurve=function(a){for(var b,c=0,d=0;7>=d;d++)b=e.manaCount(d),b>c&&(c=b);return 0===c?0:Math.ceil(e.manaCount(a)/c*98)},e.manaCount=function(a){for(var b=0,c=0;c<e.cards.length;c++)(e.cards[c].cost===a||7===a&&e.cards[c].cost>=7)&&(b+=e.cards[c].qty);return b},e.getSize=function(){for(var a=0,b=0;7>=b;b++)a+=e.manaCount(b);return a},e.getDust=function(){for(var a=0,b=0;b<e.cards.length;b++)a+=e.cards[b].qty*e.cards[b].dust;return a},e.validDeck=function(){if(30!==e.getSize())return!1;if(!e.arena)for(var a=0;a<e.cards.length;a++)if(e.cards[a].qty>2)return!1;return!0},e},d.loadCards=function(a){var d=c.defer();return b.post("/deckbuilder",{playerClass:a}).success(function(a){d.resolve(a)}),d.promise},d.saveDeck=function(a){return b.post("/api/deck/add",{name:a.name,deckType:a.deckType,description:a.description,contentEarly:a.contentEarly,contentMid:a.contentMid,contentLate:a.contentLate,cards:a.cards,playerClass:a.playerClass,arena:a.arena,mulligans:a.mulligans,against:a.against,video:a.video,premium:a.premium,featured:a.featured,"public":a["public"]})},d.updateDeck=function(a){return b.post("/api/deck/update",{
_id:a._id,name:a.name,deckType:a.deckType,description:a.description,contentEarly:a.contentEarly,contentMid:a.contentMid,contentLate:a.contentLate,cards:a.cards,playerClass:a.playerClass,arena:a.arena,mulligans:a.mulligans,against:a.against,video:a.video,premium:a.premium,featured:a.featured,"public":a["public"]})},d}]).factory("GuideBuilder",["$sce","$http","$q",function(a,b,c){var d={};return d["new"]=function(b,c){c=c||{};var d=new Date;d.setMonth(d.getMonth()+1);var e={_id:c._id||null,name:c.name||"",slug:c.slug||"",guideType:b,description:c.description||"",content:c.content||[],heroes:c.heroes||[],maps:c.maps||[],synergy:c.synergy||[],against:c.against||{strong:[],weak:[]},video:c.video||"",premium:c.premium||{isPremium:!1,expiryDate:d},featured:c.featured||!1,"public":c["public"]?c["public"].toString():"true"};return"map"===b&&e.maps.length>1&&(e.maps=[e.maps[0]]),e.validVideo=function(){var a=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return e.video.length?e.video.match(a):!0},e.getContent=function(b){return a.trustAsHtml(b)},e.moveContentUp=function(a){var b=e.content.indexOf(a),c=b-1;return 0>c?!1:(e.content.splice(b,1),void e.content.splice(c,0,a))},e.moveContentDown=function(a){var b=e.content.indexOf(a),c=b+1;return c>e.content.length-1?!1:(e.content.splice(b,1),void e.content.splice(c,0,a))},e.toggleHero=function(a){if(e.hasHero(a)){for(var b=0;b<e.heroes.length;b++)if(e.heroes[b].hero._id===a._id)return e.heroes.splice(b,1),!0}else{if(5===e.heroes.length)return!1;var c={};c.hero=a,c.talents={tier1:null,tier4:null,tier7:null,tier10:null,tier13:null,tier16:null,tier20:null},e.heroes.push(c)}},e.hasHero=function(a){if(!a)return!1;for(var b=0;b<e.heroes.length;b++)if(e.heroes[b].hero._id===a._id)return!0;return!1},e.hasAnyHero=function(){return e.heroes.length},e.tiers=function(){return[1,4,7,10,13,16,20]},e.talentsByTier=function(a,b){for(var c=[],d=0;d<a.talents.length;d++)a.talents[d].tier===b&&c.push(a.talents[d]);return c},e.toggleTalent=function(a,b){e.hasTalent(a,b)?a.talents["tier"+b.tier]=null:a.talents["tier"+b.tier]=b._id},e.hasAnyTalent=function(a,b){return null!==a.talents["tier"+b.tier]},e.allTalentsDone=function(){for(var a=0;a<e.heroes.length;a++)if(null===e.heroes[a].talents.tier1||null===e.heroes[a].talents.tier4||null===e.heroes[a].talents.tier7||null===e.heroes[a].talents.tier10||null===e.heroes[a].talents.tier13||null===e.heroes[a].talents.tier16||null===e.heroes[a].talents.tier20)return!1;return!0},e.hasTalent=function(a,b){return a.talents["tier"+b.tier]==b._id},e.toggleSynergy=function(a){if(e.hasSynergy(a)){for(var b=0;b<e.synergy.length;b++)if(e.synergy[b]===a._id)return e.synergy.splice(b,1),!0}else e.synergy.push(a._id)},e.hasSynergy=function(a){for(var b=0;b<e.synergy.length;b++)if(e.synergy[b]===a._id)return!0;return!1},e.toggleStrong=function(a){if(e.hasStrong(a)){for(var b=0;b<e.against.strong.length;b++)if(e.against.strong[b]===a._id)return e.against.strong.splice(b,1),!0}else e.against.strong.push(a._id)},e.hasStrong=function(a){for(var b=0;b<e.against.strong.length;b++)if(e.against.strong[b]===a._id)return!0;return!1},e.toggleWeak=function(a){if(e.hasWeak(a)){for(var b=0;b<e.against.weak.length;b++)if(e.against.weak[b]===a._id)return e.against.weak.splice(b,1),!0}else e.against.weak.push(a._id)},e.hasWeak=function(a){for(var b=0;b<e.against.weak.length;b++)if(e.against.weak[b]===a._id)return!0;return!1},e.hasAnyChapter=function(){return e.content.length},e.hasAnyMap=function(){return e.maps.length},e.setMap=function(a){e.maps=[a._id]},e.toggleMap=function(a){if(e.hasMap(a)){for(var b=0;b<e.maps.length;b++)if(e.maps[b]===a._id)return e.maps.splice(b,1),!0}else e.maps.push(a._id)},e.hasMap=function(a){for(var b=0;b<e.maps.length;b++)if(e.maps[b]===a._id)return!0;return!1},e.addContent=function(){e.content.push({title:"NEW CHAPTER",body:""})},e.deleteContent=function(a){var b=e.content.indexOf(a);-1!==b&&e.content.splice(b,1)},e},d.saveGuide=function(a){return b.post("/api/guide/add",a)},d.updateGuide=function(a){return b.post("/api/guide/update",a)},d}]).factory("DeckService",["$http","$q",function(a,b){return{getDecksCommunity:function(c,d,e){c=c||"all",d=d||1,e=e||24;var f=b.defer();return a.post("/decks/community",{klass:c,page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getDecksFeatured:function(c,d,e){c=c||"all",d=d||1,e=e||24;var f=b.defer();return a.post("/decks/featured",{klass:c,page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getDecks:function(c,d,e,f,g,h){c=c||"all",d=d||1,e=e||24,f=f||"",g=g||"all",h=h||"high";var i=b.defer();return a.post("/decks",{klass:c,page:d,perpage:e,search:f,age:g,order:h}).success(function(a){i.resolve(a)}),i.promise},getDeck:function(c){var d=b.defer();return a.post("/deck",{slug:c}).success(function(a){d.resolve(a)}),d.promise},deckEdit:function(c){var d=b.defer();return a.post("/api/deck",{slug:c}).success(function(a){d.resolve(a)}),d.promise},deckDelete:function(b){return a.post("/api/deck/delete",{_id:b})},addComment:function(b,c){return a.post("/api/deck/comment/add",{deckID:b._id,comment:c})}}}]).factory("HOTSGuideService",["$http","$q",function(a,b){return{getGuidesCommunity:function(c,d,e){c=c||"all",d=d||1,e=e||10;var f=b.defer();return a.post("/hots/guides/community",{hero:c,page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getGuidesFeatured:function(c,d,e){c=c||"all",d=d||1,e=e||10;var f=b.defer();return a.post("/hots/guides/featured",{hero:c,page:d,perpage:e}).success(function(a){f.resolve(a)}),f.promise},getGuides:function(c,d,e,f,g,h,i,j){c=c||"all",d=d||"all",e=e||"all",f=f||1,g=g||24,h=h||"",i=i||"all",j=j||"high";var k=b.defer();return a.post("/hots/guides",{guideType:c,hero:d,map:e,page:f,perpage:g,search:h,age:i,order:j}).success(function(a){k.resolve(a)}),k.promise},getGuide:function(c){var d=b.defer();return a.post("/hots/guide",{slug:c}).success(function(a){d.resolve(a)}),d.promise},getMaps:function(){var c=b.defer();return a.post("/hots/maps",{}).success(function(a){c.resolve(a)}),c.promise},guideEdit:function(c){var d=b.defer();return a.post("/api/hots/guide",{slug:c}).success(function(a){d.resolve(a)}),d.promise},addGuide:function(b){return a.post("/api/hots/guide/add",b)},editGuide:function(b){return a.post("/api/hots/guide/update",b)},guideDelete:function(b){return a.post("/api/hots/guide/delete",{_id:b})},addComment:function(b,c){return a.post("/api/hots/guide/comment/add",{guideID:b._id,comment:c})}}}]).factory("HeroService",["$http","$q",function(a,b){return{getHeroesList:function(){var c=b.defer();return a.post("/hots/heroes/list",{}).success(function(a){c.resolve(a)}),c.promise},getHeroes:function(){var c=b.defer();return a.post("/hots/heroes",{}).success(function(a){c.resolve(a)}),c.promise},getHero:function(c){var d=b.defer();return a.post("/hots/hero",{_id:c}).success(function(a){d.resolve(a)}),d.promise},getHeroByClass:function(c){var d=b.defer();return a.post("/hots/hero/class",{hero:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("VoteService",["$http","$q",function(a,b){return{voteArticle:function(c,d){var e=b.defer();return a.post("/api/article/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise},voteDeck:function(c,d){var e=b.defer();return a.post("/api/deck/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise},voteGuide:function(c,d){var e=b.defer();return a.post("/api/hots/guide/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise},voteComment:function(c,d){var e=b.defer();return a.post("/api/comment/vote",{_id:d._id,direction:c}).success(function(a){e.resolve(a)}),e.promise}}}]).factory("ForumService",["$http","$q",function(a,b){return{getCategories:function(){var c=b.defer();return a.post("/forum",{}).success(function(a){c.resolve(a)}),c.promise},getThread:function(c){var d=b.defer();return a.post("/forum/thread",{thread:c}).success(function(a){d.resolve(a)}),d.promise},getPost:function(c,d){var e=b.defer();return a.post("/forum/post",{thread:c,post:d}).success(function(a){e.resolve(a)}),e.promise},addPost:function(b,c){return a.post("/api/forum/post/add",{thread:b,post:c})},addComment:function(b,c){return a.post("/api/forum/post/comment/add",{post:b,comment:c})}}}]).factory("ImgurService",["$http","$q",function(a,b){return{upload:function(c){var d=b.defer(),e=new FormData;return e.append("file",c),a.post("/upload",e).success(function(a){d.resolve(a)}),d.promise}}}]).factory("BannerService",["$http","$q",function(a,b){return{getBanners:function(c){var d=b.defer(),c=c||"ts";return a.post("/banners",{bannerType:c}).success(function(a){d.resolve(a)}),d.promise}}}]).factory("TwitchService",["$http","$q",function(a,b){return{getStreams:function(){var c=b.defer();return a.post("/twitchFeed",{limit:50}).success(function(a){c.resolve(a)}),c.promise}}}]).factory("TwitterService",["$http","$q",function(a,b){return{getFeed:function(){var c=b.defer();return a.post("/twitterFeed",{limit:10}).success(function(a){c.resolve(a)}),c.promise}}}]).factory("ContactService",["$http","$q",function(a,b){return{sendContact:function(b){return a.post("/api/contact/send",{contact:b})}}}]);